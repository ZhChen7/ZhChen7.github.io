<!DOCTYPE html>


<html lang="en">


<head>
  <meta charset="utf-8" />
   
  <meta name="keywords" content="åšå®¢ï¼Œå­¦ä¹ ç½‘ç«™ï¼Œhexoï¼Œå‘¨ç›ï¼Œå‘¨ç›çš„ä¸ªäººåšå®¢" />
   
  <meta name="description" content="å‘¨ç›çš„åšå®¢" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    å¼‚æ­¥ |  å‘¨ç›çš„åšå®¢
  </title>
  <meta name="generator" content="hexo-theme-ayer">
  
  <link rel="shortcut icon" href="/favicon.png" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
  
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

  
  

  

<link rel="alternate" href="/atom.xml" title="èŠ ğŸ’—  ç›" type="application/atom+xml">
</head>

</html>

<body>
  <div id="app">
    
      <canvas class="fireworks"></canvas>
      <style>
        .fireworks {
          position: fixed;
          left: 0;
          top: 0;
          z-index: 99999;
          pointer-events: none;
        }
      </style>
      
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-asynchronization"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  å¼‚æ­¥
</h1>
 

    </header>
     
    <div class="article-meta">
      <a href="/2019/08/14/asynchronization/" class="article-date">
  <time datetime="2019-08-14T07:30:31.000Z" itemprop="datePublished">2019-08-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/JS/">JS</a> / <a class="article-category-link" href="/categories/JS/JS-%E4%B8%89%E5%BA%A7%E5%A4%A7%E5%B1%B1/">JS ä¸‰åº§å¤§å±±</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> Word count:</span>
            <span class="post-count">2.9k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> Reading timeâ‰ˆ</span>
            <span class="post-count">11 min</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="å¼‚æ­¥"><a href="#å¼‚æ­¥" class="headerlink" title="å¼‚æ­¥"></a>å¼‚æ­¥</h1><blockquote>
<p>æœ¬ç« å…¨é¢è®²è§£äº† JS å¼‚æ­¥çš„çŸ¥è¯†ç‚¹ã€‚å…ˆä»<strong>åŸç†å¼€å§‹</strong> ï¼Œè®²è§£ä»€ä¹ˆæ˜¯ <strong>å•çº¿ç¨‹</strong>ã€ä»€ä¹ˆæ˜¯ <strong>event loop</strong> ï¼›ç„¶åè®²è§£ jQuery ä¸­è§£å†³ <strong>å¼‚æ­¥çš„ Deferred</strong> ä»¥åŠ jQuery åˆæ¬¡å±•ç¤ºå‡ºæ¥çš„ <strong>Promise çš„ç”¨æ³•</strong>ï¼›æœ€åå†è®²è§£ ES6 ä¸­ <strong>Promise çš„ç”¨æ³•å’Œæ ‡å‡†</strong> ã€‚</p>
<p><strong>åŸºç¡€ç¯‡è¯·çœ‹</strong> ï¼š<a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225d2eeda9d797f0309cf6ab02%22">å¼‚æ­¥å’Œå•çº¿ç¨‹</a></p>
</blockquote>
<h2 id="å¼‚æ­¥-1"><a href="#å¼‚æ­¥-1" class="headerlink" title="å¼‚æ­¥"></a>å¼‚æ­¥</h2><blockquote>
<p>é«˜çº§é¢è¯•</p>
</blockquote>
<ul>
<li>ã€Š<a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225d2eeda9d797f0309cf6ab02%22">å‰ç«¯ JS é¢è¯•æŠ€å·§</a>ã€‹è®²åˆ°å¼‚æ­¥çš„åŸºç¡€</li>
<li>é«˜çº§é¢è¯•ä¼šé—®åˆ°æ›´å¤šçš„å†…å®¹</li>
<li>å¦‚ event-loop Promise Async/Await ç­‰</li>
</ul>
<h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><ul>
<li>ä»€ä¹ˆæ˜¯å•çº¿ç¨‹ï¼Œå’Œå¼‚æ­¥æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ <a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225d2eeda9d797f0309cf6ab02%22">å‚è€ƒ </a></li>
<li>ä»€ä¹ˆæ˜¯ event-loopï¼Ÿ</li>
<li>æ˜¯å¦ç”¨è¿‡ jQuery çš„ Deferred</li>
<li>Promise çš„åŸºæœ¬ä½¿ç”¨å’ŒåŸç†</li>
<li>ä»‹ç»ä¸€ä¸‹ async/awaitï¼ˆES7ï¼‰ï¼ˆå’Œ Promise çš„åŒºåˆ«ã€è”ç³»ï¼‰</li>
<li>æ€»ç»“ä¸€ä¸‹å½“å‰ JS è§£å†³å¼‚æ­¥çš„æ–¹æ¡ˆ</li>
</ul>
<h2 id="4-1-å•çº¿ç¨‹å’Œå¼‚æ­¥"><a href="#4-1-å•çº¿ç¨‹å’Œå¼‚æ­¥" class="headerlink" title="4-1 å•çº¿ç¨‹å’Œå¼‚æ­¥"></a>4-1 å•çº¿ç¨‹å’Œå¼‚æ­¥</h2><blockquote>
<p><a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225d2eeda9d797f0309cf6ab02%22">å•çº¿ç¨‹å’Œå¼‚æ­¥åŸºç¡€ç¯‡ </a></p>
</blockquote>
<ul>
<li>ä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹ï¼Ÿ<ul>
<li>åŸå›  - é¿å… DOM æ¸²æŸ“å†²çª<ul>
<li>æµè§ˆå™¨éœ€è¦æ¸²æŸ“ DOM</li>
<li>JS å¯ä»¥ä¿®æ”¹ DOM ç»“æ„</li>
<li>JS æ‰§è¡Œçš„æ—¶å€™ï¼Œæµè§ˆå™¨ DOM æ¸²æŸ“ä¼šæš‚åœ</li>
<li>ä¸¤æ®µ JS ä¹Ÿä¸èƒ½åŒæ—¶æ‰§è¡Œ ï¼ˆ éƒ½ä¿®æ”¹ DOM å°±å†²çªäº†ï¼‰</li>
<li>webworker æ”¯æŒå¤šçº¿ç¨‹ ï¼Œä½†æ˜¯ä¸èƒ½ è®¿é—® DOM</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>å•çº¿ç¨‹çš„è§£å†³æ–¹æ¡ˆ</strong> ï¼š <strong>å¼‚æ­¥</strong></p>
<p><em>æš´éœ²å‡ºçš„é—®é¢˜</em> ï¼š</p>
<ul>
<li>é—®é¢˜ä¸€ï¼šæ²¡æŒ‰ç…§ä¹¦å†™æ–¹å¼æ‰§è¡Œï¼Œå¯è¯»æ€§å·®</li>
<li>é—®é¢˜äºŒï¼šcallback ä¸­ä¸å®¹æ˜“æ¨¡å—åŒ–</li>
</ul>
<h3 id="é—®é¢˜è§£ç­”"><a href="#é—®é¢˜è§£ç­”" class="headerlink" title="é—®é¢˜è§£ç­”"></a>é—®é¢˜è§£ç­”</h3><ul>
<li>ä»€ä¹ˆæ˜¯å•çº¿ç¨‹ï¼Œå’Œå¼‚æ­¥æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ<ul>
<li>å•çº¿ç¨‹å°±æ˜¯åŒæ—¶åªåšä¸€ä»¶äº‹ï¼Œä¸¤æ®µ JS ä¸èƒ½åŒæ—¶ æ‰§è¡Œ</li>
<li>åŸå› å°±æ˜¯ ä¸ºäº†é¿å… DOM æ¸²æŸ“çš„å†²çª</li>
<li>å¼‚æ­¥æ˜¯ä¸€ç§ â€œæ— å¥ˆâ€ çš„è§£å†³æ–¹æ¡ˆï¼Œè™½ç„¶æœ‰å¾ˆå¤šé—®é¢˜</li>
</ul>
</li>
</ul>
<p><strong>æ‰¿ä¸Šå¯ä¸‹ï¼š</strong></p>
<ul>
<li>å•çº¿ç¨‹ - åŒæ—¶é—´åªèƒ½åšä¸€ä»¶äº‹</li>
<li>åŸå›  - é¿å… DOM æ¸²æŸ“å†²çª</li>
<li>è§£å†³æ–¹æ¡ˆ - å¼‚æ­¥</li>
<li>å¼‚æ­¥çš„å®ç°æ–¹å¼ - event loop</li>
</ul>
<h2 id="4-2-ä»€ä¹ˆæ˜¯-event-loop"><a href="#4-2-ä»€ä¹ˆæ˜¯-event-loop" class="headerlink" title="4-2 ä»€ä¹ˆæ˜¯ event-loop"></a>4-2 ä»€ä¹ˆæ˜¯ event-loop</h2><blockquote>
<p>ä¸»çº¿ç¨‹ä»â€ä»»åŠ¡é˜Ÿåˆ—â€ä¸­è¯»å–äº‹ä»¶ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å¾ªç¯ä¸æ–­çš„ï¼Œæ‰€ä»¥æ•´ä¸ªçš„è¿™ç§è¿è¡Œæœºåˆ¶åˆç§°ä¸º Event Loopï¼ˆäº‹ä»¶å¾ªç¯ï¼‰ã€‚ <a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html">å†è°ˆ Event Loop</a></p>
</blockquote>
<h3 id="æ–‡å­—è§£é‡Š"><a href="#æ–‡å­—è§£é‡Š" class="headerlink" title="æ–‡å­—è§£é‡Š"></a>æ–‡å­—è§£é‡Š</h3><blockquote>
<p>event-loop</p>
</blockquote>
<ul>
<li>äº‹ä»¶è½®è¯¢ï¼Œ JS å®ç°å¼‚æ­¥ çš„å…·ä½“è§£å†³æ–¹æ¡ˆ</li>
<li>åŒæ­¥ä»£ç ï¼Œç›´æ¥æ‰§è¡Œ</li>
<li>å¼‚æ­¥å‡½æ•°å…ˆæ”¾åœ¨ å¼‚æ­¥é˜Ÿåˆ— ä¸­</li>
<li>å¾…åŒæ­¥å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œè½®è¯¢æ‰§è¡Œ å¼‚æ­¥é˜Ÿåˆ— çš„å‡½æ•°</li>
</ul>
<h3 id="å®ä¾‹åˆ†æ"><a href="#å®ä¾‹åˆ†æ" class="headerlink" title="å®ä¾‹åˆ†æ"></a>å®ä¾‹åˆ†æ</h3><p><em>ç¤ºä¾‹ä¸€ï¼š</em></p>
<p><img src="http://static.zxinc520.com/blog/20190813/mxsAJyrO4cLE.png?imageslim" alt="mark"></p>
<p><em>ç¤ºä¾‹äºŒï¼š</em></p>
<p><img src="http://static.zxinc520.com/blog/20190813/kftHfWYaHL80.png?imageslim" alt="mark"></p>
<p><em>ç¤ºä¾‹ä¸‰ï¼š</em></p>
<p><img src="http://static.zxinc520.com/blog/20190813/j3lPm5VCfcSB.png?imageslim" alt="mark"></p>
<p><strong>ä¸Šå›¾æœ‰ 2 ç§ç»“æœ</strong>ï¼š(a æ˜¯åœ¨ ajax è¯·æ±‚æˆåŠŸæ—¶æ”¾å…¥å¼‚æ­¥é˜Ÿåˆ—ï¼Œæ‰€ä»¥æ—¶é—´ä¸ç¡®å®š)</p>
<ol>
<li>d -&gt; c -&gt; a -&gt; b</li>
<li>d -&gt; c -&gt; b -&gt; a</li>
</ol>
<h3 id="é—®é¢˜è§£ç­”-1"><a href="#é—®é¢˜è§£ç­”-1" class="headerlink" title="é—®é¢˜è§£ç­”"></a>é—®é¢˜è§£ç­”</h3><ul>
<li>ä»€ä¹ˆæ˜¯ event-loopï¼Ÿ<ul>
<li>äº‹ä»¶è½®è¯¢ï¼Œ JS å®ç°å¼‚æ­¥ çš„å…·ä½“è§£å†³æ–¹æ¡ˆ</li>
<li>ä»€ä¹ˆæ˜¯å¼‚æ­¥é˜Ÿåˆ—ï¼Œä½•æ—¶è¢«æ”¾å…¥ å¼‚æ­¥é˜Ÿåˆ—</li>
<li>è½®è¯¢çš„è¿‡ç¨‹</li>
</ul>
</li>
</ul>
<h2 id="4-3-jQuery-çš„-Deferred"><a href="#4-3-jQuery-çš„-Deferred" class="headerlink" title="4-3 jQuery çš„ Deferred"></a>4-3 jQuery çš„ Deferred</h2><blockquote>
<p><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2011/08/a_detailed_explanation_of_jquery_deferred_object.html">jQuery çš„ deferred å¯¹è±¡è¯¦è§£</a></p>
<p>jQuery 1.5.0 ç‰ˆæœ¬å¼€å§‹å¼•å…¥çš„ä¸€ä¸ªæ–°åŠŸèƒ½â€”-<a target="_blank" rel="noopener" href="http://api.jquery.com/category/deferred-object/">deferred å¯¹è±¡</a>ã€‚</p>
<p>é’ˆå¯¹çš„è¯»è€…æ˜¯é‚£äº›å·²ç»å…·å¤‡ jQuery ä½¿ç”¨ç»éªŒçš„å¼€å‘è€…ã€‚å¦‚æœä½ æƒ³äº†è§£ jQuery çš„åŸºæœ¬ç”¨æ³•ï¼Œè¯·é˜…è¯» <a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/">é˜®ä¸€å³°</a> ç¼–å†™çš„<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2011/07/jquery_fundamentals.html">ã€ŠjQuery è®¾è®¡æ€æƒ³ã€‹</a>å’Œ<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2011/08/jquery_best_practices.html">ã€ŠjQuery æœ€ä½³å®è·µã€‹</a>ã€‚</p>
</blockquote>
<h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><ul>
<li>jQuery 1.5 çš„å˜åŒ–</li>
<li>ä½¿ç”¨ jQuery Deferred</li>
<li>åˆæ­¥å¼•å…¥ Promise æ¦‚å¿µ</li>
</ul>
<p><strong>æ³¨æ„</strong> ï¼šä¸è¦ä»¥ä¸ºæ‰€æœ‰çš„ç½‘ç«™ éƒ½æ˜¯ vue å’Œ React å¼€å‘çš„</p>
<h4 id="jQuery-1-5-ä¹‹å‰"><a href="#jQuery-1-5-ä¹‹å‰" class="headerlink" title="jQuery 1.5 ä¹‹å‰"></a>jQuery 1.5 ä¹‹å‰</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ajax = $.ajax(&#123;</span><br><span class="line">  url: <span class="string">&quot;data.json&quot;</span>,</span><br><span class="line">  success: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;success1&quot;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;success2&quot;</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;success3&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  error: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(ajax); <span class="comment">//è¿”å›ä¸€ä¸ª XHR å¯¹è±¡</span></span><br></pre></td></tr></table></figure>

<h4 id="jQuery-1-5-ä¹‹å"><a href="#jQuery-1-5-ä¹‹å" class="headerlink" title="jQuery 1.5 ä¹‹å"></a>jQuery 1.5 ä¹‹å</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ajax = $.ajax(<span class="string">&quot;data.json&quot;</span>);</span><br><span class="line">ajax</span><br><span class="line">  .done(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;success 1&quot;</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .fail(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .done(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;success 2&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(ajax); <span class="comment">//è¿”å›ä¸€ä¸ª deferred å¯¹è±¡</span></span><br></pre></td></tr></table></figure>

<h4 id="jQuery-1-5-çš„å˜åŒ–"><a href="#jQuery-1-5-çš„å˜åŒ–" class="headerlink" title="jQuery 1.5 çš„å˜åŒ–"></a>jQuery 1.5 çš„å˜åŒ–</h4><ul>
<li>æ— æ³•æ”¹å˜ JS å¼‚æ­¥å’Œå•çº¿ç¨‹çš„æœ¬è´¨</li>
<li>åªèƒ½ä»å†™æ³•ä¸Šæœç» callback è¿™ç§å½¢å¼</li>
<li>å®ƒæ˜¯ä¸€ç§è¯­æ³•ç³–å½¢å¼ï¼Œä½†æ˜¯è§£è€¦äº†ä»£ç </li>
<li>å¾ˆå¥½çš„ä½“ç°ï¼š<strong>å¼€æ”¾å°é—­åŸåˆ™</strong></li>
</ul>
<h3 id="ä½¿ç”¨-jQuery-Deferred"><a href="#ä½¿ç”¨-jQuery-Deferred" class="headerlink" title="ä½¿ç”¨ jQuery Deferred"></a>ä½¿ç”¨ jQuery Deferred</h3><blockquote>
<p>ä½¿ç”¨ jQuery Deferred</p>
<p>å¯¹æ¯” è¯´æ˜</p>
</blockquote>
<p><em>æœªä½¿ç”¨æƒ…å†µï¼š</em></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç»™å‡ºä¸€æ®µéå¸¸ç®€å•çš„å¼‚æ­¥æ“ä½œä»£ç ï¼Œä½¿ç”¨ setTimeout å‡½æ•°</span></span><br><span class="line"><span class="keyword">var</span> wait = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> task = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;æ‰§è¡Œå®Œæˆ&quot;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="built_in">setTimeout</span>(task, <span class="number">2000</span>);</span><br><span class="line">&#125;;</span><br><span class="line">wait();</span><br><span class="line"><span class="comment">// æ–°å¢éœ€æ±‚ï¼šè¦åœ¨æ‰§è¡Œå®Œæˆä¹‹åè¿›è¡ŒæŸäº›ç‰¹åˆ«å¤æ‚çš„æ“ä½œï¼Œä»£ç å¯èƒ½ä¼šå¾ˆå¤šï¼Œè€Œä¸”åˆ†å¥½å‡ ä¸ªæ­¥éª¤</span></span><br></pre></td></tr></table></figure>

<p>_ä½¿ç”¨ jQuery Deferred_ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waitHandle</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> dtd = $.Deferred(); <span class="comment">//åˆ›å»ºä¸€ä¸ª Deferred å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> wait = <span class="function"><span class="keyword">function</span> (<span class="params">dtd</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//è¦æ±‚ä¼ å…¥ä¸€ä¸ª Deferred å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">var</span> task = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;æ‰§è¡Œå®Œæˆ&quot;</span>);</span><br><span class="line">      dtd.resolve(); <span class="comment">//è¡¨ç¤ºå¼‚æ­¥ä»»åŠ¡å·²ç»å®Œæˆ</span></span><br><span class="line">      <span class="comment">// dtd.reject()  //è¡¨ç¤ºå¼‚æ­¥ä»»åŠ¡å¤±è´¥æˆ–å‡ºé”™</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">setTimeout</span>(task, <span class="number">2000</span>);</span><br><span class="line">    <span class="keyword">return</span> dtd; <span class="comment">// è¦æ±‚è¿”å› Deferred å¯¹è±¡</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ³¨æ„ï¼Œè¿™é‡Œä¸€å®šè¦æœ‰è¿”å›å€¼</span></span><br><span class="line">  <span class="keyword">return</span> wait(dtd);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åŒºåˆ«äºpromiseï¼Œå¥½åƒä¸èƒ½é“¾å¼è°ƒç”¨</span></span><br><span class="line"><span class="keyword">var</span> w = waitHandle();</span><br><span class="line">w.then(</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;ok 1&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;err 1&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">w.then(</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;ok 2&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;error 2&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿˜æœ‰ w.done w.fail</span></span><br></pre></td></tr></table></figure>

<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul>
<li>æ€»ç»“ï¼Œdtd çš„ API å¯åˆ†æˆä¸¤ç±»ï¼Œç”¨æ„ä¸åŒ</li>
<li>ç¬¬ä¸€ç±»ï¼šdtd.resolve dtd.reject</li>
<li>ç¬¬äºŒç±»ï¼šdtd.then dtd.done dtd.fail</li>
<li>è¿™ä¸¤ç±»åº”è¯¥åˆ†å¼€ï¼Œå¦åˆ™åæœå¾ˆä¸¥é‡</li>
</ul>
<h3 id="é—®é¢˜è§£ç­”-2"><a href="#é—®é¢˜è§£ç­”-2" class="headerlink" title="é—®é¢˜è§£ç­”"></a>é—®é¢˜è§£ç­”</h3><ul>
<li><p>æ˜¯å¦ç”¨è¿‡ jQuery çš„ Deferred</p>
<ul>
<li>å¯ä»¥ jQuery 1.5 å¯¹ ajax çš„æ”¹å˜ä¸¾ä¾‹</li>
<li>è¯´æ˜å¦‚ä½•ç®€å•çš„å°è£…ï¼Œä½¿ç”¨ Deferred</li>
<li>è¯´æ˜ ES6 promise å’Œ Deferred çš„åŒºåˆ«</li>
</ul>
</li>
</ul>
<p><strong>æƒ³è¦æ·±å…¥ç†è§£å®ƒï¼Œå°±éœ€è¦çŸ¥é“å®ƒçš„å‰ä¸–ä»Šç”Ÿã€‚</strong></p>
<h2 id="4-4-Promise"><a href="#4-4-Promise" class="headerlink" title="4-4 Promise"></a>4-4 Promise</h2><blockquote>
<p>Promise æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œæ¯”ä¼ ç»Ÿçš„è§£å†³æ–¹æ¡ˆâ€”â€”å›è°ƒå‡½æ•°å’Œäº‹ä»¶â€”â€”æ›´åˆç†å’Œæ›´å¼ºå¤§ã€‚å®ƒç”±ç¤¾åŒºæœ€æ—©æå‡ºå’Œå®ç°ï¼ŒES6 å°†å…¶å†™è¿›äº†è¯­è¨€æ ‡å‡†ï¼Œç»Ÿä¸€äº†ç”¨æ³•ï¼ŒåŸç”Ÿæä¾›äº†<code>Promise</code>å¯¹è±¡ã€‚</p>
<p>æ‰€è°“<code>Promise</code>ï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢ä¿å­˜ç€æŸä¸ªæœªæ¥æ‰ä¼šç»“æŸçš„äº‹ä»¶ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼‰çš„ç»“æœã€‚ä»è¯­æ³•ä¸Šè¯´ï¼ŒPromise æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»å®ƒå¯ä»¥è·å–å¼‚æ­¥æ“ä½œçš„æ¶ˆæ¯ã€‚Promise æä¾›ç»Ÿä¸€çš„ APIï¼Œå„ç§å¼‚æ­¥æ“ä½œéƒ½å¯ä»¥ç”¨åŒæ ·çš„æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚</p>
<p><a target="_blank" rel="noopener" href="http://es6.ruanyifeng.com/#docs/promise">ECMAScript 6 Promise å¯¹è±¡</a></p>
<p><strong>åŸºç¡€è¯­æ³•</strong> è¯·å‚è€ƒæˆ‘çš„å¦ä¸€ç¯‡åšå®¢ï¼š <a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225cbb3bf05733fa0a66088c80%22">Promise è¯¦ç»†åˆ†æ</a></p>
</blockquote>
<p><code>Promise</code><strong>å¯¹è±¡æœ‰ä»¥ä¸‹ä¸¤ä¸ªç‰¹ç‚¹</strong>ã€‚</p>
<ol>
<li>å¯¹è±¡çš„çŠ¶æ€ä¸å—å¤–ç•Œå½±å“ã€‚<code>Promise</code>å¯¹è±¡ä»£è¡¨ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œæœ‰ä¸‰ç§çŠ¶æ€ï¼š<code>pending</code>ï¼ˆè¿›è¡Œä¸­ï¼‰ã€<code>fulfilled</code>ï¼ˆå·²æˆåŠŸï¼‰å’Œ<code>rejected</code>ï¼ˆå·²å¤±è´¥ï¼‰ã€‚åªæœ‰å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œå¯ä»¥å†³å®šå½“å‰æ˜¯å“ªä¸€ç§çŠ¶æ€ï¼Œä»»ä½•å…¶ä»–æ“ä½œéƒ½æ— æ³•æ”¹å˜è¿™ä¸ªçŠ¶æ€ã€‚è¿™ä¹Ÿæ˜¯<code>Promise</code>è¿™ä¸ªåå­—çš„ç”±æ¥ï¼Œå®ƒçš„è‹±è¯­æ„æ€å°±æ˜¯â€œæ‰¿è¯ºâ€ï¼Œè¡¨ç¤ºå…¶ä»–æ‰‹æ®µæ— æ³•æ”¹å˜ã€‚</li>
<li>ä¸€æ—¦çŠ¶æ€æ”¹å˜ï¼Œå°±ä¸ä¼šå†å˜ï¼Œä»»ä½•æ—¶å€™éƒ½å¯ä»¥å¾—åˆ°è¿™ä¸ªç»“æœã€‚<code>Promise</code>å¯¹è±¡çš„çŠ¶æ€æ”¹å˜ï¼Œåªæœ‰ä¸¤ç§å¯èƒ½ï¼šä»<code>pending</code>å˜ä¸º<code>fulfilled</code>å’Œä»<code>pending</code>å˜ä¸º<code>rejected</code>ã€‚åªè¦è¿™ä¸¤ç§æƒ…å†µå‘ç”Ÿï¼ŒçŠ¶æ€å°±å‡å›ºäº†ï¼Œä¸ä¼šå†å˜äº†ï¼Œä¼šä¸€ç›´ä¿æŒè¿™ä¸ªç»“æœï¼Œè¿™æ—¶å°±ç§°ä¸º resolvedï¼ˆå·²å®šå‹ï¼‰ã€‚å¦‚æœæ”¹å˜å·²ç»å‘ç”Ÿäº†ï¼Œä½ å†å¯¹<code>Promise</code>å¯¹è±¡æ·»åŠ å›è°ƒå‡½æ•°ï¼Œä¹Ÿä¼šç«‹å³å¾—åˆ°è¿™ä¸ªç»“æœã€‚è¿™ä¸äº‹ä»¶ï¼ˆEventï¼‰å®Œå…¨ä¸åŒï¼Œäº‹ä»¶çš„ç‰¹ç‚¹æ˜¯ï¼Œå¦‚æœä½ é”™è¿‡äº†å®ƒï¼Œå†å»ç›‘å¬ï¼Œæ˜¯å¾—ä¸åˆ°ç»“æœçš„ã€‚</li>
</ol>
<p>æ³¨æ„ï¼Œä¸ºäº†è¡Œæ–‡æ–¹ä¾¿ï¼Œæœ¬ç« åé¢çš„<code>resolved</code>ç»Ÿä¸€åªæŒ‡<code>fulfilled</code>çŠ¶æ€ï¼Œä¸åŒ…å«<code>rejected</code>çŠ¶æ€ã€‚</p>
<p>æœ‰äº†<code>Promise</code>å¯¹è±¡ï¼Œå°±å¯ä»¥å°†å¼‚æ­¥æ“ä½œä»¥åŒæ­¥æ“ä½œçš„æµç¨‹è¡¨è¾¾å‡ºæ¥ï¼Œé¿å…äº†å±‚å±‚åµŒå¥—çš„å›è°ƒå‡½æ•°ã€‚æ­¤å¤–ï¼Œ<code>Promise</code>å¯¹è±¡æä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œä½¿å¾—æ§åˆ¶å¼‚æ­¥æ“ä½œæ›´åŠ å®¹æ˜“ã€‚</p>
<p><code>Promise</code>ä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ã€‚é¦–å…ˆï¼Œæ— æ³•å–æ¶ˆ<code>Promise</code>ï¼Œä¸€æ—¦æ–°å»ºå®ƒå°±ä¼šç«‹å³æ‰§è¡Œï¼Œæ— æ³•ä¸­é€”å–æ¶ˆã€‚å…¶æ¬¡ï¼Œå¦‚æœä¸è®¾ç½®å›è°ƒå‡½æ•°ï¼Œ<code>Promise</code>å†…éƒ¨æŠ›å‡ºçš„é”™è¯¯ï¼Œä¸ä¼šååº”åˆ°å¤–éƒ¨ã€‚ç¬¬ä¸‰ï¼Œå½“å¤„äº<code>pending</code>çŠ¶æ€æ—¶ï¼Œæ— æ³•å¾—çŸ¥ç›®å‰è¿›å±•åˆ°å“ªä¸€ä¸ªé˜¶æ®µï¼ˆåˆšåˆšå¼€å§‹è¿˜æ˜¯å³å°†å®Œæˆï¼‰ã€‚</p>
<p>å¦‚æœæŸäº›äº‹ä»¶ä¸æ–­åœ°åå¤å‘ç”Ÿï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä½¿ç”¨ <a target="_blank" rel="noopener" href="https://nodejs.org/api/stream.html">Stream</a> æ¨¡å¼æ˜¯æ¯”éƒ¨ç½²<code>Promise</code>æ›´å¥½çš„é€‰æ‹©ã€‚</p>
<h3 id="å¼‚å¸¸æ•è·"><a href="#å¼‚å¸¸æ•è·" class="headerlink" title="å¼‚å¸¸æ•è·"></a>å¼‚å¸¸æ•è·</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadImg</span>(<span class="params">src</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> img = <span class="built_in">document</span>.createElement(<span class="string">&quot;img&quot;</span>);</span><br><span class="line">    img.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      resolve(img);</span><br><span class="line">    &#125;;</span><br><span class="line">    img.onerror = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      reject();</span><br><span class="line">    &#125;;</span><br><span class="line">    img.src = src;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> promise;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> src =</span><br><span class="line">  <span class="string">&quot;https://edu-image.nosdn.127.net/B34DC36428D2D51B8EF5EE2C83CE9BF2.png?imageView&amp;thumbnail=241y34&amp;quality=100&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> result = loadImg(src);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è§„å®š ï¼š then åªæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œæœ€åç»Ÿä¸€ç”¨ catch æ•è·å¼‚å¸¸</span></span><br><span class="line">result</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">img</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(img.width);</span><br><span class="line">    <span class="keyword">return</span> img;</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">img</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(img.height);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">ex</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// æœ€åç»Ÿä¸€ catch</span></span><br><span class="line">    <span class="built_in">console</span>.log(ex);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Promise-all-amp-Promise-race"><a href="#Promise-all-amp-Promise-race" class="headerlink" title="Promise.all &amp; Promise.race"></a>Promise.all &amp; Promise.race</h3><blockquote>
<p><strong>Promise.all</strong> å¯ä»¥å°†å¤šä¸ª Promise å®ä¾‹åŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ã€‚åŒæ—¶ï¼ŒæˆåŠŸå’Œå¤±è´¥çš„è¿”å›å€¼æ˜¯ä¸åŒçš„ï¼ŒæˆåŠŸçš„æ—¶å€™è¿”å›çš„æ˜¯ä¸€ä¸ªç»“æœæ•°ç»„ï¼Œè€Œå¤±è´¥çš„æ—¶å€™åˆ™è¿”å›æœ€å…ˆè¢« reject å¤±è´¥çŠ¶æ€çš„å€¼ã€‚</p>
<p><strong>Promse.race</strong> å°±æ˜¯èµ›è·‘çš„æ„æ€ï¼Œæ„æ€å°±æ˜¯è¯´ï¼ŒPromise.race([p1, p2, p3])é‡Œé¢å“ªä¸ªç»“æœè·å¾—çš„å¿«ï¼Œå°±è¿”å›é‚£ä¸ªç»“æœï¼Œä¸ç®¡ç»“æœæœ¬èº«æ˜¯æˆåŠŸçŠ¶æ€è¿˜æ˜¯å¤±è´¥çŠ¶æ€ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/7e60fc1be1b2">ç†è§£å’Œä½¿ç”¨ Promise.all å’Œ Promise.race</a></p>
</blockquote>
<p><img src="http://static.zxinc520.com/blog/20190814/LoF987DaE10r.png?imageslim" alt="mark"></p>
<p><em>æ¼”ç¤º</em> ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadImg</span>(<span class="params">src</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> img = <span class="built_in">document</span>.createElement(<span class="string">&quot;img&quot;</span>);</span><br><span class="line">    img.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      resolve(img);</span><br><span class="line">    &#125;;</span><br><span class="line">    img.onerror = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      reject();</span><br><span class="line">    &#125;;</span><br><span class="line">    img.src = src;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> promise;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> src1 =</span><br><span class="line">  <span class="string">&quot;https://edu-image.nosdn.127.net/B34DC36428D2D51B8EF5EE2C83CE9BF2.png?imageView&amp;thumbnail=241y34&amp;quality=100&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> src2 = <span class="string">&quot;https://www.imooc.com/static/img/index/logo.png&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result1 = loadImg(src1);</span><br><span class="line"><span class="keyword">var</span> result2 = loadImg(src2);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.all([result1, result2]).then(<span class="function"><span class="keyword">function</span> (<span class="params">datas</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(datas[<span class="number">0</span>]);</span><br><span class="line">  <span class="built_in">console</span>.log(datas[<span class="number">1</span>]);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è°å¿«è°å…ˆæ‰§è¡Œ</span></span><br><span class="line"><span class="built_in">Promise</span>.race([result1, result2]).then(<span class="function"><span class="keyword">function</span> (<span class="params">datas</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(datas);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>Promise.all çš„æ‰§è¡Œç»“æœ</strong> ï¼š</p>
<p><img src="http://static.zxinc520.com/blog/20190814/ITqccL9zhyE0.png?imageslim" alt="mark"></p>
<p><strong>Promise.race çš„æ‰§è¡Œç»“æœ</strong> ï¼š</p>
<p><img src="http://static.zxinc520.com/blog/20190814/PP76XFiW0S3V.png?imageslim" alt="mark"></p>
<h3 id="promise-æ ‡å‡†"><a href="#promise-æ ‡å‡†" class="headerlink" title="promise æ ‡å‡†"></a>promise æ ‡å‡†</h3><ul>
<li>å…³äº â€œæ ‡å‡†â€ çš„é—²è°ˆ</li>
<li>çŠ¶æ€å˜åŒ–</li>
<li>then</li>
</ul>
<h4 id="å…³äº-â€œæ ‡å‡†â€-çš„é—²è°ˆ"><a href="#å…³äº-â€œæ ‡å‡†â€-çš„é—²è°ˆ" class="headerlink" title="å…³äº â€œæ ‡å‡†â€ çš„é—²è°ˆ"></a>å…³äº â€œæ ‡å‡†â€ çš„é—²è°ˆ</h4><ul>
<li>ä»»ä½•æŠ€æœ¯æ¨å¹¿ä½¿ç”¨éƒ½éœ€è¦ä¸€å¥—æ ‡å‡†æ¥æ”¯æ’‘</li>
<li>å¦‚ html js css http ç­‰ï¼Œæ— è§„çŸ©ä¸æˆæ–¹åœ†</li>
<li>ä»»ä½•ä¸ç¬¦åˆæ ‡å‡†çš„ä¸œè¥¿ï¼Œç»ˆå°†ä¼šè¢«ç”¨æˆ·æŠ›å¼ƒ</li>
<li>ä¸è¦æŒ‘æˆ˜æ ‡å‡†ï¼Œä¸è¦è‡ªé€ æ ‡å‡†</li>
</ul>
<h4 id="çŠ¶æ€å˜åŒ–"><a href="#çŠ¶æ€å˜åŒ–" class="headerlink" title="çŠ¶æ€å˜åŒ–"></a>çŠ¶æ€å˜åŒ–</h4><ul>
<li>ä¸‰ç§çŠ¶æ€ï¼špending fulfilled rejected</li>
<li>åˆå§‹çŠ¶æ€ï¼špending</li>
<li><strong>æˆåŠŸ</strong>ï¼špending å˜æˆ fulfilled ï¼Œ<strong>å¤±è´¥</strong>ï¼špending å˜æˆ rejected</li>
<li>çŠ¶æ€å˜åŒ–ä¸å¯é€†</li>
</ul>
<h4 id="then"><a href="#then" class="headerlink" title="then"></a>then</h4><ul>
<li><p>Promise å®ä¾‹å¿…é¡»å®ç° then è¿™ä¸ªæ–¹æ³•</p>
</li>
<li><p>then() å¿…é¡»å¯ä»¥æ¥å—ä¸¤ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°</p>
</li>
<li><p>then() è¿”å›çš„å¿…é¡»æ˜¯ä¸€ä¸ª Promise å®ä¾‹</p>
<p><img src="http://static.zxinc520.com/blog/20190814/p2zjIfnNkjIp.png?imageslim" alt="mark"></p>
</li>
</ul>
<h3 id="é—®é¢˜è§£ç­”-3"><a href="#é—®é¢˜è§£ç­”-3" class="headerlink" title="é—®é¢˜è§£ç­”"></a>é—®é¢˜è§£ç­”</h3><p><strong>é—®é¢˜ï¼šPromise çš„åŸºæœ¬ä½¿ç”¨å’ŒåŸç†ï¼Ÿ</strong></p>
<ul>
<li>åŸºæœ¬è¯­æ³• ï¼ˆå¤ä¹ ï¼‰</li>
<li>å¦‚ä½•å¼‚å¸¸æ•è· ï¼ˆ error å’Œ reject éƒ½è¦è€ƒè™‘ï¼‰</li>
<li>å¤šä¸ªä¸²è” - é“¾å¼æ‰§è¡Œçš„å¥½å¤„</li>
<li>Promise.all å’Œ Promise.race</li>
<li>Promise æ ‡å‡† - çŠ¶æ€å˜åŒ–ï¼Œthen å‡½æ•°</li>
</ul>
<h2 id="4-5-async-await"><a href="#4-5-async-await" class="headerlink" title="4-5 async/await"></a>4-5 async/await</h2><blockquote>
<p>ES2017 æ ‡å‡†å¼•å…¥äº† async å‡½æ•°ï¼Œä½¿å¾—å¼‚æ­¥æ“ä½œå˜å¾—æ›´åŠ æ–¹ä¾¿ã€‚</p>
<p>async å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿä¸€å¥è¯ï¼Œå®ƒå°±æ˜¯ Generator å‡½æ•°çš„è¯­æ³•ç³–ã€‚</p>
<p><a target="_blank" rel="noopener" href="http://es6.ruanyifeng.com/">ECMAScript 6 å…¥é—¨</a> <a target="_blank" rel="noopener" href="http://es6.ruanyifeng.com/#docs/async">async å‡½æ•°</a></p>
</blockquote>
<ul>
<li>then åªæ˜¯å°† callback æ‹†åˆ†äº†</li>
<li>async/await æ˜¯æœ€ç›´æ¥çš„åŒæ­¥å†™æ³•</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190815/B2MsvoDMkq7B.png?imageslim" alt="mark"></p>
<p><strong>æœ€ç›´æ¥çš„åŒæ­¥å†™æ³•ï¼š</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> load = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> result1 = <span class="keyword">await</span> loadImg(src1);</span><br><span class="line">  <span class="built_in">console</span>.log(result1);</span><br><span class="line">  <span class="keyword">const</span> result2 = <span class="keyword">await</span> loadImg(src2);</span><br><span class="line">  <span class="built_in">console</span>.log(result2);</span><br><span class="line">&#125;;</span><br><span class="line">load();</span><br></pre></td></tr></table></figure>

<h3 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><ul>
<li>ä½¿ç”¨ awaitï¼Œå‡½æ•°å¿…é¡»ç”¨ async æ ‡è¯†</li>
<li>await åé¢è·Ÿçš„æ˜¯ä¸€ä¸ª Promise å®ä¾‹</li>
<li>éœ€è¦ babel-polyfill</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadImg</span>(<span class="params">src</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> img = <span class="built_in">document</span>.createElement(<span class="string">&quot;img&quot;</span>);</span><br><span class="line">    img.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      resolve(img);</span><br><span class="line">    &#125;;</span><br><span class="line">    img.onerror = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      reject();</span><br><span class="line">    &#125;;</span><br><span class="line">    img.src = src;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> promise;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> src1 =</span><br><span class="line">  <span class="string">&quot;https://edu-image.nosdn.127.net/B34DC36428D2D51B8EF5EE2C83CE9BF2.png?imageView&amp;thumbnail=241y34&amp;quality=100&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> src2 = <span class="string">&quot;https://www.imooc.com/static/img/index/logo.png&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> load = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> result1 = <span class="keyword">await</span> loadImg(src1);</span><br><span class="line">  <span class="built_in">console</span>.log(result1);</span><br><span class="line">  <span class="keyword">const</span> result2 = <span class="keyword">await</span> loadImg(src2);</span><br><span class="line">  <span class="built_in">console</span>.log(result2);</span><br><span class="line">&#125;;</span><br><span class="line">load();</span><br></pre></td></tr></table></figure>

<h3 id="é—®é¢˜è§£ç­”-4"><a href="#é—®é¢˜è§£ç­”-4" class="headerlink" title="é—®é¢˜è§£ç­”"></a>é—®é¢˜è§£ç­”</h3><ul>
<li>ä»‹ç»ä¸€ä¸‹ async/awaitï¼ˆES7ï¼‰ï¼ˆå’Œ Promise çš„åŒºåˆ«ã€è”ç³»ï¼‰<ul>
<li>åŸºæœ¬è¯­æ³•</li>
<li>ä½¿ç”¨äº† Promiseï¼Œå¹¶æ²¡æœ‰å’Œ Promise å†²çª</li>
<li>å®Œå…¨æ˜¯åŒæ­¥çš„å†™æ³•ï¼Œå†ä¹Ÿæ²¡æœ‰å›è°ƒå‡½æ•°</li>
<li>ä½†æ˜¯ï¼šæ”¹å˜ä¸äº† JS å•çº¿ç¨‹ã€å¼‚æ­¥çš„æœ¬è´¨</li>
</ul>
</li>
</ul>
 
      <!-- reward -->
      
      <div id="reword-out">
        <div id="reward-btn">
          Donate
        </div>
      </div>
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>Copyrightï¼š </strong>
          
          Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source.
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        åˆ†äº«
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://blog.zxinc520.com/2019/08/14/asynchronization/" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JS-%E4%B8%89%E5%BA%A7%E5%A4%A7%E5%B1%B1/" rel="tag">JS ä¸‰åº§å¤§å±±</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Promise/" rel="tag">Promise</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/event-loop/" rel="tag">event loop</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%95%E7%BA%BF%E7%A8%8B/" rel="tag">å•çº¿ç¨‹</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%82%E6%AD%A5%E7%9A%84-Deferred/" rel="tag">å¼‚æ­¥çš„ Deferred</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2019/08/29/hybrid/" class="article-nav-link">
        <strong class="article-nav-caption">ä¸Šä¸€ç¯‡</strong>
        <div class="article-nav-title">
          
            hybrid
          
        </div>
      </a>
    
    
      <a href="/2019/08/10/NewPrototype/" class="article-nav-link">
        <strong class="article-nav-caption">ä¸‹ä¸€ç¯‡</strong>
        <div class="article-nav-title">åŸå‹</div>
      </a>
    
  </nav>

   
<!-- valineè¯„è®º -->
<div id="vcomments-box">
  <div id="vcomments"></div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script>
<script>
  new Valine({
    el: "#vcomments",
    app_id: "r4vo4ryYh2sz7J3rIgfbrM39-gzGzoHsz",
    app_key: "90mAWj0v51lHHeSeAXqsJ27Q",
    path: window.location.pathname,
    avatar: "monsterid",
    placeholder: "ç»™æˆ‘çš„æ–‡ç« åŠ ç‚¹è¯„è®ºå§~",
    recordIP: true,
  });
  const infoEle = document.querySelector("#vcomments .info");
  if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
    infoEle.childNodes.forEach(function (item) {
      item.parentNode.removeChild(item);
    });
  }
</script>
<style>
  #vcomments-box {
    padding: 5px 30px;
  }

  @media screen and (max-width: 800px) {
    #vcomments-box {
      padding: 5px 0px;
    }
  }

  #vcomments-box #vcomments {
    background-color: #fff;
  }

  .v .vlist .vcard .vh {
    padding-right: 20px;
  }

  .v .vlist .vcard {
    padding-left: 10px;
  }
</style>

 
     
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2020
        <i class="ri-heart-fill heart_icon"></i> zhou chen
      </li>
    </ul>
    <ul>
      <li>
        
        
        
        Powered by <a href="https://hexo.io" target="_blank">Hexo</a>
        <span class="division">|</span>
        Theme - <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></s>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzzç»Ÿè®¡ -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/logozc.jpg" alt="èŠ ğŸ’—  ç›"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">ä¸»é¡µ</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">å½’æ¡£</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">åˆ†ç±»</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">æ ‡ç­¾</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="http://zxinc520.com">ä¸ªäººåšå®¢</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">å‹æƒ…é“¾æ¥</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>è¯·æˆ‘å–æ¯å’–å•¡å§~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="http://static.zxinc520.com/blog/20190512/p4IWzLUrorWK.jpg?imageslim">
      <span class="reward-type">æ”¯ä»˜å®</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="http://static.zxinc520.com/blog/20190512/pGHOMdDF79sb.jpg?imageslim">
      <span class="reward-type">å¾®ä¿¡</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->


<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: 'main',
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto'
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // sliderå±•å¼€çŠ¶æ€
                // todo: è¿™æ ·ä¸å¥½ï¼Œåé¢æ”¹æˆçŠ¶æ€
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // è·å¾—åŸå›¾å°ºå¯¸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->


<script src="/js/busuanzi-2.3.pure.min.js"></script>


<!-- ClickLove -->

<!-- ClickBoom1 -->

<script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script>

<script src="/js/clickBoom1.js"></script>


<!-- ClickBoom2 -->

<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->


    
  </div>
</body>

</html>