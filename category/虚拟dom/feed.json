{
    "version": "https://jsonfeed.org/version/1",
    "title": "sunflower • All posts by \"虚拟dom\" category",
    "description": "周琛的博客",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2019/09/20/virtualDOM/",
            "url": "http://example.com/2019/09/20/virtualDOM/",
            "title": "虚拟DOM",
            "date_published": "2019-09-20T06:47:32.000Z",
            "content_html": "<h1 id=\"虚拟-dom\"><a class=\"markdownIt-Anchor\" href=\"#虚拟-dom\">#</a> 虚拟 DOM</h1>\n<blockquote>\n<p>本章分析了<strong>虚拟 DOM</strong> 的使用场景、<strong>常用 API</strong>、以及 <strong>diff 算法</strong> 的代码框架。通过学习和了解虚拟 DOM ，为后面的 vue 和 React 学习打好基础。</p>\n<p><strong>知识点</strong></p>\n<p>5-1 什么是 vdom，为何使用 vdom？</p>\n<p>5-2 vdom 的如何应用，核心 API 是什么？</p>\n<p>5-3 介绍 一下 diff 算法</p>\n<p>Ignorance is the curse of God, knowledge the wing wherewith we fly to heaven.——William Shakespeare</p>\n<p>无知乃是罪恶，知识乃是我们借以飞向天堂的翅膀。—— 莎士比亚</p>\n</blockquote>\n<h3 id=\"virtual-dom\"><a class=\"markdownIt-Anchor\" href=\"#virtual-dom\">#</a> virtual dom</h3>\n<ul>\n<li>vdom 是 vue 和 React 的核心，先讲哪个都绕不开它</li>\n<li>vdom 比较独立，使用也比较简单</li>\n<li>如果面试问到 vue 和 React 的实现，免不了问 vdom</li>\n</ul>\n<h3 id=\"问题\"><a class=\"markdownIt-Anchor\" href=\"#问题\">#</a> 问题</h3>\n<ul>\n<li>vdom 是什么？为何会存在 vdom？</li>\n<li>vdom 的如何应用，核心 API 是什么？</li>\n<li>介绍一下 diff 算法</li>\n</ul>\n<h2 id=\"5-1-什么是-vdom为何使用-vdom\"><a class=\"markdownIt-Anchor\" href=\"#5-1-什么是-vdom为何使用-vdom\">#</a> 5-1 什么是 vdom，为何使用 vdom？</h2>\n<h3 id=\"知识点\"><a class=\"markdownIt-Anchor\" href=\"#知识点\">#</a> 知识点</h3>\n<ul>\n<li>什么是 vdom？</li>\n<li>设计一个需求场景</li>\n<li>用 jQuery 实现</li>\n<li>遇到的问题</li>\n</ul>\n<h4 id=\"什么是-vdom\"><a class=\"markdownIt-Anchor\" href=\"#什么是-vdom\">#</a> 什么是 vdom？</h4>\n<ul>\n<li>virtual dom，虚拟 DOM</li>\n<li>用 JS 模拟 DOM 结构</li>\n<li>DOM 变化的对比，放在 JS 层来做 （ 图灵完备语言 ）</li>\n<li>提高重绘性能</li>\n</ul>\n<pre class=\"line-numbers language-js\" data-language=\"js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span>ul id<span class=\"token operator\">=</span><span class=\"token string\">\"list\"</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>li <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"item\"</span><span class=\"token operator\">></span>Item <span class=\"token number\">1</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>li <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"item\"</span><span class=\"token operator\">></span>Item <span class=\"token number\">2</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>ul<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p><strong>用 JS 模拟 DOM</strong></p>\n<pre class=\"line-numbers language-JS\" data-language=\"JS\"><code class=\"language-JS\">&#x2F;&#x2F; vdom\n&#123;\n    tag:&#39;ul&#39;,\n    attrs:&#123;\n        id:&#39;list&#39;\n    &#125;,\n    children:[\n        &#123;\n            tag:&#39;li&#39;,\n            attrs:&#123;className:&#39;item&#39;&#125;,\n            children:[&#39;Item 1&#39;]\n        &#125;,\n        &#123;\n            tag:&#39;li&#39;,\n            attrs:&#123;className:&#39;item&#39;&#125;,\n            children:[&#39;Item 2&#39;]\n        &#125;\n    ]\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"设计一个需求场景\"><a class=\"markdownIt-Anchor\" href=\"#设计一个需求场景\">#</a> 设计一个需求场景</h4>\n<pre class=\"line-numbers language-js\" data-language=\"js\"><code class=\"language-js\"><span class=\"token comment\">/*\n * 1.将该数据展示成一个表格\n * 2.随便修改一个信息，表格也跟着修改\n * */</span>\n<span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">&#123;</span>\n    name<span class=\"token operator\">:</span> <span class=\"token string\">\"张三\"</span><span class=\"token punctuation\">,</span>\n    age<span class=\"token operator\">:</span> <span class=\"token string\">\"20\"</span><span class=\"token punctuation\">,</span>\n    address<span class=\"token operator\">:</span> <span class=\"token string\">\"北京\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#123;</span>\n    name<span class=\"token operator\">:</span> <span class=\"token string\">\"李四\"</span><span class=\"token punctuation\">,</span>\n    age<span class=\"token operator\">:</span> <span class=\"token string\">\"21\"</span><span class=\"token punctuation\">,</span>\n    address<span class=\"token operator\">:</span> <span class=\"token string\">\"上海\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#123;</span>\n    name<span class=\"token operator\">:</span> <span class=\"token string\">\"王五\"</span><span class=\"token punctuation\">,</span>\n    age<span class=\"token operator\">:</span> <span class=\"token string\">\"22\"</span><span class=\"token punctuation\">,</span>\n    address<span class=\"token operator\">:</span> <span class=\"token string\">\"广州\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><em>jQuery 实现</em> ：</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UTF-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Title<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>btn-change<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>change<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n      <span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">&#123;</span>\n          name<span class=\"token operator\">:</span> <span class=\"token string\">\"张三\"</span><span class=\"token punctuation\">,</span>\n          age<span class=\"token operator\">:</span> <span class=\"token string\">\"20\"</span><span class=\"token punctuation\">,</span>\n          address<span class=\"token operator\">:</span> <span class=\"token string\">\"北京\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">&#123;</span>\n          name<span class=\"token operator\">:</span> <span class=\"token string\">\"李四\"</span><span class=\"token punctuation\">,</span>\n          age<span class=\"token operator\">:</span> <span class=\"token string\">\"21\"</span><span class=\"token punctuation\">,</span>\n          address<span class=\"token operator\">:</span> <span class=\"token string\">\"上海\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">&#123;</span>\n          name<span class=\"token operator\">:</span> <span class=\"token string\">\"王五\"</span><span class=\"token punctuation\">,</span>\n          age<span class=\"token operator\">:</span> <span class=\"token string\">\"22\"</span><span class=\"token punctuation\">,</span>\n          address<span class=\"token operator\">:</span> <span class=\"token string\">\"广州\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">//渲染函数</span>\n      <span class=\"token keyword\">function</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">var</span> $container <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#container\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//清空容器</span>\n        $container<span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">//拼接  table</span>\n        <span class=\"token keyword\">var</span> $table <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;table>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        $table<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;tr>&lt;td>name&lt;/td>&lt;td>age&lt;/td>&lt;td>address&lt;/td>&lt;/tr>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        data<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n          $table<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>\n            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>\n              <span class=\"token string\">\"&lt;tr>&lt;td>\"</span> <span class=\"token operator\">+</span>\n                item<span class=\"token punctuation\">.</span>name <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"&lt;/td>&lt;td>\"</span> <span class=\"token operator\">+</span>\n                item<span class=\"token punctuation\">.</span>age <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"&lt;/td>&lt;td>\"</span> <span class=\"token operator\">+</span>\n                item<span class=\"token punctuation\">.</span>address <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"&lt;/td>&lt;/tr>\"</span>\n            <span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">//渲染 到页面   jQuery放在这里：只有 一次DOM渲染，性能更好，但是 并不符合理想情况</span>\n        $container<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>$table<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">&#125;</span>\n\n      <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#btn-change\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        data<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>age <span class=\"token operator\">=</span> <span class=\"token number\">30</span><span class=\"token punctuation\">;</span>\n        data<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>address <span class=\"token operator\">=</span> <span class=\"token string\">\"深圳\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//  re-render 再次渲染</span>\n        <span class=\"token function\">render</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">//页面加载完，立即执行</span>\n      <span class=\"token function\">render</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><img src=\"http://static.zxinc520.com/blog/20190826/fnRWrTN8GFST.gif\" alt=\"mark\"></p>\n<h4 id=\"遇到的问题\"><a class=\"markdownIt-Anchor\" href=\"#遇到的问题\">#</a> 遇到的问题</h4>\n<ul>\n<li>DOM 操作是 “昂贵” 的，js <strong>运行效率高</strong></li>\n<li>尽量减少 DOM 操作 ，而不是 “推倒重来”</li>\n<li>项目越复杂 ，影响就越严重</li>\n<li>vdom 即可解决这个问题</li>\n</ul>\n<h4 id=\"问题解答\"><a class=\"markdownIt-Anchor\" href=\"#问题解答\">#</a> 问题解答</h4>\n<ul>\n<li>\n<p>vdom 是什么？为何会存在 vdom？</p>\n<ul>\n<li>virtual dom，虚拟 DOM</li>\n<li>用 JS 模拟 DOM 结构</li>\n<li>DOM 操作非常 “昂贵”</li>\n<li>将 DOM 对比操作放在 JS 层，提高效率</li>\n</ul>\n</li>\n<li>\n<p>vdom 的如何应用，核心 API 是什么？</p>\n<ul>\n<li>介绍 <a href=\"https://github.com/snabbdom/snabbdom\">snabbdom</a></li>\n<li>重做 之前的 demo</li>\n<li>核心 API</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"5-2-vdom-的如何应用核心-api-是什么\"><a class=\"markdownIt-Anchor\" href=\"#5-2-vdom-的如何应用核心-api-是什么\">#</a> 5-2 vdom 的如何应用，核心 API 是什么？</h2>\n<blockquote>\n<p>介绍 snabbdom ：一个 vdom 实现库。</p>\n</blockquote>\n<h3 id=\"介绍-snabbdom\"><a class=\"markdownIt-Anchor\" href=\"#介绍-snabbdom\">#</a> 介绍 snabbdom</h3>\n<blockquote>\n<p>虚拟 DOM 非常棒。它允许我们将应用程序的视图表示为其状态的函数。但现有的解决方案太过臃肿，太慢，缺乏功能，API 偏向于 OOP 和 / 或缺少我需要的功能。</p>\n<p><a href=\"https://github.com/snabbdom/snabbdom\">Snabbdom</a> 由一个非常简单，高性能和可扩展的核心组成，只有 ≈200SLOC。它提供了模块化架构，具有丰富的功能，可通过自定义模块进 为了保持核心简单，所有非必要功能都委托给模块。</p>\n<p>你可以将 Snabbdom 塑造成你想要的任何东西！选择，选择和自定义所需的功能。或者，您可以使用默认扩展并获得具有高性能，小尺寸和下面列出的所有功能的虚拟 DOM 库。</p>\n</blockquote>\n<h4 id=\"介绍-snabbdom-h-函数\"><a class=\"markdownIt-Anchor\" href=\"#介绍-snabbdom-h-函数\">#</a> 介绍 snabbdom - h 函数</h4>\n<p><img src=\"http://static.zxinc520.com/blog/20190826/DY84t1uJz1C3.png?imageslim\" alt=\"mark\"></p>\n<h4 id=\"介绍-snabbdom-patch-函数\"><a class=\"markdownIt-Anchor\" href=\"#介绍-snabbdom-patch-函数\">#</a> 介绍 snabbdom -patch 函数</h4>\n<p><img src=\"http://static.zxinc520.com/blog/20190826/dbhW2mzgt6n3.png?imageslim\" alt=\"mark\"></p>\n<h3 id=\"使用-snabbdom\"><a class=\"markdownIt-Anchor\" href=\"#使用-snabbdom\">#</a> 使用 snabbdom</h3>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UTF-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Title<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom-class.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom-props.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom-style.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom-eventlisteners.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://cdn.bootcss.com/snabbdom/0.7.3/h.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n      <span class=\"token keyword\">var</span> snabbdom <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>snabbdom<span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">//定义 patch</span>\n      <span class=\"token keyword\">var</span> patch <span class=\"token operator\">=</span> snabbdom<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n        snabbdom_class<span class=\"token punctuation\">,</span>\n        snabbdom_props<span class=\"token punctuation\">,</span>\n        snabbdom_style<span class=\"token punctuation\">,</span>\n        snabbdom_eventlisteners<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// 定义 h</span>\n      <span class=\"token keyword\">var</span> h <span class=\"token operator\">=</span> snabbdom<span class=\"token punctuation\">.</span>h<span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">var</span> container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"container\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">//生成 vnode</span>\n      <span class=\"token keyword\">var</span> vnode <span class=\"token operator\">=</span> <span class=\"token function\">h</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ul#list\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token function\">h</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"li.item\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Item 1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function\">h</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"li.item\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Item 2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token function\">patch</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">,</span> vnode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      document\n        <span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"btn-change\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n          <span class=\"token comment\">//生成 newVnode</span>\n          <span class=\"token keyword\">var</span> newVnode <span class=\"token operator\">=</span> <span class=\"token function\">h</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ul#list\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token function\">h</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"li.item\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Item 1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token function\">h</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"li.item\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Item B\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token function\">h</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"li.item\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Item 3\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">patch</span><span class=\"token punctuation\">(</span>vnode<span class=\"token punctuation\">,</span> newVnode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><img src=\"http://static.zxinc520.com/blog/20190826/o5jyCvk0PiHc.gif\" alt=\"mark\"></p>\n<h3 id=\"重做-之前的-demo\"><a class=\"markdownIt-Anchor\" href=\"#重做-之前的-demo\">#</a> 重做 之前的 demo</h3>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UTF-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Title<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>btn-change<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>change<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom-class.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom-props.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom-style.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom-eventlisteners.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://cdn.bootcss.com/snabbdom/0.7.3/h.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n      <span class=\"token keyword\">var</span> snabbdom <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>snabbdom<span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">//定义 patch</span>\n      <span class=\"token keyword\">var</span> patch <span class=\"token operator\">=</span> snabbdom<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n        snabbdom_class<span class=\"token punctuation\">,</span>\n        snabbdom_props<span class=\"token punctuation\">,</span>\n        snabbdom_style<span class=\"token punctuation\">,</span>\n        snabbdom_eventlisteners<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// 定义 h</span>\n      <span class=\"token keyword\">var</span> h <span class=\"token operator\">=</span> snabbdom<span class=\"token punctuation\">.</span>h<span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">//原始数据</span>\n      <span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">&#123;</span>\n          name<span class=\"token operator\">:</span> <span class=\"token string\">\"张三\"</span><span class=\"token punctuation\">,</span>\n          age<span class=\"token operator\">:</span> <span class=\"token string\">\"20\"</span><span class=\"token punctuation\">,</span>\n          address<span class=\"token operator\">:</span> <span class=\"token string\">\"北京\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">&#123;</span>\n          name<span class=\"token operator\">:</span> <span class=\"token string\">\"李四\"</span><span class=\"token punctuation\">,</span>\n          age<span class=\"token operator\">:</span> <span class=\"token string\">\"21\"</span><span class=\"token punctuation\">,</span>\n          address<span class=\"token operator\">:</span> <span class=\"token string\">\"上海\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">&#123;</span>\n          name<span class=\"token operator\">:</span> <span class=\"token string\">\"王五\"</span><span class=\"token punctuation\">,</span>\n          age<span class=\"token operator\">:</span> <span class=\"token string\">\"22\"</span><span class=\"token punctuation\">,</span>\n          address<span class=\"token operator\">:</span> <span class=\"token string\">\"广州\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">//把表也放在 data 中</span>\n      data<span class=\"token punctuation\">.</span><span class=\"token function\">unshift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n        name<span class=\"token operator\">:</span> <span class=\"token string\">\"姓名\"</span><span class=\"token punctuation\">,</span>\n        age<span class=\"token operator\">:</span> <span class=\"token string\">\"年龄\"</span><span class=\"token punctuation\">,</span>\n        address<span class=\"token operator\">:</span> <span class=\"token string\">\"地址\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">var</span> container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"container\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">//渲染函数</span>\n      <span class=\"token keyword\">var</span> vnode<span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">function</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">var</span> newVnode <span class=\"token operator\">=</span> <span class=\"token function\">h</span><span class=\"token punctuation\">(</span>\n          <span class=\"token string\">\"table\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n          data<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token keyword\">var</span> tds <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">var</span> i<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token keyword\">in</span> item<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n              <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span><span class=\"token function\">hasOwnProperty</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                tds<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token function\">h</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"td\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> item<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n              <span class=\"token punctuation\">&#125;</span>\n            <span class=\"token punctuation\">&#125;</span>\n            <span class=\"token keyword\">return</span> <span class=\"token function\">h</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tr\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> tds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>vnode<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n          <span class=\"token comment\">// 再次渲染</span>\n          <span class=\"token function\">patch</span><span class=\"token punctuation\">(</span>vnode<span class=\"token punctuation\">,</span> newVnode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n          <span class=\"token comment\">// 初次渲染</span>\n          <span class=\"token function\">patch</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">,</span> newVnode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n        vnode <span class=\"token operator\">=</span> newVnode<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">&#125;</span>\n\n      <span class=\"token comment\">// 初次渲染</span>\n      <span class=\"token function\">render</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">var</span> btnChange <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"btn-change\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      btnChange<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        data<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>age <span class=\"token operator\">=</span> <span class=\"token number\">30</span><span class=\"token punctuation\">;</span>\n        data<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>address <span class=\"token operator\">=</span> <span class=\"token string\">\"深圳\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//re-render</span>\n        <span class=\"token function\">render</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><img src=\"http://static.zxinc520.com/blog/20190826/c9oXjl7n0ScN.gif\" alt=\"mark\"></p>\n<h3 id=\"核心-api\"><a class=\"markdownIt-Anchor\" href=\"#核心-api\">#</a> 核心 API</h3>\n<ul>\n<li>h（’&lt;标签名&gt;’，{ … 属性 … }，[… 子元素 …]）</li>\n<li>h（’&lt;标签名&gt;’，{ … 属性 … }，[ ‘…’]）</li>\n<li>patch（container，vnode）</li>\n<li>patch（vnode，newVnode）</li>\n</ul>\n<h3 id=\"问题解答-2\"><a class=\"markdownIt-Anchor\" href=\"#问题解答-2\">#</a> 问题解答</h3>\n<ul>\n<li>vdom 的如何应用，核心 API 是什么？\n<ul>\n<li>如何使用？ 可用 snabbdom 的 用法 来 举例</li>\n<li>核心 函数 ：h 函数，patch 函数</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"5-3-介绍-一下-diff-算法\"><a class=\"markdownIt-Anchor\" href=\"#5-3-介绍-一下-diff-算法\">#</a> 5-3 介绍 一下 diff 算法</h2>\n<h3 id=\"题目\"><a class=\"markdownIt-Anchor\" href=\"#题目\">#</a> 题目</h3>\n<ul>\n<li>什么是 diff 算法？</li>\n<li>去繁就简</li>\n<li>vdom 为何用 diff 算法 ？</li>\n<li>diff 算法 的 实现流程</li>\n</ul>\n<h4 id=\"什么是-diff-算法\"><a class=\"markdownIt-Anchor\" href=\"#什么是-diff-算法\">#</a> 什么是 diff 算法</h4>\n<blockquote>\n<p>diff 算法 一直在我们身边</p>\n<p><u>并不是 Vue 和 React 创造出来的概念</u></p>\n</blockquote>\n<p><em>diff 算法命令演示</em> ：</p>\n<ul>\n<li>linux 系统下：  <code>diff log1.txt log2.txt</code>  ：比较 2 个文件的不同</li>\n<li><code>git diff xxxx</code>  的示例 ： git 里面比较不同版本间的代码差异</li>\n</ul>\n<h4 id=\"去繁就简\"><a class=\"markdownIt-Anchor\" href=\"#去繁就简\">#</a> 去繁就简</h4>\n<ul>\n<li>diff 算法非常复杂，实现难度很大，源码量很大</li>\n<li>去繁就简，讲明白核心流程 ，不关心细节</li>\n<li>面试官也大部分都不清楚细节，但是很关心核心流程</li>\n<li>去繁就简之后，依然 具有很大挑战性，并不简单</li>\n</ul>\n<h4 id=\"vdom-为何用-diff-算法\"><a class=\"markdownIt-Anchor\" href=\"#vdom-为何用-diff-算法\">#</a> vdom 为何用 diff 算法</h4>\n<ul>\n<li>DOM 操作是 “昂贵” 的，因此尽量减少 DOM 操作</li>\n<li>找出本次 DOM 必须更新的节点来更新，其它的 不更新</li>\n<li>这个 “找出” 的过程，就需要 diff 算法</li>\n</ul>\n<h3 id=\"diff-实现过程\"><a class=\"markdownIt-Anchor\" href=\"#diff-实现过程\">#</a> diff 实现过程</h3>\n<ul>\n<li>patch （container，vnode）</li>\n<li>patch （vnode，newVnode）</li>\n</ul>\n<h4 id=\"patch-containervnode\"><a class=\"markdownIt-Anchor\" href=\"#patch-containervnode\">#</a> patch （container，vnode）</h4>\n<p><img src=\"http://static.zxinc520.com/blog/20190826/EQNow2OMou5G.png?imageslim\" alt=\"mark\"></p>\n<p><strong>核心：如何使用 左边的 JS 节点 生成 右侧 Dom 节点？</strong></p>\n<p><img src=\"http://static.zxinc520.com/blog/20190826/xcTxunRSOhnV.png?imageslim\" alt=\"mark\"></p>\n<h4 id=\"patch-vnodenewvnode\"><a class=\"markdownIt-Anchor\" href=\"#patch-vnodenewvnode\">#</a> patch （vnode，newVnode）</h4>\n<blockquote>\n<p>核心：** 对比 **</p>\n</blockquote>\n<p><img src=\"http://static.zxinc520.com/blog/20190826/3a4N2wzMJLaA.png?imageslim\" alt=\"mark\"></p>\n<p><img src=\"http://static.zxinc520.com/blog/20190826/k1hdRameLCv5.png?imageslim\" alt=\"mark\"></p>\n<p><img src=\"http://static.zxinc520.com/blog/20190826/hycgLD8H9RuC.png?imageslim\" alt=\"mark\"></p>\n<h4 id=\"diff-实现过程-2\"><a class=\"markdownIt-Anchor\" href=\"#diff-实现过程-2\">#</a> diff 实现过程</h4>\n<ul>\n<li>patch （container，vnode）和 patch （vnode，newVnode）</li>\n<li>createElment</li>\n<li>updataChildren</li>\n</ul>\n<h3 id=\"问题解答-3\"><a class=\"markdownIt-Anchor\" href=\"#问题解答-3\">#</a> 问题解答</h3>\n<ul>\n<li>介绍一下 diff 算法？\n<ul>\n<li>知道什么是 diff 算法，是 linux 的基础命令</li>\n<li>vdom 中 应用 diff 算法目的： 是为了 找出需要更新的节点</li>\n<li>diff 实现：patch （container，vnode）和 patch （vnode，newVnode）</li>\n<li>核心 逻辑 ， createElment 和 updataChildren</li>\n</ul>\n</li>\n</ul>\n",
            "tags": [
                "虚拟DOM"
            ]
        }
    ]
}