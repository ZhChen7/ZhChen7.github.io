{
    "version": "https://jsonfeed.org/version/1",
    "title": "sunflower • All posts by \"node\" category",
    "description": "周琛的博客",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2019/03/18/resolveUTCtime/",
            "url": "http://example.com/2019/03/18/resolveUTCtime/",
            "title": "解决 mongodb 取出时是 UTC 时间问题",
            "date_published": "2019-03-18T09:52:20.000Z",
            "content_html": "<h1 id=\"解决-mongodb-取出时是-utc-时间问题\"><a class=\"markdownIt-Anchor\" href=\"#解决-mongodb-取出时是-utc-时间问题\">#</a> 解决 mongodb 取出时是 UTC 时间问题。</h1>\n<h2 id=\"问题描述\"><a class=\"markdownIt-Anchor\" href=\"#问题描述\">#</a> 问题描述</h2>\n<h4 id=\"问题将一个时间类型数据保存到-mongodb-数据库中在数据库中时间还是正常的时间如\"><a class=\"markdownIt-Anchor\" href=\"#问题将一个时间类型数据保存到-mongodb-数据库中在数据库中时间还是正常的时间如\">#</a> 问题：将一个时间类型数据保存到 mongodb 数据库中，在数据库中时间还是正常的时间，如：</h4>\n<p><img src=\"http://static.zxinc520.com/blogimage/20190318/n3ekfX3CcF0P.png?imageslim\" alt=\"mark\"></p>\n<p><strong>但是后台拿出来的时候却是这样的（node.js）</strong></p>\n<p><img src=\"http://static.zxinc520.com/blogimage/20190318/3KOdujSN2DnV.png?imageslim\" alt=\"mark\"></p>\n<p><em>解决方案：</em></p>\n<p>网上查阅了很多资料，可我没找到一个解决方案（可能我比较傻吧），我只有自己想解决方案。</p>\n<h1 id=\"我的解决步骤\"><a class=\"markdownIt-Anchor\" href=\"#我的解决步骤\">#</a> 我的解决步骤：</h1>\n<h4 id=\"1将-utc-时间转换为-data-类型时间\"><a class=\"markdownIt-Anchor\" href=\"#1将-utc-时间转换为-data-类型时间\">#</a> 1. 将 UTC 时间转换为 data 类型时间</h4>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/*publish在这里是一个数组，数组里面的每一项都是一个对象。 \n  比如：publish[0].publishDate = 2019-03-15T08:44:07.842Z\n*/</span>\n<span class=\"token comment\">/*遍历publish数组*/</span>\npublish<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>publishDate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><strong>结果：</strong></p>\n<p><img src=\"http://static.zxinc520.com/blogimage/20190318/okqlTlNhFEPQ.png?imageslim\" alt=\"mark\"></p>\n<p>瞬间特别开心，以为解决了，谁知？（哎！）</p>\n<h4 id=\"2我开始将转变后的时间赋给原对象\"><a class=\"markdownIt-Anchor\" href=\"#2我开始将转变后的时间赋给原对象\">#</a> 2. 我开始将转变后的时间赋给原对象：</h4>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/*遍历publish数组*/</span>\npublish<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  e<span class=\"token punctuation\">.</span>publishDate <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>publishDate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>publishDate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><strong>结果：</strong></p>\n<p><img src=\"http://static.zxinc520.com/blogimage/20190318/woBo6Xdm0nCl.png?imageslim\" alt=\"mark\"></p>\n<p>我百思不得其解，我也不知道为什么会这样，我想不可能啊！</p>\n<p>于是：我想方设法查明其中的原有，最终我发现了一个问题：</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> publish<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>publishDate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//object</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>publish<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>publishDate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//string</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>原来是<strong>类型不一样</strong>，怪不得不能直接赋值，<u>我何不把它们转换成一样的类型，然后进行赋值呢，于是，我有进行了下面的操作：</u></p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">publish<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  e<span class=\"token punctuation\">.</span>publishDate <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>publishDate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>publishDate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>但结果报错了：</p>\n<p><img src=\"http://static.zxinc520.com/blogimage/20190318/RQVh7hC91D61.png?imageslim\" alt=\"mark\"></p>\n<h2 id=\"3在我无限困惑的时候我终于想到了一种可行的解决方案\"><a class=\"markdownIt-Anchor\" href=\"#3在我无限困惑的时候我终于想到了一种可行的解决方案\">#</a> 3. 在我无限困惑的时候：我终于想到了一种可行的解决方案 ===&gt;</h2>\n<h4 id=\"我给-publish-新加了一个属性值\"><a class=\"markdownIt-Anchor\" href=\"#我给-publish-新加了一个属性值\">#</a> 我给 publish 新加了一个属性值：</h4>\n<p><img src=\"http://static.zxinc520.com/blogimage/20190318/F7Dap7RvsP1D.png?imageslim\" alt=\"mark\"></p>\n<p><strong>然后在代码中</strong>：</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">publish<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  e<span class=\"token punctuation\">.</span>UTCtodata <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>publishDate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>UTCtodata<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>结果：</p>\n<p><img src=\"http://static.zxinc520.com/blogimage/20190318/OetS9laujbDI.png?imageslim\" alt=\"mark\"></p>\n<h4 id=\"渲染到页面\"><a class=\"markdownIt-Anchor\" href=\"#渲染到页面\">#</a> 渲染到页面：</h4>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>list_time_submit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>&#123;&#123;publish[i].UTCtodata&#125;&#125;<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><strong>页面效果：</strong></p>\n<p><img src=\"http://static.zxinc520.com/blogimage/20190318/4vr3aw5u3e55.png?imageslim\" alt=\"mark\"></p>\n<p>这就是我解决 mongodb 取出时间是 UTC 时间的解决办法，如果你们有特别好，特别简单的处理办法，可一定要告诉我哦！</p>\n",
            "tags": [
                "UTC时间问题"
            ]
        }
    ]
}