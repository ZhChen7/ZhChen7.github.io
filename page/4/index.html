<!DOCTYPE html>


<html lang="en">


<head>
  <meta charset="utf-8" />
   
  <meta name="keywords" content="博客，学习网站，hexo，周琛，周琛的个人博客" />
   
  <meta name="description" content="周琛的博客" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
     周琛的博客
  </title>
  <meta name="generator" content="hexo-theme-ayer">
  
  <link rel="shortcut icon" href="/favicon.png" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
  
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

  
  

  

<link rel="alternate" href="/atom.xml" title="sunflower" type="application/atom+xml">
</head>

</html>

<body>
  <div id="app">
    
      <canvas class="fireworks"></canvas>
      <style>
        .fireworks {
          position: fixed;
          left: 0;
          top: 0;
          z-index: 99999;
          pointer-events: none;
        }
      </style>
      
      
    <main class="content on">
      
<section class="cover">
    
      
      <a class="forkMe" href="https://github.com/ZhChen7"
        target="_blank"><img width="149" height="149" src="/images/forkme.png"
          class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover4.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">sunflower</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['我们', '我们要珍惜所有的感动,', '入目无他人 四下皆是你！'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-ComplexityAnalysis"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/09/11/ComplexityAnalysis/"
    >面试中的复杂度分析</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2019/09/11/ComplexityAnalysis/" class="article-date">
  <time datetime="2019-09-11T11:56:35.000Z" itemprop="datePublished">2019-09-11</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%8E%A9%E8%BD%AC%E7%AE%97%E6%B3%95%E9%9D%A2%E8%AF%95/">玩转算法面试</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="面试中的复杂度分析"><a class="markdownIt-Anchor" href="#面试中的复杂度分析">#</a> 面试中的复杂度分析</h1>
<blockquote>
<p>很多同学一提起复杂度分析就头疼，马上想起了《算法导论》中复杂的数学推导。但其实在一般的企业面试中，对复杂度的分析要求并没有那么高，但也是绕不过去的坎儿。在这一章，和大家介绍一下，面试中需要掌握的复杂度分析。…</p>
</blockquote>
<h2 id="2-1-究竟什么是大-obig-o"><a class="markdownIt-Anchor" href="#2-1-究竟什么是大-obig-o">#</a> 2-1 究竟什么是大 O（Big O）</h2>
<h4 id="大-o"><a class="markdownIt-Anchor" href="#大-o">#</a> 大 O？</h4>
<ul>
<li>n 表示数据规模</li>
<li>O（f (n)）表示运行算法所需要执行的指令数，和 f (n) 成正比</li>
</ul>
<h4 id="例如"><a class="markdownIt-Anchor" href="#例如">#</a> 例如</h4>
<ul>
<li>二分查找法 O (logn) — 所需执行指令数 ：a * logn</li>
<li>寻找 数组中的最大 / 最小值 O (n) — 所需执行指令数 ：b * n</li>
<li>归并排序算法 O (nlogn) — 所需执行指令数 ：c * nlogn</li>
<li>选择排序法 O (n^2) — 所需执行指令数 ：d * n^2</li>
</ul>
<h3 id="到底什么是-big-o"><a class="markdownIt-Anchor" href="#到底什么是-big-o">#</a> 到底什么是 Big O？</h3>
<p><img src="http://static.zxinc520.com/blog/20190909/61aLQ2wE8prQ.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190909/2PO7UfwEDOpW.png?imageslim" alt="mark"></p>
<p><strong>在学术界</strong>，严格来讲，O (f (n)) 表示算法执行的上界</p>
<p>归并排序算法的时间复杂度是 O (nlogn) 的，同时也是 O（n^2）</p>
<p><strong>在业界</strong>，我们就使用 O 来表示算法执行的最低上界</p>
<p>我们一般不会说归并排序是 O (n^2) 的</p>
<h4 id="例子"><a class="markdownIt-Anchor" href="#例子">#</a> 例子</h4>
<ul>
<li>O（nlogn + n）= O （nlogn）</li>
<li>O（nlogn + n<sup>2）=O（n</sup>2）</li>
</ul>
<h4 id="无法判断"><a class="markdownIt-Anchor" href="#无法判断">#</a> 无法判断</h4>
<ul>
<li>
<p>O（AlogA + B） – A 与 B 无法确定</p>
</li>
<li>
<p>O（AlogA + B ^2）</p>
</li>
<li>
<p>对邻接表实现的图进行遍历</p>
<ul>
<li>时间复杂度：O（ V + E ）</li>
</ul>
</li>
</ul>
<h3 id="一个时间复杂度的问题"><a class="markdownIt-Anchor" href="#一个时间复杂度的问题">#</a> 一个时间复杂度的问题</h3>
<p>有一个字符串数组，将数组中的每一个字符串按照字母序排序；之后再将整个字符串数组按照字典序排序。整个操作的时间复杂度？</p>
<p><img src="http://static.zxinc520.com/blog/20190909/8cfiXUHkirne.png?imageslim" alt="mark"></p>
<p>正确解答：</p>
<ul>
<li>假设最长的字符串长度为 s ；数组中有 n 个字符串</li>
<li>对每个字符串排序：O（slogs）</li>
<li>将数组中的每一个字符串按照字母序排序：O（n * slog (s) ）</li>
<li>将整个字符串数组按照字典序排序：O（s * nlog (n) ）</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190909/Q5nKtKe1dCi7.png?imageslim" alt="mark"></p>
<h3 id="算法复杂度在有些情况是用例相关的"><a class="markdownIt-Anchor" href="#算法复杂度在有些情况是用例相关的">#</a> 算法复杂度在有些情况是用例相关的</h3>
<ul>
<li>
<p>插入排序 O（n ^ 2）</p>
<ul>
<li>最差情况：O（n ^ 2）</li>
<li>最好情况：O（n）</li>
<li>平均情况：O（n ^ 2）</li>
</ul>
</li>
<li>
<p>快速排序算法 O （nlogn）</p>
<ul>
<li>最差情况：O（n ^ 2）</li>
<li>最好情况：O（ nlogn ）</li>
<li>平均情况：O（ nlogn ）</li>
</ul>
</li>
</ul>
<h2 id="2-2-对数据规模有一个概念"><a class="markdownIt-Anchor" href="#2-2-对数据规模有一个概念">#</a> 2-2 对数据规模有一个概念</h2>
<h3 id="抛出问题"><a class="markdownIt-Anchor" href="#抛出问题">#</a> 抛出问题</h3>
<p>对 10 ^ 5 的数据进行选择排序，结果计算机假死？</p>
<ul>
<li>如果要想在 1s 之内解决问题：
<ul>
<li>O（n ^ 2）的算法可以处理大约 10 ^ 4 级别的数据</li>
<li>O（ n ）的算法可以处理大约 10 ^ 8 级别的数据</li>
<li>O（ nlogn ）的算法可以处理大约 10 ^7 级别的数据</li>
</ul>
</li>
</ul>
<h3 id="空间复杂度"><a class="markdownIt-Anchor" href="#空间复杂度">#</a> 空间复杂度</h3>
<ul>
<li>多开一个辅助的数组：O（n）</li>
<li>多开一个辅助的二维数组：O（n ^ 2）</li>
<li>多开常数空间：O（1）</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190909/7uFcA2L2OHhI.png?imageslim" alt="mark"></p>
<h2 id="2-3-简单的复杂度分析"><a class="markdownIt-Anchor" href="#2-3-简单的复杂度分析">#</a> 2-3 简单的复杂度分析</h2>
<h3 id="o1"><a class="markdownIt-Anchor" href="#o1">#</a> O（1）：</h3>
<p><img src="http://static.zxinc520.com/blog/20190909/wmyLLvW5hvGh.png?imageslim" alt="mark"></p>
<h3 id="o-n"><a class="markdownIt-Anchor" href="#o-n">#</a> O（ n ）：</h3>
<p><img src="http://static.zxinc520.com/blog/20190909/R4zqgJ9zJqqs.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190909/fujJT4N78Ybh.png?imageslim" alt="mark"></p>
<p>1/2 *n 次 swap 操作也是：O (n) 。</p>
<h3 id="on-2-选择排序"><a class="markdownIt-Anchor" href="#on-2-选择排序">#</a> O（n ^ 2）: (选择排序)</h3>
<p><img src="http://static.zxinc520.com/blog/20190909/HPtrTeSx6DsB.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190909/rh5JcB9dA8ux.png?imageslim" alt="mark"></p>
<p>并不是所有双重循环都是 O（n ^ 2）：例如 【因为里面的循环次数是固定的 】</p>
<p><img src="http://static.zxinc520.com/blog/20190909/Vs0lBjzBPEi9.png?imageslim" alt="mark"></p>
<p>下面算法是 O（logn）级别的： 【 自增并不是每次都加 1 】</p>
<p><img src="http://static.zxinc520.com/blog/20190909/QJC2YLSAOdAk.png?imageslim" alt="mark"></p>
<p>下面算法是 O（ sqrt (n) ）【 判断 n 是不是 一个素数】</p>
<p><img src="http://static.zxinc520.com/blog/20190909/QeClcFN8EsWa.png?imageslim" alt="mark"></p>
<h3 id="ologn-二分查找法"><a class="markdownIt-Anchor" href="#ologn-二分查找法">#</a> O（logn）：（ 二分查找法 ）</h3>
<p><img src="http://static.zxinc520.com/blog/20190909/HCC3KITFnmlL.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190909/Y18HXPKRMICe.png?imageslim" alt="mark"></p>
<h4 id="整形转成字符串"><a class="markdownIt-Anchor" href="#整形转成字符串">#</a> 整形转成字符串</h4>
<p><img src="http://static.zxinc520.com/blog/20190909/gDCAKNS0NtKo.png?imageslim" alt="mark"></p>
<h3 id="log-以-2-为底-和-以-10-为底有区别吗"><a class="markdownIt-Anchor" href="#log-以-2-为底-和-以-10-为底有区别吗">#</a> log 以 2 为底 和 以 10 为底有区别吗</h3>
<p><img src="http://static.zxinc520.com/blog/20190909/hhkkzyo7uTJM.png?imageslim" alt="mark"></p>
<h2 id="2-4-亲自试验自己算法的时间复杂度"><a class="markdownIt-Anchor" href="#2-4-亲自试验自己算法的时间复杂度">#</a> 2-4 亲自试验自己算法的时间复杂度</h2>
<h3 id="复杂度实验"><a class="markdownIt-Anchor" href="#复杂度实验">#</a> 复杂度实验</h3>
<p>实验，观察趋势</p>
<p>每次 将数据规模提高两倍，看时间的变化</p>
<h2 id="2-5-递归算法的复杂度分析"><a class="markdownIt-Anchor" href="#2-5-递归算法的复杂度分析">#</a> 2-5 递归算法的复杂度分析</h2>
<blockquote>
<p>不是有递归的函数就一定是 O（ nlogn ）！</p>
</blockquote>
<h3 id="递归中进行一次递归调用的复杂度分析"><a class="markdownIt-Anchor" href="#递归中进行一次递归调用的复杂度分析">#</a> 递归中进行一次递归调用的复杂度分析</h3>
<p>二分法使用递归：</p>
<p><img src="http://static.zxinc520.com/blog/20190911/Vrm1PVyknLyf.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190911/HKc9QUhHzufd.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190911/Mrr5oypWBxGk.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190911/1hAzDU4ifP7w.png?imageslim" alt="mark"></p>
<p>引申：上述 函数增加求 负次幂？</p>
<h3 id="递归中进行多次递归调用"><a class="markdownIt-Anchor" href="#递归中进行多次递归调用">#</a> 递归中进行多次递归调用</h3>
<p><img src="http://static.zxinc520.com/blog/20190911/DmVGKhPNOvil.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190911/vlrGbmrXl4uo.png?imageslim" alt="mark"></p>
<p>深度不一样，并不是所有 多次递归调用 的时间复杂度 为：O（2 ^ n）</p>
<p><img src="http://static.zxinc520.com/blog/20190911/copG1I1hd0ya.png?imageslim" alt="mark"></p>
<h4 id="递归函数的时间复杂度"><a class="markdownIt-Anchor" href="#递归函数的时间复杂度">#</a> 递归函数的时间复杂度</h4>
<p>查阅 <strong>主定理</strong> （面试一般不考察）</p>
<h2 id="2-6-均摊时间复杂度分析amortized-time-analysis"><a class="markdownIt-Anchor" href="#2-6-均摊时间复杂度分析amortized-time-analysis">#</a> 2-6 均摊时间复杂度分析（Amortized Time Analysis）</h2>
<p><img src="http://static.zxinc520.com/blog/20190911/lH5rYQsGwqtN.png?imageslim" alt="mark"></p>
<h2 id="2-7-避免复杂度的震荡"><a class="markdownIt-Anchor" href="#2-7-避免复杂度的震荡">#</a> 2-7 避免复杂度的震荡</h2>
<p><img src="http://static.zxinc520.com/blog/20190911/glngyIU8g3Mi.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190911/AFsH4CLIkIE3.png?imageslim" alt="mark"></p>
<h3 id="复杂度的震荡的解决方案"><a class="markdownIt-Anchor" href="#复杂度的震荡的解决方案">#</a> 复杂度的震荡的解决方案</h3>
<p><img src="http://static.zxinc520.com/blog/20190911/hwAvgAw9rUM1.png?imageslim" alt="mark"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90/" rel="tag">复杂度分析</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%A4%A7-O%EF%BC%9F/" rel="tag">大 O？</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95%E9%9D%A2%E8%AF%95/" rel="tag">算法面试</a></li></ul>

    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-AlgorithmForTheInterview01"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/09/09/AlgorithmForTheInterview01/"
    >算法面试到底是什么鬼</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2019/09/09/AlgorithmForTheInterview01/" class="article-date">
  <time datetime="2019-09-09T02:43:24.000Z" itemprop="datePublished">2019-09-09</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%8E%A9%E8%BD%AC%E7%AE%97%E6%B3%95%E9%9D%A2%E8%AF%95/">玩转算法面试</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="算法面试到底是什么鬼"><a class="markdownIt-Anchor" href="#算法面试到底是什么鬼">#</a> 算法面试到底是什么鬼？</h1>
<blockquote>
<p>玩转算法面试 从真题到思维全面提升算法思维</p>
<p>为了面试，更为了提升你的算法思维</p>
<p>一提起算法面试，很多同学就会心有余悸。可其实，大多数企业的算法面试，并没有那么可怕。并不是一定要啃完整本《算法导论》，才能玩儿转算法面试；也并不是只有 ACM 参赛选手，才能笑傲算法面试。恰恰相反，大多数算法面试关注的算法思维，其实很基础。在这一章，和大家聊一聊，算法面试，到底是什么鬼？…</p>
</blockquote>
<h2 id="1-1-算法面试不仅仅是正确的回答问题"><a class="markdownIt-Anchor" href="#1-1-算法面试不仅仅是正确的回答问题">#</a> 1-1 算法面试不仅仅是正确的回答问题</h2>
<h4 id="算法面试是什么"><a class="markdownIt-Anchor" href="#算法面试是什么">#</a> 算法面试是什么？</h4>
<ul>
<li>让大家在面对面试中的算法问题时，有一个合理的思考路径
<ul>
<li>不代表能够 “正确” 回答每一个算法问题，但是合理的思考方向其实更重要，这也是正确完成算法面试问题的前提</li>
<li>算法面试优秀不意味着技术面试优秀</li>
<li>技术面试优秀不意味着能够拿到 Offer</li>
</ul>
</li>
</ul>
<h3 id="引言"><a class="markdownIt-Anchor" href="#引言">#</a> 引言</h3>
<h4 id="问题对一组数据进行排序"><a class="markdownIt-Anchor" href="#问题对一组数据进行排序">#</a> 问题：对一组数据进行排序</h4>
<p>不假思索思考方向：</p>
<ul>
<li>快速排序算法 O（nlogn）</li>
</ul>
<p><strong>正确的方式</strong>是：应该和面试官探讨（ <strong>思考路径</strong> ）：</p>
<ul>
<li>这组数据有什么样的特征？
<ul>
<li>有没有可能包含有大量重复的元素？</li>
<li>如果有这种可能的话，三路快排是更好的选择。</li>
</ul>
</li>
<li>这组数据有什么样的特征？
<ul>
<li>是否大部分数据距离它正确的位置很近？是否近乎有序？</li>
<li>如果是这样的话，插入排序是更好的选择</li>
</ul>
</li>
<li>这组数据有什么样的特征？
<ul>
<li>是否数据的取值范围非常有限？比如对学生成绩排序</li>
<li>如果是这样的话，计数排序是更好的选择</li>
</ul>
</li>
<li>对排序有什么额外的要求？
<ul>
<li>是否需要稳定排序？</li>
<li>如果是的话，归并排序是更好的选择</li>
</ul>
</li>
<li>数据的存储状况是怎么样的？
<ul>
<li>是否是使用链表存储的？</li>
<li>如果是的话，归并排序是更好的选择</li>
</ul>
</li>
<li>数据的存储状态是怎样的？
<ul>
<li>数据的大小是否可以装载在内存里？</li>
<li>数据量很大，或者内存很小，不足以装载在内存里，需要使用外排序算法</li>
</ul>
</li>
</ul>
<h2 id="1-2-什么是正确的回答一个算法问题"><a class="markdownIt-Anchor" href="#1-2-什么是正确的回答一个算法问题">#</a> 1-2 什么是 “正确” 的回答一个算法问题</h2>
<p><strong>正确</strong> 还包含对问题的独到见解；优化；代码规范；容错性</p>
<p>如果是 非常难的问题，对你的竞争对手来说，也是难的。</p>
<p>关键在于你所表达出的解决问题的思路</p>
<p>甚至通过表达解题思路的方向，得出结论：这个问题的解决方案，应该在哪一个领域，我可以通过查阅或者进一步学习解决问题</p>
<h3 id="常见问题"><a class="markdownIt-Anchor" href="#常见问题">#</a> 常见问题</h3>
<ul>
<li>项目经历 和 项目中遇到的实际问题</li>
<li>你遇到的印象最深的 bug 是什么？</li>
<li>面向对象</li>
<li>设计模式</li>
<li>网络相关；安全相关；内存相关；并发相关</li>
<li>系统设计；scalability</li>
</ul>
<p>技术面试只是面试的一部分。面试不仅仅是考察你的技术水平，还是了解你的过去以及形成的思考行为方式</p>
<p>关于过去：参与项目至关重要</p>
<h4 id="项目经历"><a class="markdownIt-Anchor" href="#项目经历">#</a> 项目经历</h4>
<ul>
<li>本科生
<ul>
<li>毕业设计</li>
<li>其它课程设计 (大作业，大一点的程序设计等等)</li>
</ul>
</li>
<li>如何找到项目？
<ul>
<li>实习</li>
<li>参与实战课程学习
<ul>
<li>慕课网</li>
<li>Coursera</li>
</ul>
</li>
</ul>
</li>
<li>创建自己的项目
<ul>
<li>自己做小应用：计划表；备忘录；播放器…</li>
<li>自己解决小问题：爬虫；数据分析；词频统计</li>
<li>“不是项目” 的项目：一本优秀的技术书籍的代码整理等…</li>
<li>分享：自己的技术博客；github 等等…</li>
</ul>
</li>
</ul>
<h4 id="行为类问题"><a class="markdownIt-Anchor" href="#行为类问题">#</a> 行为类问题</h4>
<p>通过过去了解你的思考行为方式？</p>
<ul>
<li>遇到的最大的挑战？</li>
<li>犯过的错误？</li>
<li>遭遇的失败？</li>
<li>最享受的工作内容？</li>
<li>遇到冲突的处理方式？</li>
<li>做的最与众不同的事儿？</li>
</ul>
<h4 id="准备好合适的问题问面试官"><a class="markdownIt-Anchor" href="#准备好合适的问题问面试官">#</a> 准备好合适的问题问面试官</h4>
<ul>
<li>整个小组的大概运行模式是怎样的？</li>
<li>整个项目的后续规划是如何的？</li>
<li>这个产品中的某个问题是如何解决的？</li>
<li>为什么会选择某些技术？标准？</li>
<li>我对某个技术很感兴趣，在你的小组中我会有怎样的机会深入这种技术？</li>
</ul>
<p><strong>算法面试仍然是非常重要的一部分</strong></p>
<h2 id="1-3-如何准备算法面试"><a class="markdownIt-Anchor" href="#1-3-如何准备算法面试">#</a> 1-3 如何准备算法面试</h2>
<p>准备面试 和 准备算法面试 是两个概念</p>
<p>算法面试 ，只是面试中的一个环节</p>
<h2 id="算法面试并没有那么难"><a class="markdownIt-Anchor" href="#算法面试并没有那么难">#</a> 算法面试并没有那么难</h2>
<ul>
<li>远远不需要啃完一本 《算法导论》
<ul>
<li>过于强调理论证明</li>
</ul>
</li>
<li>高级数据结构 和 算法面试提及的概率很低
<ul>
<li>红黑树</li>
<li>计算几何</li>
<li>B - Tree</li>
<li>数论</li>
<li>斐波那契堆</li>
<li>FFT</li>
</ul>
</li>
</ul>
<p><strong>算法面试远远不需要达到信息学竞赛的水平</strong> 。</p>
<p><img src="http://static.zxinc520.com/blog/20190908/CNmOn2PupuUn.png?imageslim" alt="mark"></p>
<h3 id="算法面试的准备范围"><a class="markdownIt-Anchor" href="#算法面试的准备范围">#</a> 算法面试的准备范围</h3>
<ul>
<li>不要轻视基础算法 和 数据结构，而只关注 “有意思” 的题目</li>
</ul>
<p>重点关注：</p>
<ul>
<li>各种排序算法</li>
<li>基础数据结构和算法的实现：如堆、二叉树、图…</li>
<li>基础数据结构的使用：如链表、栈、队列、哈希表、图、Trie、并查集…</li>
<li>基础算法：深度优先、广度优先、二分查找、递归…</li>
<li>基本算法思想：递归、分治、回溯搜索、贪心、动态规划…</li>
</ul>
<h3 id="选择合适的-oj"><a class="markdownIt-Anchor" href="#选择合适的-oj">#</a> 选择合适的 OJ</h3>
<blockquote>
<p>OJ：online judge</p>
<p>在线判题系统</p>
</blockquote>
<p><img src="http://static.zxinc520.com/blog/20190908/iW0zhuflnMIs.png?imageslim" alt="mark"></p>
<h3 id="推荐"><a class="markdownIt-Anchor" href="#推荐">#</a> 推荐</h3>
<ul>
<li><a target="_blank" rel="noopener" href="https://leetcode-cn.com/">LeetCode</a> （ 源于真实的面试问题 ）</li>
<li><a target="_blank" rel="noopener" href="https://www.hackerrank.com/">HackerRank</a> （ 对问题分类很详细 ，更难一点，辅助作用）</li>
</ul>
<p><strong>注意</strong>： 在学习和实践做题之间，要掌握平衡</p>
<h2 id="1-4-解决算法面试问题的整体思路"><a class="markdownIt-Anchor" href="#1-4-解决算法面试问题的整体思路">#</a> 1-4 解决算法面试问题的整体思路</h2>
<h3 id="注意题目中的条件"><a class="markdownIt-Anchor" href="#注意题目中的条件">#</a> 注意题目中的条件</h3>
<ul>
<li>给定一个有序数组…
<ul>
<li><strong>有序</strong>： 是不是可以使用二分查找法</li>
</ul>
</li>
<li>有一些题目中的条件本质是暗示：
<ul>
<li>设计一个 O（nlogn）的算法
<ul>
<li>分治法</li>
</ul>
</li>
<li>无需考虑额外的空间
<ul>
<li>开辟额外的空间</li>
</ul>
</li>
<li>数据规模大概是 10000
<ul>
<li>O（n 的二次方）</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="当没有思路的时候"><a class="markdownIt-Anchor" href="#当没有思路的时候">#</a> 当没有思路的时候</h3>
<ul>
<li>自己给自己几个简单的测试用例，试验一下</li>
<li>不要忽视暴力解法。暴力解法通常是思考的起点</li>
</ul>
<h4 id="不要忽视暴力法"><a class="markdownIt-Anchor" href="#不要忽视暴力法">#</a> 不要忽视暴力法</h4>
<p><img src="http://static.zxinc520.com/blog/20190908/4H4HSG2k68nE.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190908/DTm490pyX7Vm.png?imageslim" alt="mark"></p>
<h2 id="优化算法"><a class="markdownIt-Anchor" href="#优化算法">#</a> 优化算法</h2>
<h3 id="无头绪的思路"><a class="markdownIt-Anchor" href="#无头绪的思路">#</a> 无头绪的思路</h3>
<ul>
<li>遍历常见的算法思路</li>
<li>遍历常见的数据结构</li>
<li>空间 和 时间的 交换 （ 哈希表 ）</li>
<li>预处理信息 （ 排序 ）</li>
<li>在瓶颈处寻找答案：O（nlogn）+ O（n ∧ 2）；O（n∧3）</li>
</ul>
<h3 id="实际编写问题"><a class="markdownIt-Anchor" href="#实际编写问题">#</a> 实际编写问题</h3>
<ul>
<li>极端条件的判断
<ul>
<li>数组为空？字符串为空？数量为 0? 指针为 NULL ？</li>
</ul>
</li>
<li>变量名</li>
<li>模块化，复用性</li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95%E9%9D%A2%E8%AF%95/" rel="tag">算法面试</a></li></ul>

    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-ReactTheory"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/09/07/ReactTheory/"
    >组件化和 React</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2019/09/07/ReactTheory/" class="article-date">
  <time datetime="2019-09-07T14:32:45.000Z" itemprop="datePublished">2019-09-07</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%A1%86%E6%9E%B6/">框架</a> / <a class="article-category-link" href="/categories/%E6%A1%86%E6%9E%B6/React/">React</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="组件化和-react"><a class="markdownIt-Anchor" href="#组件化和-react">#</a> 组件化和 React</h1>
<blockquote>
<p>本章先带领学生做一个 React 的实例，熟悉 React 开发环境、以及 <strong>组件化</strong> 的概念。然后，通过实例来讲解 React 的 <strong>实现原理</strong>，包括 <strong>JSX 的本质</strong> 、<strong>虚拟 DOM 和 JSX 的结合</strong>、以及 <strong>setState</strong> 。最后，<strong>对比 vue 和 React</strong> ，分析两者的异同。</p>
<p>组件化和 React 高级面试知识点</p>
<p>Think great thoughts and you will be great!</p>
<p>心怀伟大的理想，你将会变得伟大。</p>
</blockquote>
<h3 id="知识点"><a class="markdownIt-Anchor" href="#知识点">#</a> 知识点</h3>
<ul>
<li>是否做过 React 开发？</li>
<li>React 以及组件化的一些核心概念</li>
<li>实现流程</li>
</ul>
<h3 id="题目"><a class="markdownIt-Anchor" href="#题目">#</a> 题目</h3>
<ul>
<li>说一下对组件化的理解</li>
<li>JSX 本质是什么？</li>
<li>JSX 和 vdom 的关系？</li>
<li>说一下 setState 的过程</li>
<li>阐述一下对 React 和 Vue 的 认识</li>
</ul>
<h4 id="回顾-react"><a class="markdownIt-Anchor" href="#回顾-react">#</a> 回顾 <a target="_blank" rel="noopener" href="https://zh-hans.reactjs.org/">React</a></h4>
<ol>
<li>
<p>创建一个基本的 React 应用</p>
<p><a target="_blank" rel="noopener" href="https://github.com/facebookincubator/create-react-app">Create React App</a> 是一个用于<strong>学习 React</strong> 的舒适环境，也是用 React 创建<strong>新的单页应用</strong>的最佳方式。</p>
<p>它会配置你的开发环境，以便使你能够使用最新的 JavaScript 特性，提供良好的开发体验，并为生产环境优化你的应用程序。你需要在你的机器上安装 Node &gt;= 8.10 和 npm &gt;= 5.6。要创建项目，请执行：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npx create-react-app my-app
cd my-app
npm start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p>用 React 实现 <strong>to-do-list</strong> ：</p>
</li>
</ol>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Todo</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
      list<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      title<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">></span>
        <span class="token operator">&lt;</span>input
          type<span class="token operator">=</span><span class="token string">"text"</span>
          value<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>title<span class="token punctuation">&#125;</span>
          onChange<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeHandle</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>
        <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">clickHandle</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token operator">></span>Submit<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>
        <span class="token operator">&lt;</span>ul<span class="token operator">></span>
          <span class="token punctuation">&#123;</span>list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">&#123;</span>index<span class="token punctuation">&#125;</span><span class="token operator">></span> <span class="token punctuation">&#123;</span>item<span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span><span class="token punctuation">;</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">changeHandle</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      title<span class="token operator">:</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">addTitle</span><span class="token punctuation">(</span><span class="token parameter">title</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> currentList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      list<span class="token operator">:</span> currentList<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">clickHandle</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> title <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>title<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addTitle</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      title<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Todo<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="http://static.zxinc520.com/blog/20190907/GRlG7LRoeKp7.gif" alt="mark"></p>
<h2 id="7-1-说一下对组件化的理解"><a class="markdownIt-Anchor" href="#7-1-说一下对组件化的理解">#</a> 7-1 说一下对组件化的理解</h2>
<h3 id="知识点-2"><a class="markdownIt-Anchor" href="#知识点-2">#</a> 知识点</h3>
<ul>
<li>组件的 <strong>封装</strong></li>
<li>组件的 <strong>复用</strong></li>
</ul>
<h4 id="组件的封装"><a class="markdownIt-Anchor" href="#组件的封装">#</a> 组件的封装</h4>
<ul>
<li>视图</li>
<li>数据</li>
<li>变化逻辑 （ 数据驱动视图变化 ）</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190907/m1BCsjY31wOd.png?imageslim" alt="mark"></p>
<h4 id="组件的-复用"><a class="markdownIt-Anchor" href="#组件的-复用">#</a> 组件的 复用</h4>
<ul>
<li>props 传递</li>
<li>复用</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190907/dSD9f5yFTKYD.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190907/dig0u7rhRuJi.png?imageslim" alt="mark"></p>
<h3 id="题目-2"><a class="markdownIt-Anchor" href="#题目-2">#</a> 题目</h3>
<ul>
<li>说一下对组件化的理解？
<ul>
<li>组件的封装：封装视图、数据、变化逻辑</li>
<li>组件的复用：props 传递、复用</li>
</ul>
</li>
</ul>
<h2 id="7-2-jsx-本质是什么"><a class="markdownIt-Anchor" href="#7-2-jsx-本质是什么">#</a> 7-2 JSX 本质是什么</h2>
<h3 id="知识点-3"><a class="markdownIt-Anchor" href="#知识点-3">#</a> 知识点</h3>
<ul>
<li>JSX 语法</li>
<li>JSX 解析成 JS</li>
<li>独立的标准</li>
</ul>
<h4 id="jsx-语法"><a class="markdownIt-Anchor" href="#jsx-语法">#</a> JSX 语法</h4>
<ul>
<li>html 形式</li>
<li>引入 JS 变量和表达式</li>
<li>if … else …</li>
<li>循环</li>
<li>style 和 className</li>
<li>事件</li>
</ul>
<h4 id="提出疑问"><a class="markdownIt-Anchor" href="#提出疑问">#</a> 提出疑问</h4>
<ul>
<li>JSX 语法根本无法被浏览器所解析</li>
<li>那么它如何在浏览器运行</li>
</ul>
<h4 id="jsx-解析"><a class="markdownIt-Anchor" href="#jsx-解析">#</a> JSX 解析</h4>
<ul>
<li>JSX 其实是语法糖</li>
<li>开发环境会将 JSX 编译成 JS 代码</li>
<li>JSX 的写法 大大降低了学习成本和 编码工作量</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190907/Xy8TYGeoHcWC.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190907/yjXVnlK8oLfk.png?imageslim" alt="mark"></p>
<h4 id="jsx-独立的标准"><a class="markdownIt-Anchor" href="#jsx-独立的标准">#</a> JSX 独立的标准</h4>
<ul>
<li>JSX 是 React 引入的，但不是 React 独有的</li>
<li>React 已经将它作为一个独立的标准开放，其它项目也可用</li>
<li>React.createElement 是可以自定义修改的</li>
<li>说明：本身功能已经完备；和其它标准兼容和扩展性没问题</li>
</ul>
<h3 id="问题解答"><a class="markdownIt-Anchor" href="#问题解答">#</a> 问题解答</h3>
<ul>
<li>JSX 本质是什么？
<ul>
<li>JSX 语法（标签、JS 表达式、判断、循环、事件绑定）</li>
<li>JSX 本质就是语法糖，需被解析成 JS 才能运行</li>
<li>JSX 是独立的标准，可被其它项目使用</li>
</ul>
</li>
</ul>
<h2 id="7-3-jsx-和-vdom-的关系"><a class="markdownIt-Anchor" href="#7-3-jsx-和-vdom-的关系">#</a> 7-3 JSX 和 vdom 的关系</h2>
<h3 id="知识点-4"><a class="markdownIt-Anchor" href="#知识点-4">#</a> 知识点</h3>
<ul>
<li>分析：为何需要 vdom</li>
<li>React.createElement 和 h</li>
<li>何时 patch？</li>
<li>自定义组件的解析</li>
</ul>
<h4 id="为何需要-vdom"><a class="markdownIt-Anchor" href="#为何需要-vdom">#</a> 为何需要 vdom</h4>
<ul>
<li>vdom 是 React 初次推广开来的，结合 JSX</li>
<li>JSX 就是模板，最终要渲染成 html</li>
<li>初次渲染 + 修改 state 后的 re-render</li>
<li>正好 符合 vdom 的应用场景</li>
</ul>
<h4 id="回顾-vdom"><a class="markdownIt-Anchor" href="#回顾-vdom">#</a> 回顾 <a target="_blank" rel="noopener" href="http://www.zxinc520.com/lcj/%225d63a1bce9920a5ce05e2c3b%22">vdom</a></h4>
<ul>
<li>vdom 如何应用，核心 API 是 什么？
<ul>
<li>如何使用？ 可用 snabbdom 的 用法 来 举例</li>
<li>核心 函数 ：h 函数，patch 函数</li>
</ul>
</li>
</ul>
<p><strong>核心 API</strong> ：</p>
<ul>
<li>h（’&lt;标签名&gt;’，{ … 属性 … }，[… 子元素 …]）</li>
<li>h（’&lt;标签名&gt;’，{ … 属性 … }，[ ‘…’]）</li>
<li>patch（container，vnode）</li>
<li>patch（vnode，newVnode）</li>
</ul>
<h4 id="reactcreateelement-和-h"><a class="markdownIt-Anchor" href="#reactcreateelement-和-h">#</a> React.createElement 和 h</h4>
<p><img src="http://static.zxinc520.com/blog/20190907/hro0P4sQFQug.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190907/3N0XehWXEtQa.png?imageslim" alt="mark"></p>
<h4 id="何时-patch"><a class="markdownIt-Anchor" href="#何时-patch">#</a> 何时 patch</h4>
<ul>
<li>初次渲染 - ReactDOM.render (&lt;App /&gt;,container)</li>
<li>会触发 patch (container,vnode)</li>
<li>re-render - setState</li>
<li>会触发 patch (vnode,newVnode)</li>
</ul>
<h4 id="自定义组件的解析"><a class="markdownIt-Anchor" href="#自定义组件的解析">#</a> 自定义组件的解析</h4>
<ul>
<li>‘div’ - 直接渲染 &lt;div&gt; 即可，vdom 可以做到</li>
<li>Input 和 List ，是自定义组件 （class），vdom 默认不认识</li>
<li>因此 Input 和 List 定义的时候 必须声明 render 函数</li>
<li>根据 props 初始化实例，然后执行实例的 render 函数</li>
<li>render 函数返回的还是 vnode 对象</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190907/q3iTc0PViQbi.png?imageslim" alt="mark"></p>
<h3 id="问题解答-2"><a class="markdownIt-Anchor" href="#问题解答-2">#</a> 问题解答</h3>
<ul>
<li>为何需要 vdom：JSX 需要渲染成 html，数据驱动视图</li>
<li>React.createElement 和 h ，都生成 vnode</li>
<li>何时 patch：ReactDOM.render (…) 和 setState</li>
<li>自定义组件的解析：初始化实例，然后执行 render</li>
</ul>
<h2 id="7-4-说一下-setstate-的过程"><a class="markdownIt-Anchor" href="#7-4-说一下-setstate-的过程">#</a> 7-4 说一下 setState 的过程</h2>
<h3 id="知识点-5"><a class="markdownIt-Anchor" href="#知识点-5">#</a> 知识点</h3>
<ul>
<li>setState 的异步</li>
<li>vue 修改属性也是 异步</li>
<li>setState 的过程</li>
</ul>
<h4 id="setstate-的异步"><a class="markdownIt-Anchor" href="#setstate-的异步">#</a> setState 的异步</h4>
<p><img src="http://static.zxinc520.com/blog/20190907/z8fAo7IMaYcs.png?imageslim" alt="mark"></p>
<h4 id="setstate-为何需要异步"><a class="markdownIt-Anchor" href="#setstate-为何需要异步">#</a> setState 为何需要异步？</h4>
<ul>
<li>可能会一次执行 多次 setState</li>
<li>你无法规定、限制用户如何使用 setState</li>
<li>没必要每次 setState 都重新渲染，考虑性能</li>
<li>即便是每次重新渲染，用户也看不到中间的效果</li>
<li>只看到最后的结果即可</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190907/0E8yvUnt3JOn.png?imageslim" alt="mark"></p>
<h4 id="vue-修改属性也是异步"><a class="markdownIt-Anchor" href="#vue-修改属性也是异步">#</a> vue 修改属性也是异步</h4>
<ul>
<li>效果、原因和 setState 一样</li>
<li>对比记忆，印象深刻</li>
</ul>
<h4 id="vue-的整个实现流程"><a class="markdownIt-Anchor" href="#vue-的整个实现流程">#</a> vue 的整个实现流程</h4>
<ul>
<li>第一步：解析模板成 render 函数</li>
<li>第二步：响应式开始监听</li>
<li>第三步：首次渲染，显示页面，且绑定依赖</li>
<li>第四步：data 属性变化（ <strong>异步</strong> ），触发 rerender</li>
</ul>
<h5 id="data-属性变化"><a class="markdownIt-Anchor" href="#data-属性变化">#</a> data 属性变化</h5>
<ul>
<li>修改属性，被响应式 的 set 监听到</li>
<li>set 中执行 updataComponent （ <strong>异步</strong> ）</li>
<li>updataComponent 重新执行 vm.render ()</li>
<li>生成的 vnode 和 prevVnode，通过 patch 进行比较</li>
<li>渲染到 html 中</li>
</ul>
<h4 id="setstate-的过程"><a class="markdownIt-Anchor" href="#setstate-的过程">#</a> setState 的过程</h4>
<ul>
<li>每个组件实例，都有 renderComponent 方法</li>
<li>执行 renderComponent 会重新执行实例的 render</li>
<li>render 函数返回 newVnode，然后拿到 preVnode</li>
<li>执行 patch （preVnode，newVnode）</li>
</ul>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/* renderComponent方法 大致模拟*/</span>
<span class="token keyword">class</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

  <span class="token function">renderComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> preVnode <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_vnode<span class="token punctuation">;</span>
    <span class="token keyword">const</span> newVnode <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">patch</span><span class="token punctuation">(</span>preVnode<span class="token punctuation">,</span> newVnode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_vnode <span class="token operator">=</span> newVnode<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="问题解答-3"><a class="markdownIt-Anchor" href="#问题解答-3">#</a> 问题解答</h3>
<ul>
<li>setState 的异步：效果、原因</li>
<li>vue 修改属性也是异步：效果、原因</li>
<li>setState 的过程：最终走到 patch (preVnode, newVnode)</li>
</ul>
<h1 id="7-5-总结"><a class="markdownIt-Anchor" href="#7-5-总结">#</a> 7-5 总结</h1>
<ul>
<li>
<p>说一下对组件化的理解？</p>
<ul>
<li>组件的封装：封装视图、数据、变化逻辑</li>
<li>组件的复用：props 传递、复用</li>
</ul>
</li>
<li>
<p>JSX 本质是什么？</p>
<ul>
<li>JSX 语法（标签、JS 表达式、判断、循环、事件绑定）</li>
<li>JSX 本质就是语法糖，需被解析成 JS 才能运行</li>
<li>JSX 是独立的标准，可被其它项目使用</li>
</ul>
</li>
<li>
<p>JSX 和 vdom 的关系？</p>
<ul>
<li>为何需要 vdom：JSX 需要渲染成 html，数据驱动视图</li>
<li>React.createElement 和 h ，都生成 vnode</li>
<li>何时 patch：ReactDOM.render (…) 和 setState</li>
<li>自定义组件的解析：初始化实例，然后执行 render</li>
</ul>
</li>
<li>
<p>说一下 setState 的过程</p>
<ul>
<li>setState 的异步：效果、原因</li>
<li>vue 修改属性也是异步：效果、原因</li>
<li>setState 的过程：最终走到 patch (preVnode, newVnode)</li>
</ul>
</li>
</ul>
<h2 id="7-6-react-vs-vue"><a class="markdownIt-Anchor" href="#7-6-react-vs-vue">#</a> 7-6 React Vs vue</h2>
<h3 id="知识点-6"><a class="markdownIt-Anchor" href="#知识点-6">#</a> 知识点</h3>
<ul>
<li>两者的本质区别</li>
<li>看模板和组件化的区别</li>
<li>两者共同点</li>
<li>总结问题的答案</li>
</ul>
<h4 id="两者的本质区别"><a class="markdownIt-Anchor" href="#两者的本质区别">#</a> 两者的本质区别</h4>
<ul>
<li>vue - 本质是 MVVM 框架，由 MVC 发展而来</li>
<li>React - 本质是前端组件化框架，有后端组件化发展而来</li>
</ul>
<h4 id="模板的区别"><a class="markdownIt-Anchor" href="#模板的区别">#</a> 模板的区别</h4>
<ul>
<li>vue - 使用模板 （ 最初由 angular 提出）</li>
<li>React - 使用 JSX</li>
<li>** 模板语法 ** 上，我更倾向于 JSX</li>
<li><strong>模板分离</strong> 上，我更加倾向于 vue</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190907/3TJdcbF6Ud41.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190907/oPnkXYam0Ovp.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190907/O7ONMqnOcIxs.png?imageslim" alt="mark"></p>
<ul>
<li>模板应该 和 JS 逻辑分离</li>
<li>回顾 ” 开放封闭原则 “</li>
</ul>
<h4 id="组件化的区别"><a class="markdownIt-Anchor" href="#组件化的区别">#</a> 组件化的区别</h4>
<ul>
<li>React 本身就是组件化，没有组件化就不是 React</li>
<li>vue 也支持组件化，不过是在 MVVM 上的扩展</li>
<li>查阅 vue 组件化的文档，洋洋洒洒很多（ 侧面反映 ）</li>
<li>对于组件化，我更倾向于 React，做的彻底而清晰</li>
</ul>
<h4 id="两者的共同点"><a class="markdownIt-Anchor" href="#两者的共同点">#</a> 两者的共同点</h4>
<ul>
<li>都支持组件化</li>
<li>都是数据驱动视图</li>
</ul>
<h3 id="问题解答-4"><a class="markdownIt-Anchor" href="#问题解答-4">#</a> 问题解答</h3>
<ul>
<li>阐述一下对 React 和 Vue 的 认识
<ul>
<li>国内使用，首推 vue。文档更易读、易学、社区够大</li>
<li>如果团队水平较高，推荐使用 React。组件化 和 JSX</li>
</ul>
</li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/" rel="tag">React</a></li></ul>

    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-VueTheory"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/09/05/VueTheory/"
    >MVVM 和 vue</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2019/09/05/VueTheory/" class="article-date">
  <time datetime="2019-09-05T09:07:39.000Z" itemprop="datePublished">2019-09-05</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%A1%86%E6%9E%B6/">框架</a> / <a class="article-category-link" href="/categories/%E6%A1%86%E6%9E%B6/Vue/">Vue</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="mvvm-和-vue"><a class="markdownIt-Anchor" href="#mvvm-和-vue">#</a> MVVM 和 vue</h1>
<blockquote>
<p>本章首先介绍了 <strong>jQuery 开发方式和框架开发方式的区别</strong> ，引导学生进入框架开发的思路转变。然后通过 MVC 模式引入 <strong>MVVM</strong> ，在两者比较让学生更快熟悉 MVVM 。最后结合实例，详细讲解 vue 的 <strong>实现原理</strong> ，包括 <strong>响应式</strong>、<strong>模板解析</strong>、<strong>渲染</strong> 这三大要素。…</p>
<p>高级面试：<strong>vue 知识点</strong></p>
<p>放弃该放弃的是无奈，放弃不该放弃的是无能，不放弃该放弃的是无知，不放弃不该放弃的是执著！</p>
<p>It is helpless to give up the waiver. It is incompetence to give up what should not be given up. It is ignorance that does not give up the waiver. It is attachment that does not give up and should not give up!</p>
</blockquote>
<h3 id="知识点"><a class="markdownIt-Anchor" href="#知识点">#</a> 知识点</h3>
<ul>
<li>如何 理解 MVVM</li>
<li>如何 实现 MVVM</li>
<li>是否解读过 vue 源码</li>
</ul>
<h3 id="题目"><a class="markdownIt-Anchor" href="#题目">#</a> 题目</h3>
<ul>
<li>说一下 使用 jQuery 和 使用框架的区别</li>
<li>说一下 对 MVVM 的理解</li>
<li>vue 中如何实现 <strong>响应式</strong></li>
<li>vue 中如何解析 <strong>模板</strong></li>
<li>vue 的 整个实现流程</li>
</ul>
<h2 id="使用-jquery-和-使用框架的区别"><a class="markdownIt-Anchor" href="#使用-jquery-和-使用框架的区别">#</a> 使用 jQuery 和 使用框架的区别</h2>
<h3 id="实现"><a class="markdownIt-Anchor" href="#实现">#</a> 实现</h3>
<ul>
<li>jQuery 实现 todo-list</li>
<li>vue 实现 todo-list</li>
<li>jQuery 和 框架的区别</li>
</ul>
<h4 id="jquery-实现-todo-list"><a class="markdownIt-Anchor" href="#jquery-实现-todo-list">#</a> jQuery 实现 todo-list</h4>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>txt-title<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn-submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>submit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ul-list<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">var</span> $txtTitle <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#txt-title"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> $ulList <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#ul-list"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> $btnSubmit <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#btn-submit"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      $btnSubmit<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> title <span class="token operator">=</span> $txtTitle<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>title<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">var</span> $li <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;li></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>title<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">&lt;/li></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        $ulList<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>$li<span class="token punctuation">)</span><span class="token punctuation">;</span>
        $txtTitle<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="http://static.zxinc520.com/blog/20190902/BaCUCHQ12jJW.gif" alt="mark"></p>
<h4 id="vue-实现-todo-list"><a class="markdownIt-Anchor" href="#vue-实现-todo-list">#</a> vue 实现 todo-list</h4>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>submit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item in list<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123;item&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.bootcss.com/vue/2.6.10/vue.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        el<span class="token operator">:</span> <span class="token string">"#app"</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          title<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
          list<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        methods<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token function-variable function">add</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="http://static.zxinc520.com/blog/20190903/sQq0jR7s1E7E.gif" alt="mark"></p>
<h3 id="两者的区别"><a class="markdownIt-Anchor" href="#两者的区别">#</a> 两者的区别</h3>
<ul>
<li><strong>数据</strong> 和 <strong>视图</strong> 的分离</li>
<li>以数据驱动视图</li>
</ul>
<h3 id="问题解答"><a class="markdownIt-Anchor" href="#问题解答">#</a> 问题解答</h3>
<ul>
<li>说一下 使用 jQuery 和 使用框架的区别 ？
<ul>
<li><strong>数据</strong> 和 <strong>视图</strong> 的分离，<u>解耦</u>（ <em>开放封闭原则</em> ）</li>
<li>以数据驱动视图，只关心数据变化，DOM 操作被封装</li>
</ul>
</li>
</ul>
<h2 id="说一下-对-mvvm-的理解"><a class="markdownIt-Anchor" href="#说一下-对-mvvm-的理解">#</a> 说一下 对 MVVM 的理解</h2>
<blockquote>
<p>目前前端框架中，最为出色的要属 Vue 和 React 了，这俩个框架的核心理念都<strong>是数据驱动页面渲染</strong>，同时他们都是 MVVM 模式的框架，<strong>MVVM 模式</strong> 中的 M 还是固定表示 Modal，V 还是表死 View，这俩个基本都是不会发生变化，一个页面必然需要数据和渲染俩个部分，那么变化的是如何将 Modal 渲染到 View 的过程变了，在 MVVM 模式中，将 View 和 Modal 绑定在一起，只要 Modal 发生了变化，View 就会自动更新，不需要我们认为的再去写如何操作 DOM 更新的过程了</p>
</blockquote>
<h3 id="知识点-2"><a class="markdownIt-Anchor" href="#知识点-2">#</a> 知识点</h3>
<ul>
<li>MVC</li>
<li>MVVM</li>
<li>关于 ViewModel</li>
</ul>
<h4 id="mvc"><a class="markdownIt-Anchor" href="#mvc">#</a> MVC</h4>
<ul>
<li>M -Model 数据</li>
<li>V - View 视图、界面</li>
<li>C - Controller 控制器 、逻辑处理</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190903/k21xefObaEwr.png?imageslim" alt="mark"></p>
<p><strong>MVC</strong> 模式（Model–view–controller）是软件工程中的一种软件架构模式，把软件系统分为三个基本部分：模型（Model）、视图（View）和控制器（Controller）。</p>
<p>在前端的 <strong>MVC 模式</strong> 中，M 还是表示 Modal 层，负责与后台交互数据，V 表示 View，负责页面上 DOM 的渲染，C 表示绑定在 DOM 元素上的事件，当 Controllor 中的事件被调用，会去调用 Modal 中的数据，然后交给 View 重新渲染数据</p>
<h4 id="mvvm"><a class="markdownIt-Anchor" href="#mvvm">#</a> MVVM</h4>
<ul>
<li>M - Model 模型、数据</li>
<li>V - View 视图、模板（ 视图和模板是分离的 ）</li>
<li>ViewModel - <strong>连接</strong> Model 和 View</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190903/23g0MdeUf9sw.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190903/1qFclAqzYLGt.png?imageslim" alt="mark"></p>
<h4 id="关于-viewmodel"><a class="markdownIt-Anchor" href="#关于-viewmodel">#</a> 关于 ViewModel</h4>
<ul>
<li>MVVM 不算是一种创新</li>
<li>但其中的 ViewModel 确实是一种创新</li>
<li>真正 结合前端场景应用的创建</li>
</ul>
<h3 id="问题解答-2"><a class="markdownIt-Anchor" href="#问题解答-2">#</a> 问题解答</h3>
<ul>
<li>说一下 对 MVVM 的理解
<ul>
<li>MVVM - Model View ViewModel</li>
<li>三者之间的联系。以及如何对应到各段代码</li>
<li>ViewModel 的理解，联系 View 和 Model</li>
</ul>
</li>
</ul>
<h1 id="mvvm-框架的三大要素"><a class="markdownIt-Anchor" href="#mvvm-框架的三大要素">#</a> MVVM 框架的三大要素</h1>
<h3 id="流程"><a class="markdownIt-Anchor" href="#流程">#</a> 流程</h3>
<ul>
<li>再次分析 demo</li>
<li>三要素总结</li>
</ul>
<h3 id="三要素"><a class="markdownIt-Anchor" href="#三要素">#</a> 三要素</h3>
<ul>
<li>响应式：vue 如何监听到 data 的每个属性变化？</li>
<li>模板引擎：vue 的模板如何被解析，指令如何处理？</li>
<li>渲染：vue 的模板如何被渲染成 html？以及渲染过程</li>
</ul>
<h2 id="vue-中如何实现响应式"><a class="markdownIt-Anchor" href="#vue-中如何实现响应式">#</a> vue 中如何实现响应式</h2>
<h3 id="知识点-3"><a class="markdownIt-Anchor" href="#知识点-3">#</a> 知识点</h3>
<ul>
<li>什么是响应式？</li>
<li>Object.defineProperty</li>
<li>模拟</li>
</ul>
<h4 id="什么是响应式"><a class="markdownIt-Anchor" href="#什么是响应式">#</a> 什么是响应式？</h4>
<ul>
<li>修改 data 属性后，vue 立刻监听到</li>
<li>data 属性被代理到 vm 上</li>
<li>演示</li>
</ul>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>&#123;&#123;age&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>&#123;&#123;name&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.bootcss.com/vue/2.6.10/vue.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        el<span class="token operator">:</span> <span class="token string">"#app"</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          name<span class="token operator">:</span> <span class="token string">"张三"</span><span class="token punctuation">,</span>
          age<span class="token operator">:</span> <span class="token string">"18"</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="http://static.zxinc520.com/blog/20190904/h1SkefYXlHkn.gif" alt="mark"></p>
<h4 id="objectdefineproperty"><a class="markdownIt-Anchor" href="#objectdefineproperty">#</a> Object.defineProperty</h4>
<blockquote>
<p><code>Object.defineProperty()</code>  方法会直接在一个对象上定义一个新属性，或者修改一个对象的现有属性， 并返回这个对象。</p>
<p><strong>语法</strong> ：Object.defineProperty (obj, prop, descriptor)</p>
<p><strong>参数</strong> ：</p>
<p><u>Object.defineProperty(obj, prop, descriptor)</u></p>
<p><strong>obj</strong> ：要在其上定义属性的对象。</p>
<p><strong>prop</strong> ：要定义或修改的属性的名称。</p>
<p><strong>descriptor</strong> ：将被定义或修改的属性描述符。</p>
</blockquote>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"张三"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取属性的时候，如何监听到？</span>
obj<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">26</span><span class="token punctuation">;</span> <span class="token comment">//赋值属性的时候，如何监听到？</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><em>Object.defineProperty：</em></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"张三"</span><span class="token punctuation">;</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"get"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"set"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    name <span class="token operator">=</span> newVal<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"list"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="模拟实现"><a class="markdownIt-Anchor" href="#模拟实现">#</a> 模拟实现</h3>
<blockquote>
<p>模拟实现 Vue 如何监听 data</p>
</blockquote>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/*
* 如何监听data
var vm=new Vue(&#123;
    el:'张三',
    data:&#123;
        name:'张三',
        age:20
    &#125;
&#125;)
*/</span>

<span class="token comment">//模拟实现</span>
<span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  price<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span> <span class="token string">"张三"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> key<span class="token punctuation">,</span> value<span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">//命中闭包。新建一个函数，保证 key 的独立的作用域</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
      <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"get"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//监听</span>
        <span class="token keyword">return</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"set"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//监听</span>
        data<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> newVal<span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="http://static.zxinc520.com/blog/20190904/P570ewmXOdNX.gif" alt="mark"></p>
<h3 id="问题解答-3"><a class="markdownIt-Anchor" href="#问题解答-3">#</a> 问题解答</h3>
<ul>
<li>什么是响应式？
<ul>
<li>关键是理解 Object.defineProperty</li>
<li>将 data 的属性代理到 vm 上</li>
</ul>
</li>
</ul>
<h2 id="vue-中如何解析模板"><a class="markdownIt-Anchor" href="#vue-中如何解析模板">#</a> vue 中如何解析模板</h2>
<h3 id="知识点-4"><a class="markdownIt-Anchor" href="#知识点-4">#</a> 知识点</h3>
<ul>
<li>模板是什么？</li>
<li>render 函数</li>
<li>render 函数 与 vdom</li>
</ul>
<h4 id="模板是什么"><a class="markdownIt-Anchor" href="#模板是什么">#</a> 模板是什么？</h4>
<ul>
<li>
<p>本质：字符串</p>
</li>
<li>
<p>有逻辑，如 v-if 、v-for 等</p>
</li>
<li>
<p>与 html 格式很像，但有很大区别</p>
</li>
<li>
<p>最终还要转换为 html 来显示</p>
</li>
<li>
<p><strong>模板最终必须转化成 JS 代码</strong> ，因为：</p>
<ul>
<li>有逻辑（v-if、v-for），必须用 JS 才能实现 （ 图灵完备 ）</li>
<li>转换成 html 渲染页面，必须用 JS 才能实现</li>
<li>因此，模板最重要转换成 一个 JS 函数 （render 函数）</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>submit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item in list<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123;item&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="render-函数-with-的用法"><a class="markdownIt-Anchor" href="#render-函数-with-的用法">#</a> render 函数 - with 的用法</h4>
<blockquote>
<p>with 的用法 — <strong>自己开发的代码尽量不要使用！</strong></p>
</blockquote>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"张三"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getAddress</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"beijing"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// 不使用 with</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
  obj<span class="token punctuation">.</span><span class="token function">getAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"张三"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getAddress</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"beijing"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// 使用 with</span>
<span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">with</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">getAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="render-函数"><a class="markdownIt-Anchor" href="#render-函数">#</a> render 函数</h4>
<p><img src="http://static.zxinc520.com/blog/20190905/igfqtojmzQ4H.png?imageslim" alt="mark"></p>
<h4 id="总结"><a class="markdownIt-Anchor" href="#总结">#</a> 总结</h4>
<ul>
<li>模板中所有信息都包含在了 render 函数中</li>
<li>this 即 vm</li>
<li>price 即 this.price 即 vm.price ，即 data 中的 price</li>
<li>_c 即 this. _c 即 vm. _c</li>
</ul>
<h4 id="render-函数剖析"><a class="markdownIt-Anchor" href="#render-函数剖析">#</a> render 函数剖析</h4>
<ul>
<li>从哪里可以看到 render 函数？</li>
<li>复杂一点的例子，render 函数是什么样子的？</li>
<li>v- if 、v-for 、v-on 都是怎么处理的？</li>
</ul>
<h4 id="看一下-todo-list-demo-的-render-函数"><a class="markdownIt-Anchor" href="#看一下-todo-list-demo-的-render-函数">#</a> 看一下 todo-list demo 的 render 函数</h4>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>submit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item in list<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123;item&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">with</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> attrs<span class="token operator">:</span> <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token string">"app"</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
      <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">"input"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
        directives<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">&#123;</span>
            name<span class="token operator">:</span> <span class="token string">"model"</span><span class="token punctuation">,</span>
            rawName<span class="token operator">:</span> <span class="token string">"v-model"</span><span class="token punctuation">,</span>
            value<span class="token operator">:</span> title<span class="token punctuation">,</span>
            expression<span class="token operator">:</span> <span class="token string">"title"</span><span class="token punctuation">,</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        attrs<span class="token operator">:</span> <span class="token punctuation">&#123;</span> type<span class="token operator">:</span> <span class="token string">"text"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        domProps<span class="token operator">:</span> <span class="token punctuation">&#123;</span> value<span class="token operator">:</span> title <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        on<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          <span class="token function-variable function">input</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">$event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>$event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>composing<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
            title <span class="token operator">=</span> $event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">"button"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> on<span class="token operator">:</span> <span class="token punctuation">&#123;</span> click<span class="token operator">:</span> add <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">"submit"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">_c</span><span class="token punctuation">(</span>
      <span class="token string">"ul"</span><span class="token punctuation">,</span>
      <span class="token function">_l</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">"li"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token function">_s</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token number">0</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>根据 todo-list demo 的 render 函数</li>
<li>v- model 是怎么实现的？</li>
<li>v-on :click 是怎么实现的？</li>
<li>v- for 是怎么实现的？</li>
</ul>
<h4 id="重要"><a class="markdownIt-Anchor" href="#重要">#</a> 重要</h4>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/*
    vue2.0 开始支持预编译

    开发环境 ：写模板

    编译打包

    生产环境：JS
    --------------------------------------------
    React 组件化
    
    JSX 模板
    编译 ： -> JS 代码
    
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="渲染"><a class="markdownIt-Anchor" href="#渲染">#</a> 渲染</h3>
<ul>
<li>
<p>已经解决了 模板中 “逻辑” （v-for、v-if ）的问题</p>
</li>
<li>
<p>还剩下模板生成 html 问题</p>
</li>
<li>
<p>另外，vm._c 是什么？ render 函数 返回了什么？</p>
</li>
</ul>
<h5 id="先复习一下-vdom-的知识"><a class="markdownIt-Anchor" href="#先复习一下-vdom-的知识">#</a> 先复习一下 vdom 的知识</h5>
<blockquote>
<p>可参考 <a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225d63a1bce9920a5ce05e2c3b%22">vdom 篇</a></p>
</blockquote>
<p>vdom 的如何应用，核心 API 是什么？</p>
<ul>
<li>介绍 <a target="_blank" rel="noopener" href="https://github.com/snabbdom/snabbdom">snabbdom</a></li>
<li>重做 之前的 demo</li>
<li>核心 API</li>
</ul>
<h5 id="render-函数和-vdom"><a class="markdownIt-Anchor" href="#render-函数和-vdom">#</a> render 函数和 vdom</h5>
<p><img src="http://static.zxinc520.com/blog/20190905/ldxxH0zJ4t3s.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190905/MykHq1vOBFyL.png?imageslim" alt="mark"></p>
<ul>
<li>updataComponent 中实现了 vdom 的 patch</li>
<li>页面首次渲染执行 updataComponent</li>
<li>data 中每次修改属性，执行 updataComponent</li>
</ul>
<h3 id="问题解答-4"><a class="markdownIt-Anchor" href="#问题解答-4">#</a> 问题解答</h3>
<ul>
<li>vue 中如何解析 <strong>模板</strong>
<ul>
<li>模板：字符串，有逻辑，嵌入 JS 变量…</li>
<li>模板必须转换成 JS 代码（有逻辑，渲染 html，JS 变量）</li>
<li>render 函数是什么样子的</li>
<li>render 函数执行是返回 vnode</li>
<li>updataComponent</li>
</ul>
</li>
</ul>
<h1 id="vue-的整个实现流程"><a class="markdownIt-Anchor" href="#vue-的整个实现流程">#</a> vue 的整个实现流程</h1>
<h3 id="整个实现流程"><a class="markdownIt-Anchor" href="#整个实现流程">#</a> 整个实现流程</h3>
<ul>
<li>
<p>第一步：解析模板成 render 函数</p>
<ul>
<li>with 的用法</li>
<li>模板中的所有信息都被 render 函数 包含</li>
<li>模板中用到的 data 中的属性，都变成了 JS 变量</li>
<li>模板中的 v-model、v-for、v-on 都变成了 JS 逻辑</li>
<li>render 函数返回 vnode</li>
</ul>
</li>
<li>
<p>第二步：响应式开始监听</p>
<ul>
<li>Object.defineProperty</li>
<li>将 data 的属性代理到 vm 上</li>
</ul>
</li>
<li>
<p>第三步：首次渲染，显示页面，且绑定依赖</p>
<ul>
<li>初次渲染，执行 updataComponent ，执行 vm.render ()</li>
<li>执行 render 函数，会访问到 vm.list 和 vm.title</li>
<li>会被响应式的 get 方法监听到 （后面详细讲）</li>
<li>执行 updataComponent ，会被 vdom 的 patch 方法</li>
<li>patch 将 vnode 渲染成 DOM ，初次渲染完成</li>
</ul>
<hr>
<ul>
<li>为何要监听 get，直接监听 set 不行吗？</li>
<li>data 中有很多属性，有些被用到，有些可能不被用到</li>
<li>被用到的会走到 get ，不被用到的 不会走到 get</li>
<li>未走到 get 中的属性，set 的时候我们也无需关心</li>
<li><strong>避免不必要的重复渲染</strong></li>
</ul>
</li>
<li>
<p>第四步：data 属性变化，触发 rerender</p>
<ul>
<li>修改属性，被响应式 的 set 监听到</li>
<li>set 中执行 updataComponent</li>
<li>updataComponent 重新执行 vm.render ()</li>
<li>生成的 vnode 和 prevVnode，通过 patch 进行比较</li>
</ul>
</li>
</ul>
<h3 id="问题解答-5"><a class="markdownIt-Anchor" href="#问题解答-5">#</a> 问题解答</h3>
<ul>
<li>vue 的整个实现流程？
<ul>
<li>第一步：解析模板成 render 函数</li>
<li>第二步：响应式开始监听</li>
<li>第三步：首次渲染，显示页面，且绑定依赖</li>
<li>第四步：data 属性变化，触发 rerender</li>
</ul>
</li>
</ul>
<h1 id="总结-2"><a class="markdownIt-Anchor" href="#总结-2">#</a> 总结</h1>
<ul>
<li>
<p>说一下 使用 jQuery 和 使用框架的区别</p>
<ul>
<li><strong>数据</strong> 和 <strong>视图</strong> 的分离，<u>解耦</u>（ <em>开放封闭原则</em> ）</li>
<li>以数据驱动视图，只关心数据变化，DOM 操作被封装</li>
</ul>
</li>
<li>
<p>什么是 MVVM ？</p>
<ul>
<li>
<p>MVVM - Model View ViewModel</p>
</li>
<li>
<p>三者之间的联系。以及如何对应到各段代码</p>
</li>
<li>
<p>ViewModel 的理解，联系 View 和 Model</p>
</li>
</ul>
</li>
</ul>
<h3 id="三要素-2"><a class="markdownIt-Anchor" href="#三要素-2">#</a> 三要素</h3>
<ul>
<li>
<p>响应式：vue 如何监听到 data 的每个属性变化？</p>
</li>
<li>
<p>模板引擎：vue 的模板如何被解析，指令如何处理？</p>
</li>
<li>
<p>渲染：vue 的模板如何被渲染成 html？以及渲染过程？</p>
</li>
<li>
<p>Vue 如何实现响应式？</p>
<ul>
<li>关键是理解 Object.defineProperty</li>
<li>将 data 的属性代理到 vm 上</li>
</ul>
</li>
<li>
<p>vue 中如何解析 <strong>模板</strong> ？</p>
<ul>
<li>模板：字符串，有逻辑，嵌入 JS 变量…</li>
<li>模板必须转换成 JS 代码（有逻辑，渲染 html，JS 变量）</li>
<li>render 函数是什么样子的</li>
<li>render 函数执行是返回 vnode</li>
<li>updataComponent</li>
</ul>
</li>
<li>
<p>vue 的整个实现流程？</p>
<ul>
<li>第一步：解析模板成 render 函数</li>
<li>第二步：响应式开始监听</li>
<li>第三步：首次渲染，显示页面，且绑定依赖</li>
<li>第四步：data 属性变化，触发 rerender</li>
</ul>
</li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MVVM/" rel="tag">MVVM</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vue/" rel="tag">vue</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%93%8D%E5%BA%94%E5%BC%8F%E3%80%81%E6%A8%A1%E6%9D%BF%E8%A7%A3%E6%9E%90%E3%80%81%E6%B8%B2%E6%9F%93/" rel="tag">响应式、模板解析、渲染</a></li></ul>

    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-WeChatUp"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/09/05/WeChatUp/"
    >微信小程序笔记上</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2019/09/05/WeChatUp/" class="article-date">
  <time datetime="2019-09-05T09:07:39.000Z" itemprop="datePublished">2019-09-05</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/">微信小程序</a> / <a class="article-category-link" href="/categories/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%B8%8A%E7%AF%87/">微信小程序上篇</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="微信小程序笔记上"><a class="markdownIt-Anchor" href="#微信小程序笔记上">#</a> 微信小程序笔记上</h1>
<blockquote>
<p>微信小程序学习笔记上</p>
<p>初步接触小程序</p>
<p>基础内容介绍</p>
<p>开发者文档</p>
<p>app.js 全局生命周期函数</p>
<p>WXML 数据绑定</p>
<p>通过 wx.request 请求数据</p>
<p>微信小程序里列表渲染</p>
<p>页面相关事件处理函数</p>
<p>True mastery of any skill takes a lifetime.</p>
<p>对任何技能的掌握都需要一生的刻苦操练。</p>
</blockquote>
<h1 id="小程序简介"><a class="markdownIt-Anchor" href="#小程序简介">#</a> 小程序简介</h1>
<blockquote>
<p>小程序是一种全新的连接用户与服务的方式，它可以在微信内被便捷地获取和传播，同时具有出色的使用体验。</p>
<p>微信小程序使用了前端技术栈 JavaScript/WXML/WXSS。</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/quickstart/basic/introduction.html">相关介绍</a></p>
<p><strong>微信小程序使用了前端技术栈 JavaScript/WXML/WXSS。但和常规的前端开发又有一些区别：</strong> <a target="_blank" rel="noopener" href="https://juejin.im/entry/581db98fa0bb9f0058abffea">可以参考</a></p>
<ol>
<li><strong>JavaScript</strong>: 微信小程序的 JavaScript 运行环境即不是 Browser 也不是 Node.js。它运行在微信 App 的上下文中，不能操作 Browser context 下的 DOM，也不能通过 N*ode.js 相关接口访问操作系统 API。所以，严格意义来讲，微信小程序并不是 Html5，虽然开发过程和用到的技术栈和 Html5 是相通的。</li>
<li>**WXML：** 作为微信小程序的展示层，并不是使用 Html，而是自己发明的基于 XML 语法的描述。</li>
<li>**WXSS：** 用来修饰展示层的样式。官方的描述是 “WXSS (WeiXin Style Sheets) 是一套样式语言，用于描述 WXML 的组件样式。WXSS 用来决定 WXML 的组件应该怎么显示。” “我们的 WXSS 具有 CSS 大部分特性… 我们对 CSS 进行了扩充以及修改。” 基于 CSS2 还是 CSS3？大部分是哪些部分？是否支持 CSS3 里的动画？不得而知。</li>
</ol>
<h4 id="目录结构"><a class="markdownIt-Anchor" href="#目录结构">#</a> 目录结构：</h4>
<p><img src="http://static.zxinc520.com/blog/20190514/yTqqYeB2UoIS.png?imageslim" alt="mark"></p>
<ol>
<li><code>app.js</code>  做为小程序的入口，里面有个 App 实例，每个小程序只会有一个 App 实例，小程序启动以后触发 onLaunch 函数执行，获取用户信息</li>
<li><code>app.json</code>  是小程序的所有全局配置， <code>pages</code>  字段放置所有页面的路径， <code>window</code>  字段定义所有页面的顶部背景颜色，文字颜色 详细配置请<a href="https://link.juejin.im?target=https%3A%2F%2Fmp.weixin.qq.com%2Fdebug%2Fwxadoc%2Fdev%2Fframework%2Fconfig.html">戳这里 👇</a></li>
<li><code>app.wxss</code>  文件就是页面公用的样式，仅支持部分 css 选择器</li>
<li><code>wxml</code>  就是我们的 HTML 文件，常用标签为  <code>view</code>  、 <code>text</code>  等，没有所谓的 <code>div</code> 、 <code>span</code> 、 <code>p</code>  一类的标签了，我们习惯称它们为组件</li>
</ol>
<hr>
<blockquote>
<p><strong>设计理念：</strong></p>
<p>小程序内部可以理解成一个 mvvm 的框架，分为逻辑层和视图层，逻辑层将数据进行处理后发送给视图层，同时接受视图层的事件反馈。</p>
</blockquote>
<hr>
<p><img src="http://static.zxinc520.com/blog/20190514/U6eXvlL8evmQ.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190514/m4UDxEkFa1ae.png?imageslim" alt="mark"></p>
<h2 id="开始上手"><a class="markdownIt-Anchor" href="#开始上手">#</a> 开始上手</h2>
<blockquote>
<p><strong>开始正式学习</strong></p>
<p>基础学习部分</p>
</blockquote>
<h3 id="加载一张图片"><a class="markdownIt-Anchor" href="#加载一张图片">#</a> 加载一张图片</h3>
<p><img src="http://static.zxinc520.com/blog/20190514/GnYuPkAo16G5.png?imageslim" alt="mark"></p>
<p><em>简单使用样式</em>：</p>
<p><img src="http://static.zxinc520.com/blog/20190514/gvNQzg8BaF74.png?imageslim" alt="mark"></p>
<h2 id="wxss"><a class="markdownIt-Anchor" href="#wxss">#</a> WXSS</h2>
<blockquote>
<p>WXSS (WeiXin Style Sheets) 是一套样式语言，用于描述 WXML 的组件样式。</p>
<p>WXSS 用来决定 WXML 的组件应该怎么显示。 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxss.html">可以参考官网</a></p>
</blockquote>
<p>为了适应广大的前端开发者，WXSS 具有 CSS 大部分特性。同时为了更适合开发微信小程序，WXSS 对 CSS 进行了扩充以及修改。</p>
<p>与 CSS 相比，WXSS 扩展的特性有：</p>
<ul>
<li>尺寸单位</li>
<li>样式导入</li>
</ul>
<h2 id="尺寸单位"><a class="markdownIt-Anchor" href="#尺寸单位">#</a> 尺寸单位</h2>
<p>​ <strong>rpx</strong>（responsive pixel）: 可以根据屏幕宽度进行自适应。规定屏幕宽为 750rpx。如在 iPhone6 上，屏幕宽度为 375px，共有 750 个物理像素，则 750rpx = 375px = 750 物理像素，1rpx = 0.5px = 1 物理像素</p>
<p><img src="http://static.zxinc520.com/blog/20190514/57Wa2m8PEEyp.png?imageslim" alt="mark"></p>
<p><strong>建议：</strong> 开发微信小程序时设计师可以用 iPhone6 作为视觉稿的标准。</p>
<p><strong>注意：</strong> 在较小的屏幕上不可避免的会有一些毛刺，请在开发时尽量避免这种情况。</p>
<h2 id="全局样式与局部样式"><a class="markdownIt-Anchor" href="#全局样式与局部样式">#</a> 全局样式与局部样式</h2>
<p>定义在 app.wxss 中的样式为全局样式，作用于每一个页面。在 page 的 wxss 文件中定义的样式为局部样式，只作用在对应的页面，并会覆盖 app.wxss 中相同的选择器。</p>
<h2 id="开发者文档"><a class="markdownIt-Anchor" href="#开发者文档">#</a> 开发者文档</h2>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/image.html">开发者文档</a></p>
<p><strong>不会</strong> 或 <strong>忘了</strong> 就查文档！</p>
</blockquote>
<h3 id="image"><a class="markdownIt-Anchor" href="#image">#</a> image:</h3>
<p>​ <strong>解决图片缩放问题：</strong></p>
<ul>
<li>mode （ 常用下面 2 个属性值缩放图片 ）
<ul>
<li>aspectFit：缩放模式，保持纵横比缩放图片，使图片的长边能完全显示出来。也就是说，可以完整地将图片显示出来。</li>
<li>aspectFill：缩放模式，保持纵横比缩放图片，只保证图片的短边能完全显示出来。也就是说，图片通常只在水平或垂直方向是完整的，另一个方向将会发生截取。</li>
</ul>
</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190520/XC3RPCh4fJdY.png?imageslim" alt="mark"></p>
<h3 id="swiper"><a class="markdownIt-Anchor" href="#swiper">#</a> swiper</h3>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/swiper.html">看开发者文档</a></p>
<p>轮播组件：调用相应的标签及参数设置</p>
</blockquote>
<p><img src="http://static.zxinc520.com/blog/20190520/PgOdEdCQrqvp.gif" alt="mark"></p>
<h2 id="解读-appjson"><a class="markdownIt-Anchor" href="#解读-appjson">#</a> 解读 app.json</h2>
<blockquote>
<p>小程序根目录下的  <code>app.json</code>  文件用来对微信小程序进行全局配置。文件内容为一个 JSON 对象，有以下属性：</p>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html">可以参考官网</a></p>
</blockquote>
<h3 id="pages"><a class="markdownIt-Anchor" href="#pages">#</a> pages</h3>
<blockquote>
<p>用于指定小程序由哪些页面组成，每一项都对应一个页面的 路径（含文件名） 信息。文件名不需要写文件后缀，框架会自动去寻找对于位置的  <code>.json</code> ,  <code>.js</code> ,  <code>.wxml</code> ,  <code>.wxss</code>  四个文件进行处理。</p>
</blockquote>
<h3 id="window"><a class="markdownIt-Anchor" href="#window">#</a> window</h3>
<blockquote>
<p>用于设置小程序的状态栏、导航条、标题、窗口背景色。</p>
</blockquote>
<p>例如：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token punctuation">&#123;</span>
  <span class="token string">"window"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"navigationBarBackgroundColor"</span><span class="token operator">:</span> <span class="token string">"#ffffff"</span><span class="token punctuation">,</span>
    <span class="token string">"navigationBarTextStyle"</span><span class="token operator">:</span> <span class="token string">"black"</span><span class="token punctuation">,</span>
    <span class="token string">"navigationBarTitleText"</span><span class="token operator">:</span> <span class="token string">"微信接口功能演示"</span><span class="token punctuation">,</span>
    <span class="token string">"backgroundColor"</span><span class="token operator">:</span> <span class="token string">"#eeeeee"</span><span class="token punctuation">,</span>
    <span class="token string">"backgroundTextStyle"</span><span class="token operator">:</span> <span class="token string">"light"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="tabbar"><a class="markdownIt-Anchor" href="#tabbar">#</a> tabBar</h3>
<blockquote>
<p>如果小程序是一个多 tab 应用（客户端窗口的底部或顶部有 tab 栏可以切换页面），可以通过 tabBar 配置项指定 tab 栏的表现，以及 tab 切换时显示的对应页面。</p>
</blockquote>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token string">"tabBar"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
   <span class="token string">"color"</span><span class="token operator">:</span> <span class="token string">"#333"</span><span class="token punctuation">,</span>
   <span class="token string">"selectedColor"</span><span class="token operator">:</span> <span class="token string">"#f30"</span><span class="token punctuation">,</span>
   <span class="token string">"list"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>
     <span class="token string">"pagePath"</span><span class="token operator">:</span> <span class="token string">"pages/index/index"</span><span class="token punctuation">,</span>
     <span class="token string">"text"</span><span class="token operator">:</span> <span class="token string">"首页"</span><span class="token punctuation">,</span>
     <span class="token string">"iconPath"</span><span class="token operator">:</span> <span class="token string">"assets/tabs/icon1.png"</span><span class="token punctuation">,</span>
     <span class="token string">"selectedIconPath"</span><span class="token operator">:</span> <span class="token string">"assets/tabs/icon1.png"</span>
   <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
   <span class="token punctuation">&#123;</span>
     <span class="token string">"pagePath"</span><span class="token operator">:</span> <span class="token string">"pages/message/message"</span><span class="token punctuation">,</span>
     <span class="token string">"text"</span><span class="token operator">:</span> <span class="token string">"消息"</span><span class="token punctuation">,</span>
     <span class="token string">"iconPath"</span><span class="token operator">:</span> <span class="token string">"assets/tabs/icon1.png"</span><span class="token punctuation">,</span>
     <span class="token string">"selectedIconPath"</span><span class="token operator">:</span> <span class="token string">"assets/tabs/icon1.png"</span>
   <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
   <span class="token punctuation">&#123;</span>
     <span class="token string">"pagePath"</span><span class="token operator">:</span> <span class="token string">"pages/index/index"</span><span class="token punctuation">,</span>
     <span class="token string">"text"</span><span class="token operator">:</span> <span class="token string">"个人中心"</span><span class="token punctuation">,</span>
     <span class="token string">"iconPath"</span><span class="token operator">:</span> <span class="token string">"assets/tabs/icon1.png"</span><span class="token punctuation">,</span>
     <span class="token string">"selectedIconPath"</span><span class="token operator">:</span> <span class="token string">"assets/tabs/icon1.png"</span>
   <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
   <span class="token punctuation">&#123;</span>
     <span class="token string">"pagePath"</span><span class="token operator">:</span> <span class="token string">"pages/index/index"</span><span class="token punctuation">,</span>
     <span class="token string">"text"</span><span class="token operator">:</span> <span class="token string">"综合"</span><span class="token punctuation">,</span>
     <span class="token string">"iconPath"</span><span class="token operator">:</span> <span class="token string">"assets/tabs/icon1.png"</span><span class="token punctuation">,</span>
     <span class="token string">"selectedIconPath"</span><span class="token operator">:</span> <span class="token string">"assets/tabs/icon1.png"</span>
   <span class="token punctuation">&#125;</span><span class="token punctuation">]</span>
 <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="http://static.zxinc520.com/blog/20190521/OCDT2PNCaB4Y.png?imageslim" alt="mark"></p>
<p><em>等等等… 不了解就看文档！</em></p>
<p><strong>注意： 所以看开发者文档很重要！</strong></p>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html">点一下就可以看了，别懒！</a></p>
<h2 id="appjs-全局生命周期函数"><a class="markdownIt-Anchor" href="#appjs-全局生命周期函数">#</a> app.js 全局生命周期函数</h2>
<blockquote>
<p>app.js 全局生命周期函数</p>
</blockquote>
<p><em>在 app.js 文件中</em> ， 定义了一些生命周期方法 ， onLaunch，onShow，onHide，onError，以及任意开发者添加的函数或者数据（通过 this 可以访问）</p>
<p><strong>以下是各个生命周期方法作用和描述：</strong></p>
<ol>
<li><strong>onLaunch 生命周期函数</strong> -- 监听小程序初始化 当小程序初始化完成时，会触发 onLaunch（全局只触发一次）</li>
<li><strong>onShow 生命周期函数</strong>–监听小程序显示 当小程序启动，或从后台进入前台显示，会触发 onShow</li>
<li><strong>onHide 生命周期函数</strong>–监听小程序隐藏 当小程序从前台进入后台，会触发 onHide</li>
<li><strong>onError 错误监听函数</strong> 当小程序发生脚本错误，或者 api 调用失败时，会触发 onError 并带上错误信息</li>
</ol>
<p>其他 Any 开发者可以添加任意的函数或数据到 Object 参数中，用 this 可以访问</p>
<p><em>index.js:</em> （个人感觉 和 <strong>Vue</strong> 真的好像，如果熟悉 Vue 的话，这理解起来应该没有难度。）</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//index.js</span>
<span class="token comment">//获取应用实例</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    motto<span class="token operator">:</span> <span class="token string">"Hello World"</span><span class="token punctuation">,</span>
    listarr<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token comment">//监听小程序初始化 当小程序初始化完成时，会触发 onLaunch（全局只触发一次）</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">option</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      url<span class="token operator">:</span> <span class="token string">"https://www.baifubao.com/callback"</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
          listarr<span class="token operator">:</span> res<span class="token punctuation">.</span>statusCode<span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>注意：着重关注 onLoad 函数，因为使用最频繁！</strong></p>
<h2 id="wxml-数据绑定"><a class="markdownIt-Anchor" href="#wxml-数据绑定">#</a> WXML 数据绑定</h2>
<blockquote>
<p>WXML 中的动态数据均来自对应 Page 的 data。</p>
</blockquote>
<h3 id="内容"><a class="markdownIt-Anchor" href="#内容">#</a> 内容</h3>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span>&#123;&#123; message &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    message<span class="token operator">:</span> <span class="token string">"Hello World!"</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="http://static.zxinc520.com/blog/20190526/Dr9a1AITnQo7.png?imageslim" alt="mark"></p>
<h4 id="特别注意"><a class="markdownIt-Anchor" href="#特别注意">#</a> 特别注意：</h4>
<ol>
<li>花括号和引号之间不能有空格</li>
<li>不能直接写 checked=“false”，其计算结果是一个字符串，转成 boolean 类型后转为真值。</li>
</ol>
<h2 id="通过-wxrequest-请求数据"><a class="markdownIt-Anchor" href="#通过-wxrequest-请求数据">#</a> 通过 wx.request 请求数据</h2>
<blockquote>
<p>通过 wx.request 请求数据</p>
</blockquote>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  url<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
  data<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
  header<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  method<span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>
  dataType<span class="token operator">:</span> <span class="token string">"json"</span><span class="token punctuation">,</span>
  responseType<span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">complete</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="http://static.zxinc520.com/blog/20190527/x00Ledvp9GT7.png?imageslim" alt="mark"></p>
<p><strong>setData</strong>：接受 <u>wx.request</u> 请求的数据，赋值给 Page 里面的 data（然后通过插值表达式渲染到页面）</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//index.js</span>
<span class="token comment">//获取应用实例</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    motto<span class="token operator">:</span> <span class="token string">"Hello World"</span><span class="token punctuation">,</span>
    listarr<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">option</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      url<span class="token operator">:</span> <span class="token string">"https://www.baifubao.com/callback"</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
          listarr<span class="token operator">:</span> res<span class="token punctuation">.</span>statusCode<span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="微信小程序里列表渲染"><a class="markdownIt-Anchor" href="#微信小程序里列表渲染">#</a> 微信小程序里列表渲染</h2>
<blockquote>
<h3 id="wxfor"><a class="markdownIt-Anchor" href="#wxfor">#</a> wx:for</h3>
<p>在组件上使用  <code>wx:for</code>  控制属性绑定一个数组，即可使用数组中各项的数据重复渲染该组件。</p>
<p>默认数组的当前项的下标变量名默认为  <code>index</code> ，数组当前项的变量名默认为  <code>item</code></p>
</blockquote>
<p><em>类比于 Vue：</em></p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>example-1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item in items<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>&#123;&#123; item.message &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><em>微信小程序里面：</em></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>view wx<span class="token operator">:</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"&#123;&#123;array&#125;&#125;"</span><span class="token operator">></span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>index<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>item<span class="token punctuation">.</span>message<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    array<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        message<span class="token operator">:</span> <span class="token string">"foo"</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        message<span class="token operator">:</span> <span class="token string">"bar"</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="wxkey"><a class="markdownIt-Anchor" href="#wxkey">#</a> wx:key</h4>
<p>​ <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/list.html">可以参考</a></p>
<p>如果列表中项目的位置会动态改变或者有新的项目添加到列表中，并且希望列表中的项目保持自己的特征和状态（如 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/switch.html"> <code>](https://developers.weixin.qq.com/miniprogram/dev/component/input.html) 中的输入内容，[</code> </a>的选中状态），需要使用  <code>wx:key</code>  来指定列表中项目的唯一的标识符。</p>
<ol>
<li>字符串，代表在 for 循环的 array 中 item 的某个 property，该 property 的值需要是列表中唯一的字符串或数字，且不能动态改变。</li>
<li>保留关键字  <code>*this</code>  代表在 for 循环中的 item 本身，这种表示需要 item 本身是一个唯一的字符串或者数字，如：</li>
</ol>
<p>当数据改变触发渲染层重新渲染的时候，会校正带有 key 的组件，框架会确保他们被重新排序，而不是重新创建，以确保使组件保持自身的状态，并且提高列表渲染时的效率。</p>
<p><strong>如不提供 wx:key，会报一个 warning， 如果明确知道该列表是静态，或者不必关注其顺序，可以选择忽略。</strong></p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>switch</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;&#123;objectArray&#125;&#125;<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>unique<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  &#123;&#123;item.id&#125;&#125;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>switch</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>switch<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Switch<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addToFront<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Add to the front<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>switch</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;&#123;numberArray&#125;&#125;<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>*this<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  &#123;&#123;item&#125;&#125;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>switch</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addNumberToFront<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Add to the front<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    objectArray<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> unique<span class="token operator">:</span> <span class="token string">"unique_5"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> unique<span class="token operator">:</span> <span class="token string">"unique_4"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> unique<span class="token operator">:</span> <span class="token string">"unique_3"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> unique<span class="token operator">:</span> <span class="token string">"unique_2"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> unique<span class="token operator">:</span> <span class="token string">"unique_1"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> unique<span class="token operator">:</span> <span class="token string">"unique_0"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    numberArray<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="页面相关事件处理函数"><a class="markdownIt-Anchor" href="#页面相关事件处理函数">#</a> 页面相关事件处理函数</h2>
<blockquote>
<p>页面相关事件处理函数（<strong>下拉刷新</strong>，<strong>滑到底部加载更多</strong>等）</p>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/pull-down-refresh/wx.startPullDownRefresh.html">可以参考</a></p>
</blockquote>
<p><strong>下拉事件和触底事件</strong>：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//页面相关事件处理函数---监听用户下拉动作</span>
   <span class="token function-variable function">onPullDownRefresh</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'下拉！'</span><span class="token punctuation">)</span>
   <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
   <span class="token comment">//页面上拉触底事件的处理函数</span>
   <span class="token function-variable function">onReachBottom</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'上拉'</span><span class="token punctuation">)</span>
   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="导航栏"><a class="markdownIt-Anchor" href="#导航栏">#</a> 导航栏</h2>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/navigation-bar/wx.showNavigationBarLoading.html">可以参考官方文档</a></p>
<p>js 文件</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center">函数 API</th>
<th style="text-align:center">功能</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">wx.showNavigationBarLoading(Object object)</td>
<td style="text-align:center">在当前页面显示导航条加载动画</td>
</tr>
<tr>
<td style="text-align:center">wx.setNavigationBarTitle(Object object)</td>
<td style="text-align:center">动态设置当前页面的标题</td>
</tr>
<tr>
<td style="text-align:center">wx.setNavigationBarColor(Object object)</td>
<td style="text-align:center">设置页面导航条颜色</td>
</tr>
<tr>
<td style="text-align:center">wx.hideNavigationBarLoading(Object object)</td>
<td style="text-align:center">在当前页面隐藏导航条加载动画</td>
</tr>
</tbody>
</table>
<p><img src="http://static.zxinc520.com/blog/20190603/DXIDRjESGUHv.gif" alt="mark"></p>
<h2 id="界面交互"><a class="markdownIt-Anchor" href="#界面交互">#</a> 界面交互</h2>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/interaction/wx.showToast.html">参考官方文档</a></p>
</blockquote>
<h4 id="示例代码"><a class="markdownIt-Anchor" href="#示例代码">#</a> 示例代码</h4>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  title<span class="token operator">:</span> <span class="token string">"成功w"</span><span class="token punctuation">,</span>
  icon<span class="token operator">:</span> <span class="token string">"success"</span><span class="token punctuation">,</span>
  duration<span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="http://static.zxinc520.com/blog/20190603/fRajsw7UWlQc.gif" alt="mark"></p>
<h2 id="下拉刷新"><a class="markdownIt-Anchor" href="#下拉刷新">#</a> 下拉刷新</h2>
<blockquote>
<p>下拉刷新 ( <strong>配合</strong> 页面<em>相关事件处理函数</em> — 监听用户下拉动作)</p>
</blockquote>
<p><strong>index.json:</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token punctuation">&#123;</span>
  <span class="token string">"enablePullDownRefresh"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"backgroundTextStyle"</span><span class="token operator">:</span> <span class="token string">"dark"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>index.js:</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//页面相关事件处理函数---监听用户下拉动作</span>
 <span class="token function-variable function">onPullDownRefresh</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'下拉！'</span><span class="token punctuation">)</span>
 <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="http://static.zxinc520.com/blog/20190603/bHEJTM3fLLsC.gif" alt="mark"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" rel="tag">微信小程序</a></li></ul>

    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-WeChatUp02"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/09/05/WeChatUp02/"
    >微信小程序笔记下</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2019/09/05/WeChatUp02/" class="article-date">
  <time datetime="2019-09-05T09:07:39.000Z" itemprop="datePublished">2019-09-05</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/">微信小程序</a> / <a class="article-category-link" href="/categories/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%B8%8B%E7%AF%87/">微信小程序下篇</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="微信小程序笔记下"><a class="markdownIt-Anchor" href="#微信小程序笔记下">#</a> 微信小程序笔记下</h1>
<blockquote>
<p>微信小程序笔记下</p>
<p>input</p>
<p>color 属性</p>
<p>bindchange</p>
<p>wxs 页面脚本</p>
<p>微信小程序事件 <strong>冒泡 ** 和 事件</strong>传参 **</p>
<p>服务号、订阅号</p>
<p>sdk</p>
</blockquote>
<h2 id="微信小程序组件"><a class="markdownIt-Anchor" href="#微信小程序组件">#</a> 微信小程序组件</h2>
<h3 id="表单组件"><a class="markdownIt-Anchor" href="#表单组件">#</a> 表单组件</h3>
<h4 id="input"><a class="markdownIt-Anchor" href="#input">#</a> input</h4>
<blockquote>
<p>输入框。该组件是<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/native-component.html">原生组件</a>，使用时请注意相关限制</p>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/input.html">可以参考</a></p>
</blockquote>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- 输入框 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>text<span class="token punctuation">'</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>text<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>input</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>password<span class="token punctuation">'</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>password<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>input</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>number<span class="token punctuation">'</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>number<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>input</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>idcard<span class="token punctuation">'</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>idcard<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>input</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>digit<span class="token punctuation">'</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>digit<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>input</span><span class="token punctuation">></span></span>

  <span class="token comment">&lt;!-- 单选框 --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radio-group</span><span class="token punctuation">></span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radio</span><span class="token punctuation">></span></span>单选框<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radio</span><span class="token punctuation">></span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radio</span><span class="token punctuation">></span></span>单选框<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radio</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radio-group</span><span class="token punctuation">></span></span>

  <span class="token comment">&lt;!-- 多选框 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>checkbox-group</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>checkbox</span><span class="token punctuation">></span></span>多选框<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>checkbox</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>checkbox</span><span class="token punctuation">></span></span>多选框<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>checkbox</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>checkbox</span><span class="token punctuation">></span></span>多选框<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>checkbox</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>checkbox-group</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="http://static.zxinc520.com/blog/20190605/iBUB5P8LKOTz.png?imageslim" alt="mark"></p>
<h3 id="改变颜色"><a class="markdownIt-Anchor" href="#改变颜色">#</a> 改变颜色</h3>
<blockquote>
<p><strong>color 属性</strong></p>
</blockquote>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- 单选框 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radio-group</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radio</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#f30<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>单选框<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radio</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radio</span><span class="token punctuation">></span></span>单选框<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radio</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radio-group</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!-- 多选框 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>checkbox-group</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>checkbox</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#f30<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>多选框<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>checkbox</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>checkbox</span><span class="token punctuation">></span></span>多选框<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>checkbox</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>checkbox</span><span class="token punctuation">></span></span>多选框<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>checkbox</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>checkbox-group</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="http://static.zxinc520.com/blog/20190605/0lbNety1l8Nr.gif" alt="mark"></p>
<ul>
<li>checked：默认选中</li>
<li>disabled: 禁用</li>
</ul>
<h3 id="bindchange"><a class="markdownIt-Anchor" href="#bindchange">#</a> bindchange</h3>
<blockquote>
<p value:[选中的="" checkbox="" 的="" value="" 的数组]=""><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/checkbox-group.html">checkbox-group</a> 中选中项发生改变时触发 change 事件，detail =</p>
<p><strong>单选框</strong> 和 <strong>复选框</strong> 都能用！</p>
</blockquote>
<p><strong>例如：</strong></p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!-- 单选框 --></span>
&lt;radio-group ="radiobindchangefun" data-index="1">
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radio</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#f30<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nan<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>单选框<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radio</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radio</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nv<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>单选框<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radio</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radio-group</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>index.js：</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">radiobindchangefun</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="http://static.zxinc520.com/blog/20190605/HhwLwtgLFk7s.gif" alt="mark"></p>
<h2 id="wxs-页面脚本"><a class="markdownIt-Anchor" href="#wxs-页面脚本">#</a> wxs 页面脚本</h2>
<blockquote>
<p>WXS（WeiXin Script）是小程序的一套脚本语言，结合  <code>WXML</code> ，可以构建出页面的结构。</p>
<p>WXS 与 JavaScript 是不同的语言，有自己的语法，并不和 JavaScript 一致。</p>
<p><strong>用的相对不多</strong></p>
</blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxs/01wxs-module.html">WXS 模块</a></li>
<li><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxs/02variate.html">变量</a></li>
<li><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxs/03annotation.html">注释</a></li>
<li><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxs/04operator.html">运算符</a></li>
<li><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxs/05statement.html">语句</a></li>
<li><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxs/06datatype.html">数据类型</a></li>
<li><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxs/07basiclibrary.html">基础类库</a></li>
</ul>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>wxs</span> <span class="token attr-name">module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>foo<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  var sum=function(a,b)&#123; return a+b; &#125; module.exports.sum=sum
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>wxs</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span>&#123;&#123;foo.sum(1,2)&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="http://static.zxinc520.com/blog/20190605/sEHFhCJgcSTT.png?imageslim" alt="mark"></p>
<h2 id="微信小程序事件冒泡和事件传参"><a class="markdownIt-Anchor" href="#微信小程序事件冒泡和事件传参">#</a> 微信小程序事件冒泡和事件传参</h2>
<blockquote>
<p>微信小程序事件冒泡和事件传参</p>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html">参考</a></p>
</blockquote>
<h3 id="事件绑定和冒泡"><a class="markdownIt-Anchor" href="#事件绑定和冒泡">#</a> 事件绑定和冒泡</h3>
<p>事件绑定的写法同组件的属性，以 key、value 的形式。</p>
<ul>
<li>key 以 <code>bind</code>  或 <code>catch</code>  开头，然后跟上事件的类型，如 <code>bindtap</code> 、 <code>catchtouchstart</code> 。自基础库版本 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">1.5.0</a> 起，在非<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/native-component.html">原生组件</a>中， <code>bind</code>  和 <code>catch</code>  后可以紧跟一个冒号，其含义不变，如 <code>bind:tap</code> 、 <code>catch:touchstart</code> 。</li>
<li>value 是一个字符串，需要在对应的 Page 中定义同名的函数。不然当触发事件的时候会报错。</li>
</ul>
<p><code>bind</code>  事件绑定<strong>不会阻止</strong>冒泡事件向上冒泡， <code>catch</code>  事件绑定<strong>可以阻止</strong>冒泡事件向上冒泡。</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>father<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ClickFatherEvent<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>son<span class="token punctuation">"</span></span> <span class="token attr-name">catchtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ClickSonEvent<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="http://static.zxinc520.com/blog/20190610/iYPyQKFs0uUh.gif" alt="mark"></p>
<h3 id="事件传参"><a class="markdownIt-Anchor" href="#事件传参">#</a> 事件传参</h3>
<blockquote>
<p>自定义属性传参 ( <strong>data-index=“1”</strong> )</p>
</blockquote>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>father<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ClickFatherEvent<span class="token punctuation">"</span></span> <span class="token attr-name">data-index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>son<span class="token punctuation">"</span></span> <span class="token attr-name">catchtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ClickSonEvent<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">ClickFatherEvent</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'father'</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>index<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="http://static.zxinc520.com/blog/20190611/QGePjx2yA28Q.gif" alt="mark"></p>
<h2 id="服务号"><a class="markdownIt-Anchor" href="#服务号">#</a> 服务号</h2>
<blockquote>
<p>服务号：为企业和组织提供更强大的业务服务与用户管理能力，主要偏向服务类交互（功能类似 12315，114，银行，提供绑定信息，服务交互的）；</p>
<p>适用人群：媒体、企业、政府或其他组织。</p>
<p>群发次数：服务号 1 个月（按自然月）内可发送 4 条群发消息。</p>
<p><a target="_blank" rel="noopener" href="https://kf.qq.com/faq/120911VrYVrA150918fMZ77R.html?scene_id=kf3386">可以参考</a></p>
</blockquote>
<h2 id="订阅号"><a class="markdownIt-Anchor" href="#订阅号">#</a> 订阅号</h2>
<blockquote>
<h1 id="什么是订阅号"><a class="markdownIt-Anchor" href="#什么是订阅号">#</a> 什么是订阅号？</h1>
<p>订阅号：为媒体和个人提供一种新的信息传播方式，主要功能是在微信侧给用户传达资讯；（功能类似报纸杂志，提供新闻信息或娱乐趣事）</p>
<p>适用人群：个人、媒体、企业、政府或其他组织。</p>
<p>群发次数：订阅号（认证用户、非认证用户）1 天内可群发 1 条消息。</p>
</blockquote>
<p><strong>温馨提示：</strong></p>
<ol>
<li>如果想用公众平台简单发发消息，做宣传推广服务，建议可选择订阅号；</li>
<li>如果想用公众平台进行商品销售，建议可选择服务号，后续可认证再申请微信支付商户；</li>
</ol>
<h2 id="sdk"><a class="markdownIt-Anchor" href="#sdk">#</a> sdk</h2>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E5%8C%85">软件开发工具包</a>（缩写：<strong>SDK</strong>、外语全称：**Software Development Kit）** 一般都是一些<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B%E5%B8%88/836275">软件工程师</a>为特定的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%BD%AF%E4%BB%B6%E5%8C%85/10508451">软件包</a>、<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%BD%AF%E4%BB%B6%E6%A1%86%E6%9E%B6/1471931">软件框架</a>、<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%A1%AC%E4%BB%B6/479446">硬件</a>平台、<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/192">操作系统</a>等建立应用软件时的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/10464557">开发工具</a>的集合。 [1]</p>
<p>软件开发工具包括广义上指<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%BE%85%E5%8A%A9/1045139">辅助</a>开发某一类软件的相关文档、范例和工具的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%9B%86%E5%90%88/73081">集合</a>。</p>
<p>软件开发工具包是一些被软件工程师用于为特定的软件包、软件框架、硬件平台、操作系统等创建应用软件的开发工具的集合，一般而言 SDK 即开发 <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Windows">Windows</a> 平台下的应用程序所使用的 SDK。它可以简单的为某个<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E8%AF%AD%E8%A8%80/2317999">程序设计语言</a>提供<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%8F%A3/10418844">应用程序接口</a> <strong>API</strong> 的一些文件，但也可能包括能与某种<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%B5%8C%E5%85%A5%E5%BC%8F%E7%B3%BB%E7%BB%9F/186978">嵌入式系统</a>通讯的复杂的硬件。一般的工具包括用于调试和其他用途的实用工具。SDK 还经常包括示例代码、支持性的技术注解或者其他的为基本参考资料澄清疑点的支持文档。</p>
<p>为了鼓励开发者使用其系统或者语言，许多 SDK 是<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%85%8D%E8%B4%B9/131326">免费</a>提供的。<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B%E5%B8%88/836275">软件工程师</a>通常从目标系统开发者那里获得软件开发包，也可以直接从互联网下载，有时也被作为<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%90%A5%E9%94%80%E6%89%8B%E6%AE%B5">营销手段</a>。例如，营销公司会免费提供构建 SDK 以鼓励人们使用它，从而会吸引更多人由于能免费为其编程而购买其构件。</p>
<p>SDK 可能附带了使其不能在不兼容的许可证下开发软件的许可证。例如产品供应商提供一个专有的 SDK 可能与自由软件开发抵触。<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/GPL">GPL</a> 能使 SDK 与专有软件开发近乎不兼容。<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/LGPL">LGPL</a> 下的 SDK 则没有这个问题。</p>
<p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/SDK/7815680">可参考官方解释</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421141115">微信 JS-SDK 说明文档</a></p>
</blockquote>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" rel="tag">微信小程序</a></li></ul>

    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-hybrid"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/08/29/hybrid/"
    >hybrid</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2019/08/29/hybrid/" class="article-date">
  <time datetime="2019-08-29T07:53:28.000Z" itemprop="datePublished">2019-08-29</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%B7%B7%E5%90%88APP/">混合APP</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="hybrid"><a class="markdownIt-Anchor" href="#hybrid">#</a> hybrid</h1>
<blockquote>
<p>本章主要介绍 hybrid 的原理和应用。hybrid 基础部分要讲解 file 协议、webview、更新上线流程；另外，通过 h5 和 hybrid 的对比，来了解两者的异同和使用场景；最后讲解前端 JS 和客户端的通讯，包括通讯原理和 JS-bridge 的代码封装。…</p>
<p>社会主流 <strong>大前端</strong> 的概念。</p>
<p><strong>知识点</strong></p>
<p>6-1 hybrid 是什么？ 为何用 hybrid ？</p>
<p>6-2 hybrid 更新上线流程</p>
<p>6-3 hybrid 和 h5 的 主要区别？</p>
<p>6-4 前端 JS 和 客户端 如何通讯？</p>
<p>The greatest test of courage on earth is to bear defeat without losing heart.</p>
<p>世界上对勇气的最大考验是忍受失败而不丧失信心。</p>
</blockquote>
<h3 id="hybrid-2"><a class="markdownIt-Anchor" href="#hybrid-2">#</a> hybrid</h3>
<ul>
<li>移动端占大部分流量，已经远远超过 PC</li>
<li>一线互联网公司都有自己的 App</li>
<li>这些 App 中有很大比例的前端代码 (不要惊讶)</li>
<li>拿微信举例，你每天浏览微信的内容，多少是前端？</li>
</ul>
<h3 id="知识点"><a class="markdownIt-Anchor" href="#知识点">#</a> 知识点</h3>
<ul>
<li>hybrid 是什么？ 为何用 hybrid ？</li>
<li>介绍一下 hybrid 更新 和上线的流程？</li>
<li>hybrid 和 h5 的 主要区别？</li>
<li>前端 JS 和 客户端 如何通讯？</li>
</ul>
<h2 id="6-1-hybrid-是什么-为何用-hybrid"><a class="markdownIt-Anchor" href="#6-1-hybrid-是什么-为何用-hybrid">#</a> 6-1 hybrid 是什么？ 为何用 hybrid ？</h2>
<h3 id="知识点-2"><a class="markdownIt-Anchor" href="#知识点-2">#</a> 知识点</h3>
<ul>
<li>hybrid 文字解释</li>
<li>存在价值，为何用 hybrid ？</li>
<li>webview</li>
<li>file：// 协议</li>
<li>hybrid 实现流程</li>
</ul>
<h4 id="hybrid-文字解释"><a class="markdownIt-Anchor" href="#hybrid-文字解释">#</a> hybrid 文字解释</h4>
<ul>
<li>hybrid 即 “混合” ，即 前端 和客户端的混合开发</li>
<li>需前端开发人员 和 客户端开发人员配合完成</li>
<li>某些环节也可能涉及到 server 端</li>
<li>注意：不要以为自己是前端就可以不理会客户端的知识</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190829/no77eoeMXoEi.png?imageslim" alt="mark"></p>
<h4 id="hybrid-存在价值"><a class="markdownIt-Anchor" href="#hybrid-存在价值">#</a> hybrid 存在价值</h4>
<ul>
<li>可以快速迭代更新【关键】（无需 app 审核，思考为何？–&gt; 前端部分能够快速更新上线）</li>
<li>体验流畅 （ 和 NA 的体验基本类似 ）</li>
<li>减少开发和沟通成本，双端公用一套代码</li>
</ul>
<h4 id="webview"><a class="markdownIt-Anchor" href="#webview">#</a> webview</h4>
<ul>
<li>是 App 中的一个组件（app 可以有 webview，也可以没有）</li>
<li>用于加载 h5 页面，即一个小型的浏览器 内核</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190829/I797MG2jf2xe.png?imageslim" alt="mark"></p>
<h4 id="file-协议"><a class="markdownIt-Anchor" href="#file-协议">#</a> file 协议</h4>
<ul>
<li>其实在一开始接触 html 开发，就已经使用了 file 协议</li>
<li>只不过你当时没有 “协议” “标准” 等这些概念</li>
<li>再次强调 “协议” “标准” 的重要性 ！！！</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190829/kyXpWyLb4oVR.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190829/cxJ86AeO2374.png?imageslim" alt="mark"></p>
<p><em>两者的区别：</em></p>
<ul>
<li>file 协议：本地文件，快</li>
<li>http (s) 协议：网络加载，慢</li>
</ul>
<h4 id="hybrid-具体实现"><a class="markdownIt-Anchor" href="#hybrid-具体实现">#</a> hybrid 具体实现</h4>
<ul>
<li>不是所有的场景都适合使用 hybrid</li>
<li>使用 <strong>NA</strong> ：体验要求极致，变化不频繁（ 如头条的首页 ）</li>
<li>使用 <strong>hybrid</strong> ：体验要求高，变化频繁（ 如头条的新闻详情页 ）</li>
<li>使用 <strong>h5</strong> ：体验无要求，不常用（如举报、反馈等页面）</li>
</ul>
<p><strong>具体实现</strong>：</p>
<ul>
<li>前端 做好静态页面（html css js），将文件交给客户端</li>
<li>客户端拿到前端静态页面，以文件形式储存在 app 中</li>
<li>客户端 在一个 webview 中</li>
<li>使用 file 协议 加载静态页面</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190829/RIR0zOPUN22I.png?imageslim" alt="mark"></p>
<h4 id="具体实现-遗留问题"><a class="markdownIt-Anchor" href="#具体实现-遗留问题">#</a> 具体实现 – 遗留问题：</h4>
<ul>
<li>app 发布之后，静态文件如何实时更新？</li>
<li>静态页面如何获取内容？</li>
</ul>
<h3 id="问题解答"><a class="markdownIt-Anchor" href="#问题解答">#</a> 问题解答</h3>
<ul>
<li>hybrid 是什么？ 为何用 hybrid ？
<ul>
<li>hybrid 即 “混合” ，即 前端 和客户端的混合开发</li>
<li>hybrid 存在的核心意义在于快速迭代，无需审核</li>
<li>hybrid 实现流程（图），以及 webview 和 file 协议</li>
</ul>
</li>
</ul>
<h2 id="6-2-hybrid-更新上线流程"><a class="markdownIt-Anchor" href="#6-2-hybrid-更新上线流程">#</a> 6-2 hybrid 更新上线流程</h2>
<ul>
<li>回顾 hybrid 实现流程</li>
<li>思考 （目的，实现途径）</li>
<li>更新流程</li>
</ul>
<h4 id="回顾-hybrid-实现流程"><a class="markdownIt-Anchor" href="#回顾-hybrid-实现流程">#</a> 回顾 hybrid 实现流程</h4>
<p><img src="http://static.zxinc520.com/blog/20190829/aeHMDopqsrCy.png?imageslim" alt="mark"></p>
<h4 id="思考-目的实现途径"><a class="markdownIt-Anchor" href="#思考-目的实现途径">#</a> 思考 （目的，实现途径）</h4>
<p><img src="http://static.zxinc520.com/blog/20190829/wCDenA4EGmC8.png?imageslim" alt="mark"></p>
<ul>
<li>要替换每个客户端的静态文件</li>
<li>只能客户端来做（客户端是我们开发的）</li>
<li>客户端去 server 下载最新的静态文件</li>
<li>我们维护 server 的静态文件</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190829/H6H3arUgJB6d.png?imageslim" alt="mark"></p>
<p><em>完整流程：</em></p>
<ul>
<li>分版本，有版本号，如 201803211015</li>
<li>将静态 文件压缩成 zip 包，上传到服务器</li>
<li>客户端每次启动，都去服务端检查版本号</li>
<li>如果服务端本版本号大于客户端版本号，就去下载最新的 zip 包</li>
<li>下载完之后解压包，然后将现有的文件覆盖</li>
</ul>
<h3 id="问题解答-2"><a class="markdownIt-Anchor" href="#问题解答-2">#</a> 问题解答</h3>
<ul>
<li>介绍一下 hybrid 更新 和上线的流程？
<ul>
<li>掌握流程图</li>
<li>要点 1：服务端的版本和 zip 包维护</li>
<li>要点 2：更新 zip 包之前，先对比版本号</li>
<li>要点 3：zip 下载解压和覆盖</li>
</ul>
</li>
</ul>
<h2 id="6-3hybrid-和-h5-的-主要区别"><a class="markdownIt-Anchor" href="#6-3hybrid-和-h5-的-主要区别">#</a> 6-3hybrid 和 h5 的 主要区别？</h2>
<h3 id="知识点-3"><a class="markdownIt-Anchor" href="#知识点-3">#</a> 知识点</h3>
<ul>
<li>优点</li>
<li>缺点</li>
<li>适用的场景</li>
</ul>
<h4 id="hybrid-优点"><a class="markdownIt-Anchor" href="#hybrid-优点">#</a> hybrid 优点</h4>
<ul>
<li>体验更好，跟 NA 体验基本一致</li>
<li>可快速迭代，无需 app 审核 【关键】</li>
</ul>
<h4 id="hybrid-缺点"><a class="markdownIt-Anchor" href="#hybrid-缺点">#</a> hybrid 缺点</h4>
<ul>
<li>开发成本高。联调，测试，查 bug 都比较麻烦</li>
<li>运维成本高。参考此前讲过的更新上线的流程</li>
</ul>
<h4 id="适用场景"><a class="markdownIt-Anchor" href="#适用场景">#</a> 适用场景</h4>
<ul>
<li>hybrid ：产品的稳定功能，体验要求高，迭代频繁</li>
<li>h5：单次的运营活动（如 xx 红包）或 不常用功能（反馈、举报页面等）</li>
</ul>
<h3 id="问题解答-3"><a class="markdownIt-Anchor" href="#问题解答-3">#</a> 问题解答</h3>
<ul>
<li>hybrid 和 h5 的 主要区别？
<ul>
<li>优点：体验好，可快速迭代</li>
<li>缺点：开发成本高，运维成本高</li>
<li>适用的场景：hybrid 适合产品型，h5 适合 运行型</li>
</ul>
</li>
</ul>
<h2 id="6-4-前端-js-和-客户端-如何通讯"><a class="markdownIt-Anchor" href="#6-4-前端-js-和-客户端-如何通讯">#</a> 6-4 前端 JS 和 客户端 如何通讯？</h2>
<h3 id="知识点-4"><a class="markdownIt-Anchor" href="#知识点-4">#</a> 知识点</h3>
<ul>
<li>回顾 之前遗留的问题</li>
<li>JS 和 客户端通讯的基本形式</li>
<li>schema 协议简介和使用</li>
<li>schema 使用的封装</li>
<li>内置上线</li>
</ul>
<h4 id="之前遗留的问题"><a class="markdownIt-Anchor" href="#之前遗留的问题">#</a> 之前遗留的问题</h4>
<ul>
<li>新闻详情页适用于 hybrid，前端如何 获取新闻内容 ？
<ul>
<li>不能用 ajax （http (s) 协议）获取。第一： 跨域 ，第二 ：速度慢</li>
<li>客户端获取新闻内容，然后 JS 通讯拿到内容，再渲染</li>
</ul>
</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190829/MIj2ETWq9QH1.png?imageslim" alt="mark"></p>
<p><em>JS 和 客户端通讯的基本形式</em> ：</p>
<ul>
<li>JS 访问客户端能力，传递参数 和 回调函数</li>
<li>客户端 通过 回调函数 返回内容</li>
</ul>
<h4 id="schema-协议简介和使用"><a class="markdownIt-Anchor" href="#schema-协议简介和使用">#</a> schema 协议简介和使用</h4>
<ul>
<li>之前介绍了 http (s) 和 file 协议</li>
<li>schema 协议 —— 前端和客户端通讯的约定</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190829/w3OphLjO8erc.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190829/QpzXgisk6E3y.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190829/RjgtefgjYzXH.png?imageslim" alt="mark"></p>
<h4 id="模拟扫一扫前后端通讯"><a class="markdownIt-Anchor" href="#模拟扫一扫前后端通讯">#</a> 模拟扫一扫前后端通讯</h4>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>扫一扫<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">function</span> <span class="token function">invokeScan</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        window<span class="token punctuation">[</span><span class="token string">"_invoke_scan_callback_"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
          <span class="token function">alert</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"iframe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        iframe<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>
        <span class="token comment">// iframe.src = 'weixin://dl/scan'  //重要</span>
        iframe<span class="token punctuation">.</span>src <span class="token operator">=</span>
          <span class="token string">"weixin://dl/scan?k1=v1&amp;k2=v2&amp;k3=v3&amp;callback=_invoke_scan_callback_"</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> body <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
        body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>iframe<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
          body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>iframe<span class="token punctuation">)</span><span class="token punctuation">;</span>
          iframe <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>

      document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"btn"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">invokeScan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="schema-使用的封装"><a class="markdownIt-Anchor" href="#schema-使用的封装">#</a> schema 使用的封装</h4>
<p><img src="http://static.zxinc520.com/blog/20190829/jcvC6T5SH3Pm.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190829/fW8NCvLoYRAg.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190829/5Yhq6r9uLr7X.png?imageslim" alt="mark"></p>
<h4 id="schema-封装代码"><a class="markdownIt-Anchor" href="#schema-封装代码">#</a> schema 封装代码</h4>
<p><em>schema 使用的封装</em> ：</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>扫一扫<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>分享<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>invoke.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
      <span class="token comment">//调用扫一扫</span>
      document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"btn1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        window<span class="token punctuation">.</span>invoke<span class="token punctuation">.</span><span class="token function">scan</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">//调用分享</span>
      document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"btn2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        window<span class="token punctuation">.</span>invoke<span class="token punctuation">.</span><span class="token function">share</span><span class="token punctuation">(</span>
          <span class="token punctuation">&#123;</span>
            title<span class="token operator">:</span> <span class="token string">"xxx"</span><span class="token punctuation">,</span>
            content<span class="token operator">:</span> <span class="token string">"yyy"</span><span class="token punctuation">,</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
          <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">relust</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>relust<span class="token punctuation">.</span>error <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
              <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"分享成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
              <span class="token function">alert</span><span class="token punctuation">(</span>relust<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><em>invoke.js</em> ：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// invoke.js</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">window<span class="token punctuation">,</span> <span class="token keyword">undefined</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">//调用 schema 的封装</span>
  <span class="token keyword">function</span> <span class="token function">_invoke</span><span class="token punctuation">(</span><span class="token parameter">action<span class="token punctuation">,</span> data<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//拼装 schema 协议</span>
    <span class="token keyword">var</span> schema <span class="token operator">=</span> <span class="token string">"myapp://utils/"</span> <span class="token operator">+</span> action<span class="token punctuation">;</span>

    <span class="token comment">//拼接参数</span>
    schema <span class="token operator">+=</span> <span class="token string">"?a=a"</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> key<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        schema <span class="token operator">+=</span> <span class="token string">"&amp;"</span> <span class="token operator">+</span> key <span class="token operator">+</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">//处理 callback</span>
    <span class="token keyword">var</span> callbackName <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> callback <span class="token operator">===</span> <span class="token string">"string"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      callbackName <span class="token operator">=</span> callback<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
      callbackName <span class="token operator">=</span> action <span class="token operator">+</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      window<span class="token punctuation">[</span>callbackName<span class="token punctuation">]</span> <span class="token operator">=</span> callback<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    schema <span class="token operator">+=</span> <span class="token string">"callback=callbackName"</span><span class="token punctuation">;</span>

    <span class="token comment">//触发</span>
    <span class="token keyword">var</span> iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"iframe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    iframe<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>
    iframe<span class="token punctuation">.</span>src <span class="token operator">=</span> schema<span class="token punctuation">;</span> <span class="token comment">//重要</span>
    <span class="token keyword">var</span> body <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
    body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>iframe<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>iframe<span class="token punctuation">)</span><span class="token punctuation">;</span>
      iframe <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">//暴露到全局变量</span>
  window<span class="token punctuation">.</span>invoke <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token function-variable function">share</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token function">_invoke</span><span class="token punctuation">(</span><span class="token string">"share"</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">scan</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token function">_invoke</span><span class="token punctuation">(</span><span class="token string">"scan"</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">login</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token function">_invoke</span><span class="token punctuation">(</span><span class="token string">"login"</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="问题解答-4"><a class="markdownIt-Anchor" href="#问题解答-4">#</a> 问题解答</h3>
<ul>
<li>前端 JS 和 客户端 如何通讯？
<ul>
<li>通讯的基本形式：调用能力，传递参数，监听回调</li>
<li>对 schema 协议的理解和使用 （这个协议可理解为 ：定义了前端和客户端 通信的一个标准）</li>
<li>调用 schema 代码的封装</li>
<li>内置上线的好处：更快、更安全</li>
</ul>
</li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hybrid/" rel="tag">hybrid</a></li></ul>

    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-asynchronization"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/08/14/asynchronization/"
    >异步</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2019/08/14/asynchronization/" class="article-date">
  <time datetime="2019-08-14T07:30:31.000Z" itemprop="datePublished">2019-08-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/JS/">JS</a> / <a class="article-category-link" href="/categories/JS/JS-%E4%B8%89%E5%BA%A7%E5%A4%A7%E5%B1%B1/">JS 三座大山</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="异步"><a class="markdownIt-Anchor" href="#异步">#</a> 异步</h1>
<blockquote>
<p>本章全面讲解了 JS 异步的知识点。先从<strong>原理开始</strong> ，讲解什么是 <strong>单线程</strong>、什么是 <strong>event loop</strong> ；然后讲解 jQuery 中解决 <strong>异步的 Deferred</strong> 以及 jQuery 初次展示出来的 <strong>Promise 的用法</strong>；最后再讲解 ES6 中 <strong>Promise 的用法和标准</strong> 。</p>
<p><strong>基础篇请看</strong> ：<a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225d2eeda9d797f0309cf6ab02%22">异步和单线程</a></p>
</blockquote>
<h2 id="异步-2"><a class="markdownIt-Anchor" href="#异步-2">#</a> 异步</h2>
<blockquote>
<p>高级面试</p>
</blockquote>
<ul>
<li>《<a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225d2eeda9d797f0309cf6ab02%22">前端 JS 面试技巧</a>》讲到异步的基础</li>
<li>高级面试会问到更多的内容</li>
<li>如 event-loop Promise Async/Await 等</li>
</ul>
<h3 id="问题"><a class="markdownIt-Anchor" href="#问题">#</a> 问题</h3>
<ul>
<li>什么是单线程，和异步有什么关系？ <a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225d2eeda9d797f0309cf6ab02%22">参考 </a></li>
<li>什么是 event-loop？</li>
<li>是否用过 jQuery 的 Deferred</li>
<li>Promise 的基本使用和原理</li>
<li>介绍一下 async/await（ES7）（和 Promise 的区别、联系）</li>
<li>总结一下当前 JS 解决异步的方案</li>
</ul>
<h2 id="4-1-单线程和异步"><a class="markdownIt-Anchor" href="#4-1-单线程和异步">#</a> 4-1 单线程和异步</h2>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225d2eeda9d797f0309cf6ab02%22">单线程和异步基础篇 </a></p>
</blockquote>
<ul>
<li>为什么是单线程？
<ul>
<li>原因 - 避免 DOM 渲染冲突
<ul>
<li>浏览器需要渲染 DOM</li>
<li>JS 可以修改 DOM 结构</li>
<li>JS 执行的时候，浏览器 DOM 渲染会暂停</li>
<li>两段 JS 也不能同时执行 （ 都修改 DOM 就冲突了）</li>
<li>webworker 支持多线程 ，但是不能 访问 DOM</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>单线程的解决方案</strong> ： <strong>异步</strong></p>
<p><em>暴露出的问题</em> ：</p>
<ul>
<li>问题一：没按照书写方式执行，可读性差</li>
<li>问题二：callback 中不容易模块化</li>
</ul>
<h3 id="问题解答"><a class="markdownIt-Anchor" href="#问题解答">#</a> 问题解答</h3>
<ul>
<li>什么是单线程，和异步有什么关系？
<ul>
<li>单线程就是同时只做一件事，两段 JS 不能同时 执行</li>
<li>原因就是 为了避免 DOM 渲染的冲突</li>
<li>异步是一种 “无奈” 的解决方案，虽然有很多问题</li>
</ul>
</li>
</ul>
<p><strong>承上启下：</strong></p>
<ul>
<li>单线程 - 同时间只能做一件事</li>
<li>原因 - 避免 DOM 渲染冲突</li>
<li>解决方案 - 异步</li>
<li>异步的实现方式 - event loop</li>
</ul>
<h2 id="4-2-什么是-event-loop"><a class="markdownIt-Anchor" href="#4-2-什么是-event-loop">#</a> 4-2 什么是 event-loop</h2>
<blockquote>
<p>主线程从 &quot;任务队列&quot; 中读取事件，这个过程是循环不断的，所以整个的这种运行机制又称为 Event Loop（事件循环）。 <a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html">再谈 Event Loop</a></p>
</blockquote>
<h3 id="文字解释"><a class="markdownIt-Anchor" href="#文字解释">#</a> 文字解释</h3>
<blockquote>
<p>event-loop</p>
</blockquote>
<ul>
<li>事件轮询， JS 实现异步 的具体解决方案</li>
<li>同步代码，直接执行</li>
<li>异步函数先放在 异步队列 中</li>
<li>待同步函数执行完毕，轮询执行 异步队列 的函数</li>
</ul>
<h3 id="实例分析"><a class="markdownIt-Anchor" href="#实例分析">#</a> 实例分析</h3>
<p><em>示例一：</em></p>
<p><img src="http://static.zxinc520.com/blog/20190813/mxsAJyrO4cLE.png?imageslim" alt="mark"></p>
<p><em>示例二：</em></p>
<p><img src="http://static.zxinc520.com/blog/20190813/kftHfWYaHL80.png?imageslim" alt="mark"></p>
<p><em>示例三：</em></p>
<p><img src="http://static.zxinc520.com/blog/20190813/j3lPm5VCfcSB.png?imageslim" alt="mark"></p>
<p><strong>上图有 2 种结果</strong>：(a 是在 ajax 请求成功时放入异步队列，所以时间不确定)</p>
<ol>
<li>d -&gt; c -&gt; a -&gt; b</li>
<li>d -&gt; c -&gt; b -&gt; a</li>
</ol>
<h3 id="问题解答-2"><a class="markdownIt-Anchor" href="#问题解答-2">#</a> 问题解答</h3>
<ul>
<li>什么是 event-loop？
<ul>
<li>事件轮询， JS 实现异步 的具体解决方案</li>
<li>什么是异步队列，何时被放入 异步队列</li>
<li>轮询的过程</li>
</ul>
</li>
</ul>
<h2 id="4-3-jquery-的-deferred"><a class="markdownIt-Anchor" href="#4-3-jquery-的-deferred">#</a> 4-3 jQuery 的 Deferred</h2>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2011/08/a_detailed_explanation_of_jquery_deferred_object.html">jQuery 的 deferred 对象详解</a></p>
<p>jQuery 1.5.0 版本开始引入的一个新功能 ----<a target="_blank" rel="noopener" href="http://api.jquery.com/category/deferred-object/">deferred 对象</a>。</p>
<p>针对的读者是那些已经具备 jQuery 使用经验的开发者。如果你想了解 jQuery 的基本用法，请阅读 <a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/">阮一峰</a> 编写的<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2011/07/jquery_fundamentals.html">《jQuery 设计思想》</a>和<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2011/08/jquery_best_practices.html">《jQuery 最佳实践》</a>。</p>
</blockquote>
<h3 id="知识点"><a class="markdownIt-Anchor" href="#知识点">#</a> 知识点</h3>
<ul>
<li>jQuery 1.5 的变化</li>
<li>使用 jQuery Deferred</li>
<li>初步引入 Promise 概念</li>
</ul>
<p><strong>注意</strong> ：不要以为所有的网站 都是 vue 和 React 开发的</p>
<h4 id="jquery-15-之前"><a class="markdownIt-Anchor" href="#jquery-15-之前">#</a> jQuery 1.5 之前</h4>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> ajax <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  url<span class="token operator">:</span> <span class="token string">"data.json"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"success1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"success2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"success3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">error</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ajax<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回一个 XHR 对象</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="jquery-15-之后"><a class="markdownIt-Anchor" href="#jquery-15-之后">#</a> jQuery 1.5 之后</h4>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">var</span> ajax <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">"data.json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ajax
  <span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"success 1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"success 2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ajax<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回一个 deferred 对象</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="jquery-15-的变化"><a class="markdownIt-Anchor" href="#jquery-15-的变化">#</a> jQuery 1.5 的变化</h4>
<ul>
<li>无法改变 JS 异步和单线程的本质</li>
<li>只能从写法上杜绝 callback 这种形式</li>
<li>它是一种语法糖形式，但是解耦了代码</li>
<li>很好的体现：<strong>开放封闭原则</strong></li>
</ul>
<h3 id="使用-jquery-deferred"><a class="markdownIt-Anchor" href="#使用-jquery-deferred">#</a> 使用 jQuery Deferred</h3>
<blockquote>
<p>使用 jQuery Deferred</p>
<p>对比 说明</p>
</blockquote>
<p><em>未使用情况：</em></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 给出一段非常简单的异步操作代码，使用 setTimeout 函数</span>
<span class="token keyword">var</span> <span class="token function-variable function">wait</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">task</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"执行完成"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 新增需求：要在执行完成之后进行某些特别复杂的操作，代码可能会很多，而且分好几个步骤</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><em>使用 jQuery Deferred</em>：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">waitHandle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> dtd <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token function">Deferred</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建一个 Deferred 对象</span>

  <span class="token keyword">var</span> <span class="token function-variable function">wait</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dtd</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//要求传入一个 Deferred 对象</span>
    <span class="token keyword">var</span> <span class="token function-variable function">task</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"执行完成"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      dtd<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//表示异步任务已经完成</span>
      <span class="token comment">// dtd.reject()  //表示异步任务失败或出错</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> dtd<span class="token punctuation">;</span> <span class="token comment">// 要求返回 Deferred 对象</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

  <span class="token comment">// 注意，这里一定要有返回值</span>
  <span class="token keyword">return</span> <span class="token function">wait</span><span class="token punctuation">(</span>dtd<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//区别于promise，好像不能链式调用</span>
<span class="token keyword">var</span> w <span class="token operator">=</span> <span class="token function">waitHandle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
w<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"ok 1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"err 1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

w<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"ok 2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"error 2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 还有 w.done w.fail</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="总结"><a class="markdownIt-Anchor" href="#总结">#</a> 总结</h3>
<ul>
<li>总结，dtd 的 API 可分成两类，用意不同</li>
<li>第一类：dtd.resolve dtd.reject</li>
<li>第二类：dtd.then dtd.done dtd.fail</li>
<li>这两类应该分开，否则后果很严重</li>
</ul>
<h3 id="问题解答-3"><a class="markdownIt-Anchor" href="#问题解答-3">#</a> 问题解答</h3>
<ul>
<li>
<p>是否用过 jQuery 的 Deferred</p>
<ul>
<li>可以 jQuery 1.5 对 ajax 的改变举例</li>
<li>说明如何简单的封装，使用 Deferred</li>
<li>说明 ES6 promise 和 Deferred 的区别</li>
</ul>
</li>
</ul>
<p><strong>想要深入理解它，就需要知道它的前世今生。</strong></p>
<h2 id="4-4-promise"><a class="markdownIt-Anchor" href="#4-4-promise">#</a> 4-4 Promise</h2>
<blockquote>
<p>Promise 是异步编程的一种解决方案，比传统的解决方案 —— 回调函数和事件 —— 更合理和更强大。它由社区最早提出和实现，ES6 将其写进了语言标准，统一了用法，原生提供了 <code>Promise</code>  对象。</p>
<p>所谓 <code>Promise</code> ，简单说就是一个容器，里面保存着某个未来才会结束的事件（通常是一个异步操作）的结果。从语法上说，Promise 是一个对象，从它可以获取异步操作的消息。Promise 提供统一的 API，各种异步操作都可以用同样的方法进行处理。</p>
<p><a target="_blank" rel="noopener" href="http://es6.ruanyifeng.com/#docs/promise">ECMAScript 6 Promise 对象</a></p>
<p><strong>基础语法</strong> 请参考我的另一篇博客： <a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225cbb3bf05733fa0a66088c80%22">Promise 详细分析</a></p>
</blockquote>
<p><code>Promise</code> <strong> 对象有以下两个特点</strong>。</p>
<ol>
<li>对象的状态不受外界影响。 <code>Promise</code>  对象代表一个异步操作，有三种状态： <code>pending</code> （进行中）、 <code>fulfilled</code> （已成功）和 <code>rejected</code> （已失败）。只有异步操作的结果，可以决定当前是哪一种状态，任何其他操作都无法改变这个状态。这也是 <code>Promise</code>  这个名字的由来，它的英语意思就是 “承诺”，表示其他手段无法改变。</li>
<li>一旦状态改变，就不会再变，任何时候都可以得到这个结果。 <code>Promise</code>  对象的状态改变，只有两种可能：从 <code>pending</code>  变为 <code>fulfilled</code>  和从 <code>pending</code>  变为 <code>rejected</code> 。只要这两种情况发生，状态就凝固了，不会再变了，会一直保持这个结果，这时就称为 resolved（已定型）。如果改变已经发生了，你再对 <code>Promise</code>  对象添加回调函数，也会立即得到这个结果。这与事件（Event）完全不同，事件的特点是，如果你错过了它，再去监听，是得不到结果的。</li>
</ol>
<p>注意，为了行文方便，本章后面的 <code>resolved</code>  统一只指 <code>fulfilled</code>  状态，不包含 <code>rejected</code>  状态。</p>
<p>有了 <code>Promise</code>  对象，就可以将异步操作以同步操作的流程表达出来，避免了层层嵌套的回调函数。此外， <code>Promise</code>  对象提供统一的接口，使得控制异步操作更加容易。</p>
<p><code>Promise</code>  也有一些缺点。首先，无法取消 <code>Promise</code> ，一旦新建它就会立即执行，无法中途取消。其次，如果不设置回调函数， <code>Promise</code>  内部抛出的错误，不会反应到外部。第三，当处于 <code>pending</code>  状态时，无法得知目前进展到哪一个阶段（刚刚开始还是即将完成）。</p>
<p>如果某些事件不断地反复发生，一般来说，使用 <a target="_blank" rel="noopener" href="https://nodejs.org/api/stream.html">Stream</a> 模式是比部署 <code>Promise</code>  更好的选择。</p>
<h3 id="异常捕获"><a class="markdownIt-Anchor" href="#异常捕获">#</a> 异常捕获</h3>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">loadImg</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> promise<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> src <span class="token operator">=</span>
  <span class="token string">"https://edu-image.nosdn.127.net/B34DC36428D2D51B8EF5EE2C83CE9BF2.png?imageView&amp;thumbnail=241y34&amp;quality=100"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">loadImg</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//规定 ： then 只接受一个参数，最后统一用 catch 捕获异常</span>
result
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">img</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> img<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">img</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">ex</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 最后统一 catch</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="promiseall-promiserace"><a class="markdownIt-Anchor" href="#promiseall-promiserace">#</a> Promise.all &amp; Promise.race</h3>
<blockquote>
<p><strong>Promise.all</strong> 可以将多个 Promise 实例包装成一个新的 Promise 实例。同时，成功和失败的返回值是不同的，成功的时候返回的是一个结果数组，而失败的时候则返回最先被 reject 失败状态的值。</p>
<p><strong>Promse.race</strong> 就是赛跑的意思，意思就是说，Promise.race ([p1, p2, p3]) 里面哪个结果获得的快，就返回那个结果，不管结果本身是成功状态还是失败状态。</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/7e60fc1be1b2">理解和使用 Promise.all 和 Promise.race</a></p>
</blockquote>
<p><img src="http://static.zxinc520.com/blog/20190814/LoF987DaE10r.png?imageslim" alt="mark"></p>
<p><em>演示</em> ：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">loadImg</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> promise<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> src1 <span class="token operator">=</span>
  <span class="token string">"https://edu-image.nosdn.127.net/B34DC36428D2D51B8EF5EE2C83CE9BF2.png?imageView&amp;thumbnail=241y34&amp;quality=100"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> src2 <span class="token operator">=</span> <span class="token string">"https://www.imooc.com/static/img/index/logo.png"</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> result1 <span class="token operator">=</span> <span class="token function">loadImg</span><span class="token punctuation">(</span>src1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> result2 <span class="token operator">=</span> <span class="token function">loadImg</span><span class="token punctuation">(</span>src2<span class="token punctuation">)</span><span class="token punctuation">;</span>

Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>result1<span class="token punctuation">,</span> result2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">datas</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>datas<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>datas<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//谁快谁先执行</span>
Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>result1<span class="token punctuation">,</span> result2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">datas</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>datas<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>Promise.all 的执行结果</strong> ：</p>
<p><img src="http://static.zxinc520.com/blog/20190814/ITqccL9zhyE0.png?imageslim" alt="mark"></p>
<p><strong>Promise.race 的执行结果</strong> ：</p>
<p><img src="http://static.zxinc520.com/blog/20190814/PP76XFiW0S3V.png?imageslim" alt="mark"></p>
<h3 id="promise-标准"><a class="markdownIt-Anchor" href="#promise-标准">#</a> promise 标准</h3>
<ul>
<li>关于 “标准” 的闲谈</li>
<li>状态变化</li>
<li>then</li>
</ul>
<h4 id="关于-标准-的闲谈"><a class="markdownIt-Anchor" href="#关于-标准-的闲谈">#</a> 关于 “标准” 的闲谈</h4>
<ul>
<li>任何技术推广使用都需要一套标准来支撑</li>
<li>如 html js css http 等，无规矩不成方圆</li>
<li>任何不符合标准的东西，终将会被用户抛弃</li>
<li>不要挑战标准，不要自造标准</li>
</ul>
<h4 id="状态变化"><a class="markdownIt-Anchor" href="#状态变化">#</a> 状态变化</h4>
<ul>
<li>三种状态：pending fulfilled rejected</li>
<li>初始状态：pending</li>
<li><strong>成功</strong>：pending 变成 fulfilled ，<strong>失败</strong>：pending 变成 rejected</li>
<li>状态变化不可逆</li>
</ul>
<h4 id="then"><a class="markdownIt-Anchor" href="#then">#</a> then</h4>
<ul>
<li>
<p>Promise 实例必须实现 then 这个方法</p>
</li>
<li>
<p>then () 必须可以接受两个函数作为参数</p>
</li>
<li>
<p>then () 返回的必须是一个 Promise 实例</p>
<p><img src="http://static.zxinc520.com/blog/20190814/p2zjIfnNkjIp.png?imageslim" alt="mark"></p>
</li>
</ul>
<h3 id="问题解答-4"><a class="markdownIt-Anchor" href="#问题解答-4">#</a> 问题解答</h3>
<p><strong>问题：Promise 的基本使用和原理？</strong></p>
<ul>
<li>基本语法 （复习）</li>
<li>如何异常捕获 （ error 和 reject 都要考虑）</li>
<li>多个串联 - 链式执行的好处</li>
<li>Promise.all 和 Promise.race</li>
<li>Promise 标准 - 状态变化，then 函数</li>
</ul>
<h2 id="4-5-asyncawait"><a class="markdownIt-Anchor" href="#4-5-asyncawait">#</a> 4-5 async/await</h2>
<blockquote>
<p>ES2017 标准引入了 async 函数，使得异步操作变得更加方便。</p>
<p>async 函数是什么？一句话，它就是 Generator 函数的语法糖。</p>
<p><a target="_blank" rel="noopener" href="http://es6.ruanyifeng.com/">ECMAScript 6 入门</a> <a target="_blank" rel="noopener" href="http://es6.ruanyifeng.com/#docs/async">async 函数</a></p>
</blockquote>
<ul>
<li>then 只是将 callback 拆分了</li>
<li>async/await 是最直接的同步写法</li>
</ul>
<p><img src="http://static.zxinc520.com/blog/20190815/B2MsvoDMkq7B.png?imageslim" alt="mark"></p>
<p><strong>最直接的同步写法：</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">load</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> result1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">loadImg</span><span class="token punctuation">(</span>src1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> result2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">loadImg</span><span class="token punctuation">(</span>src2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="用法"><a class="markdownIt-Anchor" href="#用法">#</a> 用法</h3>
<ul>
<li>使用 await，函数必须用 async 标识</li>
<li>await 后面跟的是一个 Promise 实例</li>
<li>需要 babel-polyfill</li>
</ul>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">loadImg</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> promise<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> src1 <span class="token operator">=</span>
  <span class="token string">"https://edu-image.nosdn.127.net/B34DC36428D2D51B8EF5EE2C83CE9BF2.png?imageView&amp;thumbnail=241y34&amp;quality=100"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> src2 <span class="token operator">=</span> <span class="token string">"https://www.imooc.com/static/img/index/logo.png"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">load</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> result1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">loadImg</span><span class="token punctuation">(</span>src1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> result2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">loadImg</span><span class="token punctuation">(</span>src2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="问题解答-5"><a class="markdownIt-Anchor" href="#问题解答-5">#</a> 问题解答</h3>
<ul>
<li>介绍一下 async/await（ES7）（和 Promise 的区别、联系）
<ul>
<li>基本语法</li>
<li>使用了 Promise，并没有和 Promise 冲突</li>
<li>完全是同步的写法，再也没有回调函数</li>
<li>但是：改变不了 JS 单线程、异步的本质</li>
</ul>
</li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JS-%E4%B8%89%E5%BA%A7%E5%A4%A7%E5%B1%B1/" rel="tag">JS 三座大山</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Promise/" rel="tag">Promise</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/event-loop/" rel="tag">event loop</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%95%E7%BA%BF%E7%A8%8B/" rel="tag">单线程</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%82%E6%AD%A5%E7%9A%84-Deferred/" rel="tag">异步的 Deferred</a></li></ul>

    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-NewPrototype"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/08/10/NewPrototype/"
    >原型</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2019/08/10/NewPrototype/" class="article-date">
  <time datetime="2019-08-10T07:52:24.000Z" itemprop="datePublished">2019-08-10</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/JS/">JS</a> / <a class="article-category-link" href="/categories/JS/JS-%E4%B8%89%E5%BA%A7%E5%A4%A7%E5%B1%B1/">JS 三座大山</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="原型"><a class="markdownIt-Anchor" href="#原型">#</a> 原型</h1>
<blockquote>
<p>本章将结合 <strong>jQuery</strong> 和 <strong>zepto</strong> 源码来讲解原型的实际应用。通过 <strong>源码来分析</strong> jQuery 和 zepto 是如何使用原型的，以及通过它们的 <strong>插件机制</strong>，讲解 <strong>原型的扩展性</strong> 。</p>
<p>《前端 JS 面试技巧》请参考我之前的博客： <a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225d2df2cdda85353d5ca8b83f%22">前端 JS 基础面试技巧</a></p>
</blockquote>
<h3 id="关于原型"><a class="markdownIt-Anchor" href="#关于原型">#</a> 关于原型</h3>
<ul>
<li>《前端 JS 面试技巧》已经讲解过原型的 <a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225d2df2cdda85353d5ca8b83f%22">基础知识</a></li>
<li>高级面试题，光会原型基础还不够，还要实际应用</li>
<li>zepto jquery 中如何用原型</li>
<li>顺便也算是解读了 zepto 和 jquery 的部分源码</li>
</ul>
<h3 id="题目"><a class="markdownIt-Anchor" href="#题目">#</a> 题目</h3>
<ul>
<li>说一个原型的实际应用</li>
<li>原型如何体现它的扩展性</li>
</ul>
<h2 id="原型的实际应用"><a class="markdownIt-Anchor" href="#原型的实际应用">#</a> 原型的实际应用</h2>
<blockquote>
<p>原型的实际应用</p>
</blockquote>
<h3 id="知识点"><a class="markdownIt-Anchor" href="#知识点">#</a> 知识点</h3>
<ul>
<li>jquery 和 zepto 的简单使用</li>
<li>zepto 如何使用原型</li>
<li>jquery 如何使用原型</li>
</ul>
<h4 id="简单使用"><a class="markdownIt-Anchor" href="#简单使用">#</a> 简单使用</h4>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">></span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span>
<span class="token operator">&lt;</span>head<span class="token operator">></span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>title<span class="token operator">></span>Title<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span>
<span class="token operator">&lt;</span>body<span class="token operator">></span>
<span class="token operator">&lt;</span>p<span class="token operator">></span>jquery test <span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
<span class="token operator">&lt;</span>p<span class="token operator">></span>jquery test <span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
<span class="token operator">&lt;</span>p<span class="token operator">></span>jquery test <span class="token number">3</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>

<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"div1"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>p<span class="token operator">></span>jquery test <span class="token keyword">in</span> dev<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>

<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
<span class="token operator">&lt;</span>script<span class="token operator">></span>
    <span class="token keyword">var</span> $p <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>
    $p<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'font-size'</span><span class="token punctuation">,</span> <span class="token string">'40px'</span><span class="token punctuation">)</span> <span class="token comment">//css 是原型方法</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>$p<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 		    <span class="token comment">//html 是原型方法</span>

    <span class="token keyword">var</span> $div1 <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#div1'</span><span class="token punctuation">)</span>      <span class="token comment">//css 是原型方法</span>
    $div1<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'color'</span><span class="token punctuation">,</span> <span class="token string">'blue'</span><span class="token punctuation">)</span>  <span class="token comment">//html 是原型方法</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>$div1<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="zepto-如何使用原型"><a class="markdownIt-Anchor" href="#zepto-如何使用原型">#</a> zepto 如何使用原型</h4>
<blockquote>
<p>源码中，这里的处理情况比较复杂。但因为本次只针对原型，因此这里就弱化了</p>
</blockquote>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">window</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">//空对象</span>
  <span class="token keyword">var</span> zepto <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

  zepto<span class="token punctuation">.</span><span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//源码中，这里的处理情况比较复杂。但因为本次只针对原型，因此这里就弱化了</span>
    <span class="token keyword">var</span> slice <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice<span class="token punctuation">;</span>
    <span class="token keyword">var</span> dom <span class="token operator">=</span> <span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> zepto<span class="token punctuation">.</span><span class="token constant">Z</span><span class="token punctuation">(</span>dom<span class="token punctuation">,</span> selector<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

  <span class="token comment">// 即使用 zepto 时候的 $</span>
  <span class="token keyword">var</span> <span class="token function-variable function">$</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> zepto<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

  <span class="token comment">// 这就是构造函数</span>
  <span class="token keyword">function</span> <span class="token constant">Z</span><span class="token punctuation">(</span><span class="token parameter">dom<span class="token punctuation">,</span> selector</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> i<span class="token punctuation">,</span>
      len <span class="token operator">=</span> dom <span class="token operator">?</span> dom<span class="token punctuation">.</span>length <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> dom<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">=</span> len<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>selector <span class="token operator">=</span> selector<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  zepto<span class="token punctuation">.</span><span class="token function-variable function">Z</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dom<span class="token punctuation">,</span> selector</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 注意，出现了 new 关键字</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Z</span><span class="token punctuation">(</span>dom<span class="token punctuation">,</span> selector<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

  $<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    constructor<span class="token operator">:</span> zepto<span class="token punctuation">.</span><span class="token constant">Z</span><span class="token punctuation">,</span>
    <span class="token function-variable function">css</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">html</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

  zepto<span class="token punctuation">.</span><span class="token class-name">Z</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token class-name">Z</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> $<span class="token punctuation">.</span>fn<span class="token punctuation">;</span>

  window<span class="token punctuation">.</span>$ <span class="token operator">=</span> $<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="jquery-如何使用原型"><a class="markdownIt-Anchor" href="#jquery-如何使用原型">#</a> jquery 如何使用原型</h4>
<blockquote>
<p>简化了源码，重在讲解 jquery 如何使用原型</p>
</blockquote>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//简化了源码，真实源码分支很多,选取部分代码</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">window</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">jQuery</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//注意 new 关键字，第一步就找到了 构造函数</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">jQuery<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

  <span class="token comment">//定义构造函数</span>
  <span class="token keyword">var</span> init <span class="token operator">=</span> <span class="token punctuation">(</span>jQuery<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> slice <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice<span class="token punctuation">;</span>
    <span class="token keyword">var</span> dom <span class="token operator">=</span> <span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> i<span class="token punctuation">,</span>
      len <span class="token operator">=</span> dom <span class="token operator">?</span> dom<span class="token punctuation">.</span>length <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> dom<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">=</span> len<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>selector <span class="token operator">=</span> selector <span class="token operator">||</span> <span class="token string">""</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  init<span class="token punctuation">.</span>prototype <span class="token operator">=</span> jQuery<span class="token punctuation">.</span>fn<span class="token punctuation">;</span>

  <span class="token comment">//初始化 jQuery.fn</span>
  jQuery<span class="token punctuation">.</span>fn <span class="token operator">=</span> jQuery<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    constructor<span class="token operator">:</span> jQuery<span class="token punctuation">,</span>

    <span class="token comment">//其他函数...</span>
    <span class="token function-variable function">css</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">html</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

  <span class="token comment">//定义原型</span>
  init<span class="token punctuation">.</span>prototype <span class="token operator">=</span> jQuery<span class="token punctuation">.</span>fn<span class="token punctuation">;</span>
  window<span class="token punctuation">.</span>$ <span class="token operator">=</span> jQuery<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="问题解答"><a class="markdownIt-Anchor" href="#问题解答">#</a> 问题解答</h3>
<ul>
<li>描述一下 jquery 如何使用原型</li>
<li>描述一下 zepto 如何使用原型</li>
<li>再结合自己的项目经验，说一下自己开发的例子</li>
</ul>
<h2 id="如何体现原型的扩展性"><a class="markdownIt-Anchor" href="#如何体现原型的扩展性">#</a> 如何体现原型的扩展性</h2>
<blockquote>
<p>体现原型的扩展性</p>
</blockquote>
<h3 id="知识点-2"><a class="markdownIt-Anchor" href="#知识点-2">#</a> 知识点</h3>
<ul>
<li>总结 zepto 和 jquery 原型的使用</li>
<li>插件机制</li>
</ul>
<h3 id="总结-zepto-和-jquery-原型的使用"><a class="markdownIt-Anchor" href="#总结-zepto-和-jquery-原型的使用">#</a> 总结 zepto 和 jquery 原型的使用</h3>
<blockquote>
<p>总结 zepto 和 jquery 原型的使用</p>
<p>相关 <strong>代码实现</strong> 请看上文 ：zepto 如何使用原型 和 jquery 如何使用原型</p>
</blockquote>
<p><em>问题一：为何要把原型方法放在 $.fn ?</em></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//初始化 jQuery.fn</span>
jQuery<span class="token punctuation">.</span>fn <span class="token operator">=</span> jQuery<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  constructor<span class="token operator">:</span> jQuery<span class="token punctuation">,</span>

  <span class="token comment">//其他函数...</span>
  <span class="token function-variable function">css</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">html</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//定义原型</span>
init<span class="token punctuation">.</span>prototype <span class="token operator">=</span> jQuery<span class="token punctuation">.</span>fn<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>解答</strong> ：<u>因为要扩展插件</u> ，做一个简单的插件的例子</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// 因为要扩展插件，做一个简单的插件的例子</span>
$<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token function-variable function">getNodeName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nodeName<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>好处</strong>：</p>
<ol>
<li>只有 $ 会暴露在 window 全局变量</li>
<li>将插件扩展统一到 $.fn.xxx 这一接口，方便使用</li>
</ol>
<h2 id="总结"><a class="markdownIt-Anchor" href="#总结">#</a> 总结</h2>
<ul>
<li>
<p>说一个原型的实际应用</p>
<ul>
<li>描述一下 jquery 如何使用 原型</li>
<li>描述一下 zepto 如何使用 原型</li>
<li>再结合自己的项目经验，说一下自己开发的例子</li>
</ul>
</li>
<li>
<p>原型如何体现它的扩展性</p>
<ul>
<li>说一下 jquery 和 zepto 的 插件机制</li>
<li>结合自己的开发经验，做过的基于原型的插件</li>
</ul>
</li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JS-%E4%B8%89%E5%BA%A7%E5%A4%A7%E5%B1%B1/" rel="tag">JS 三座大山</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93/" rel="tag">面试全面总结</a></li></ul>

    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-ES6intro"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/08/04/ES6intro/"
    >ES6 语法</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2019/08/04/ES6intro/" class="article-date">
  <time datetime="2019-08-04T08:46:35.000Z" itemprop="datePublished">2019-08-04</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/JS/">JS</a> / <a class="article-category-link" href="/categories/JS/ES6-%E8%AF%AD%E6%B3%95/">ES6 语法</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="es6-语法"><a class="markdownIt-Anchor" href="#es6-语法">#</a> ES6 语法</h1>
<blockquote>
<p>本章主要讲解工作中最常用的 ES6 语法，包括 <strong>Module Class Promise</strong> 等语法，还会介绍使用 <strong>babel webpack rollup</strong> 来搭建 ES6 编译环境。</p>
<p><a target="_blank" rel="noopener" href="http://es6.ruanyifeng.com/">ECMAScript 6 入门</a></p>
</blockquote>
<h2 id="es6-使用"><a class="markdownIt-Anchor" href="#es6-使用">#</a> ES6 使用</h2>
<ul>
<li>开发环境已经普及使用</li>
<li>浏览器环境却支持不好（ 需要开发环境编译 ）</li>
<li>内容很多，重点了解常用语法</li>
<li>面试：开发环境的使用 + 重点语法的掌握</li>
</ul>
<h3 id="问题"><a class="markdownIt-Anchor" href="#问题">#</a> 问题</h3>
<ul>
<li>ES6 模块化如何使用，开发环境如何打包</li>
<li>Class 和 普通构造函数 有何区别 ？</li>
<li>Promise 的基本使用和原理</li>
<li>总结一下 ES6 其它常用功能</li>
</ul>
<h2 id="2-1-es6-模块化语法"><a class="markdownIt-Anchor" href="#2-1-es6-模块化语法">#</a> 2-1 ES6 模块化语法</h2>
<blockquote>
<p>ES6 模块化如何使用，开发环境如何打包</p>
</blockquote>
<h3 id="知识点"><a class="markdownIt-Anchor" href="#知识点">#</a> 知识点</h3>
<p><strong>ES6 模块化如何使用，开发环境如何打包:</strong></p>
<ul>
<li>模块化的基本语法</li>
<li>开发环境的配置</li>
<li>关于 JS 众多 模块化标准</li>
</ul>
<h4 id="export-语法"><a class="markdownIt-Anchor" href="#export-语法">#</a> export 语法</h4>
<blockquote>
<p>export 语法</p>
</blockquote>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/*util1.js*/</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span>
  a<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">/*util2.js*/</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"fn1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"fn2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*index.js*/</span>
<span class="token keyword">import</span> util1 <span class="token keyword">from</span> <span class="token string">"./util1.js"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> fn1<span class="token punctuation">,</span> fn2 <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"./util2.js"</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>util1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="开发环境-babel"><a class="markdownIt-Anchor" href="#开发环境-babel">#</a> 开发环境 - babel</h4>
<blockquote>
<p>Babel 是一个 JavaScript 编译器。<a target="_blank" rel="noopener" href="https://babeljs.io/">官网</a></p>
<p>使用技巧 可参考 <a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225cc4640d9b3032095d9e5754%22">React 学习第一天 ：webpack 中使用 Babel 配置</a></p>
<p>和 <a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225cb72a04009ae94788aa0d7f%22">Vue 第六天学习 ：webpack 中 babel 的配置</a></p>
</blockquote>
<h4 id="开发环境-webpack"><a class="markdownIt-Anchor" href="#开发环境-webpack">#</a> 开发环境 - webpack</h4>
<blockquote>
<p>开发环境 - webpack - <em>webpack</em> 是一个模块打包器 <a target="_blank" rel="noopener" href="https://webpack.js.org/">官网</a></p>
<p>详情 可参考我的博客：<a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225cb181596d3d4a5cb52b65c9%22">Vue 第五天：webpack</a> 和 <a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225cb72a04009ae94788aa0d7f%22">Vue 第六天学习：深入 webpack</a> 以及 <a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225cc4640d9b3032095d9e5754%22">React 学习第一天：创建基本的 webpack4.x 项目 </a></p>
</blockquote>
<h4 id="rollupjs"><a class="markdownIt-Anchor" href="#rollupjs">#</a> rollup.js</h4>
<blockquote>
<p>概述 (Overview) <a target="_blank" rel="noopener" href="https://www.rollupjs.com/guide/zh">中文文档</a> <a target="_blank" rel="noopener" href="https://rollupjs.org/guide/en/">官网</a></p>
<p>Rollup 是一个 JavaScript 模块打包器，可以将小块代码编译成大块复杂的代码，例如 library 或应用程序。Rollup 对代码模块使用新的标准化格式，这些标准都包含在 JavaScript 的 ES6 版本中，而不是以前的特殊解决方案，如 CommonJS 和 AMD。ES6 模块可以使你自由、无缝地使用你最喜爱的 library 中那些最有用独立函数，而你的项目不必携带其他未使用的代码。ES6 模块最终还是要由浏览器原生实现，但当前 Rollup 可以使你提前体验</p>
<p><strong>rollup 功能单一（极致） ，webpack 功能强大</strong></p>
</blockquote>
<h4 id="关于-js-众多-模块化标准"><a class="markdownIt-Anchor" href="#关于-js-众多-模块化标准">#</a> 关于 JS 众多 模块化标准</h4>
<blockquote>
<p>关于 JS 众多 模块化标准</p>
<p>详情可参考我的博客：<a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225d31940b724e8113740499b3%22">开发环境： 模块化</a></p>
</blockquote>
<p><strong>发展过程</strong></p>
<ul>
<li>没有模块化</li>
<li>AMD 成为 标准，require.js （也有 CMD【<strong>用的不多</strong> 】）</li>
<li>前端打包工具，nodejs 模块化可以被使用</li>
<li>ES6 出现 ，想统一现在所有的模块化标准</li>
<li>nodejs 积极支持，浏览器尚未统一</li>
<li>你可以自造 lib，但是不要自造标准</li>
</ul>
<h3 id="问题解答"><a class="markdownIt-Anchor" href="#问题解答">#</a> 问题解答</h3>
<ul>
<li>语法：import export （注意有无 default）</li>
<li>环境：babel 编译 ES6 语法，模块化可用 webpack 和 rollup</li>
<li>扩展：说一下自己对模块化标准统一的期待</li>
</ul>
<h2 id="2-2-class-和-普通构造函数有何区别"><a class="markdownIt-Anchor" href="#2-2-class-和-普通构造函数有何区别">#</a> 2-2 Class 和 普通构造函数有何区别</h2>
<blockquote>
<p>Class 和 普通构造函数有何区别</p>
<p><a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225cd03896bd482e21ac46a9d4%22">我的博客：React 学习第二天：了解 class</a></p>
</blockquote>
<h3 id="知识点-2"><a class="markdownIt-Anchor" href="#知识点-2">#</a> 知识点</h3>
<ul>
<li>JS 构造函数</li>
<li>Class 基本语法</li>
<li>语法糖</li>
<li>继承</li>
</ul>
<h3 id="问题解答-2"><a class="markdownIt-Anchor" href="#问题解答-2">#</a> 问题解答</h3>
<ul>
<li>Class 和 普通构造函数 有何区别 ？
<ul>
<li>Class 在语法上更加贴合面向对象的写法</li>
<li>Class 实现继承更加易读、易理解</li>
<li>更易于写 java 等后端语言的使用</li>
<li>本质还是语法糖， 使用 prototype</li>
</ul>
</li>
</ul>
<h2 id="2-3-promise-的基本使用"><a class="markdownIt-Anchor" href="#2-3-promise-的基本使用">#</a> 2-3 Promise 的基本使用</h2>
<h3 id="promise-的基本使用"><a class="markdownIt-Anchor" href="#promise-的基本使用">#</a> Promise 的基本使用</h3>
<blockquote>
<p>可参考我的博客：<a target="_blank" rel="noopener" href="http://zxinc520.com/lcj/%225cbb3bf05733fa0a66088c80%22">Promise 详细分析</a></p>
</blockquote>
<ul>
<li>Callback Hell</li>
<li>Promise 语法</li>
</ul>
<h4 id="callback-hell"><a class="markdownIt-Anchor" href="#callback-hell">#</a> Callback Hell</h4>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">loadImg</span><span class="token punctuation">(</span><span class="token parameter">src<span class="token punctuation">,</span> callback<span class="token punctuation">,</span> fail</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">callback</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  img<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  img<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> src <span class="token operator">=</span>
  <span class="token string">"https://edu-image.nosdn.127.net/B34DC36428D2D51B8EF5EE2C83CE9BF2.png?imageView&amp;thumbnail=241y34&amp;quality=100"</span><span class="token punctuation">;</span>
<span class="token function">loadImg</span><span class="token punctuation">(</span>
  src<span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">img</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="promise-语法"><a class="markdownIt-Anchor" href="#promise-语法">#</a> Promise 语法</h4>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">loadImg</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> promise<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> src <span class="token operator">=</span>
  <span class="token string">"https://edu-image.nosdn.127.net/B34DC36428D2D51B8EF5EE2C83CE9BF2.png?imageView&amp;thumbnail=241y34&amp;quality=100"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">loadImg</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>

result<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">img</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"faild"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

result<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">img</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="问题解答-3"><a class="markdownIt-Anchor" href="#问题解答-3">#</a> 问题解答</h3>
<ul>
<li>Promise 的基本使用和原理？
<ul>
<li>new Promise 实例，而且要 return</li>
<li>new Promise 时要传入函数，函数有 resolve, reject 两个参数</li>
<li>成功时执行 resolve () 失败时执行 reject ()</li>
<li>then 监听结果</li>
</ul>
</li>
</ul>
<h2 id="2-4-总结一下-es6-其它常用功能"><a class="markdownIt-Anchor" href="#2-4-总结一下-es6-其它常用功能">#</a> 2-4 总结一下 ES6 其它常用功能</h2>
<h3 id="知识点-3"><a class="markdownIt-Anchor" href="#知识点-3">#</a> 知识点</h3>
<ul>
<li>let/const</li>
<li>多行字符串 / 模板变量</li>
<li>解构赋值</li>
<li>块级作用域</li>
<li>函数默认参数</li>
<li>箭头函数</li>
</ul>
<h4 id="letconst"><a class="markdownIt-Anchor" href="#letconst">#</a> let/const</h4>
<p><img src="http://static.zxinc520.com/blog/20190804/IjRCPysI3ja5.png?imageslim" alt="mark"></p>
<h4 id="多行字符串模板变量"><a class="markdownIt-Anchor" href="#多行字符串模板变量">#</a> 多行字符串 / 模板变量</h4>
<p><img src="http://static.zxinc520.com/blog/20190804/cmkreCVTvB3f.png?imageslim" alt="mark"></p>
<h4 id="解构赋值"><a class="markdownIt-Anchor" href="#解构赋值">#</a> 解构赋值</h4>
<p><img src="http://static.zxinc520.com/blog/20190804/tkv3jll7XPJG.png?imageslim" alt="mark"></p>
<h4 id="块级作用域"><a class="markdownIt-Anchor" href="#块级作用域">#</a> 块级作用域</h4>
<p><img src="http://static.zxinc520.com/blog/20190804/vqFw5Cyt1Okg.png?imageslim" alt="mark"></p>
<h4 id="函数默认参数"><a class="markdownIt-Anchor" href="#函数默认参数">#</a> 函数默认参数</h4>
<p><img src="http://static.zxinc520.com/blog/20190804/rDHBLwq6djzQ.png?imageslim" alt="mark"></p>
<h4 id="箭头函数"><a class="markdownIt-Anchor" href="#箭头函数">#</a> 箭头函数</h4>
<p><img src="http://static.zxinc520.com/blog/20190804/26aXyJj3eE8M.png?imageslim" alt="mark"></p>
<p><img src="http://static.zxinc520.com/blog/20190804/XppPYlgRUceY.png?imageslim" alt="mark"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ES6/" rel="tag">ES6</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ES6-%E6%A8%A1%E5%9D%97%E5%8C%96%E8%AF%AD%E6%B3%95/" rel="tag">ES6 模块化语法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/babel/" rel="tag">babel</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rollup/" rel="tag">rollup</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webpack/" rel="tag">webpack</a></li></ul>

    </footer>
  </div>

    
 
   
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/3/">上一页</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/5/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2021
        <i class="ri-heart-fill heart_icon"></i> zhou chen
      </li>
    </ul>
    <ul>
      <li>
        
        
        
        Powered by <a href="https://hexo.io" target="_blank">Hexo</a>
        <span class="division">|</span>
        Theme - <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></s>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/logozc.jpg" alt="sunflower"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="https://vercel-demo-ten.vercel.app/#/">个人博客</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">友情链接</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="http://static.zxinc520.com/blog/20190512/p4IWzLUrorWK.jpg?imageslim">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="http://static.zxinc520.com/blog/20190512/pGHOMdDF79sb.jpg?imageslim">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->


<script src="/js/busuanzi-2.3.pure.min.js"></script>


<!-- ClickLove -->

<!-- ClickBoom1 -->

<script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script>

<script src="/js/clickBoom1.js"></script>


<!-- ClickBoom2 -->

<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->


    
  </div>
</body>

</html>